
(:TYPE :SYSTEM :NAME "zcdb" :AUTHOR "Zach Beane <xach@xach.com>" :MAINTAINER
 NIL :VERSION "1.0.3" :LICENCE NIL :DESCRIPTION
 "Read and write cdb files, as specified in
  http://cr.yp.to/cdb.html"
 :LONG-DESCRIPTION NIL :DEPENDS-ON NIL :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "ZCDB" :FULL-NAME "ZCDB" :DOCUMENTATION NIL
   :SYMBOL-LIST
   ((:TYPE :CONSTANT :SYMBOL
     (:NAME "+INITIAL-HASH-VALUE+" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE "5381")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CDB-HASH" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "OCTETS" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)) :DOCUMENTATION
     "http://cr.yp.to/cdb/cdb.txt")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-GROWABLE-VECTOR" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "SIZE" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) 10)
      ((:NAME "ELEMENT-TYPE" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-OCTET-VECTOR" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "SIZE" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-CDB-U32" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)) :DOCUMENTATION
     NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "LOOKUP-RECORD-AT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "POSITION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "KEY" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "TABLE-SLOT-LOOKUP" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "KEY" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "HASH" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "TABLE-POSITION" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "INITIAL-SLOT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "SLOT-COUNT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "STREAM-LOOKUP" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "KEY" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL (:NAME "LOOKUP" :PACKAGE-NAME "ZCDB" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "KEY" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "CDB" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "STREAM-MAP-CDB" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "FUNCTION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAP-CDB" :PACKAGE-NAME "ZCDB" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FUNCTION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "CDB" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-CDB-U32" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "U32" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Write an (unsigned-byte 32) value to STREAM in little-endian order.")
    (:TYPE :CLASS :SYMBOL
     (:NAME "RECORD-POINTER" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :SUPER-CLASS-LIST NIL :DOCUMENTATION
     "Every key/value record written to a CDB has a
  corresponding record pointer, which tracks the key's hash value and
  the record's position in the data file. When all records have been
  written to the file, these record pointers are organized into hash
  tables at the end of the cdb file."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "HASH-VALUE" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "HASH-VALUE" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION "The hash value of the record key.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "RECORD-POSITION" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "RECORD-POSITION" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)) :READERS
       NIL :WRITERS NIL :DOCUMENTATION
       "The file position at which the record is stored.")))
    (:TYPE :METHOD :SYMBOL
     (:NAME "PRINT-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "RECORD-POINTER" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
       (:NAME "RECORD-POINTER" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*EMPTY-RECORD-POINTER*" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE "(MAKE-INSTANCE 'ZCDB::RECORD-POINTER)")
    (:TYPE :CLASS :SYMBOL
     (:NAME "HASH-TABLE-BUCKET" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :SUPER-CLASS-LIST NIL :DOCUMENTATION
     "During construction of the CDB, record pointers are
  accumulated into one of 256 hash table buckets, depending on the low
  8 bits of the hash value of the key. At the end of record writing,
  these buckets are used to write out hash table vectors at the end of
  the file, and write pointers to the hash table vectors at the start
  of the file."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "TABLE-POSITION" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "TABLE-POSITION" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)) :READERS
       NIL :WRITERS NIL :DOCUMENTATION "The file position at which this table
    is (eventually) slotted.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ENTRIES" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "ENTRIES" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION "A vector of record-pointers.")))
    (:TYPE :GENERIC :SYMBOL
     (:NAME "ENTRY-COUNT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "OBJECT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)) :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENTRY-COUNT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :LAMBDA-LIST
     (((:NAME "OBJECT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
       (:NAME "HASH-TABLE-BUCKET" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENTRY-COUNT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :LAMBDA-LIST
     (((:NAME "OBJECT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
       (:NAME "HASH-TABLE-BUCKET" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)))
     :DOCUMENTATION NIL)
    (:TYPE :GENERIC :SYMBOL
     (:NAME "SLOT-COUNT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "OBJECT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)) :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "SLOT-COUNT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :LAMBDA-LIST
     (((:NAME "OBJECT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
       (:NAME "HASH-TABLE-BUCKET" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "SLOT-COUNT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :LAMBDA-LIST
     (((:NAME "OBJECT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
       (:NAME "HASH-TABLE-BUCKET" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BUCKET-HASH-VECTOR" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "BUCKET" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
     :DOCUMENTATION
     "Create a hash vector for a bucket. A hash vector has 2x the entries
of the bucket, and is initialized to an empty record pointer. The high
24 bits of the hash value of a record pointer, mod the size of the
vector, is used as a starting slot, and the vector is walked (wrapping
at the end) to find the first free slot for positioning each record
pointer entry.")
    (:TYPE :METHOD :SYMBOL
     (:NAME "PRINT-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "BUCKET" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
       (:NAME "HASH-TABLE-BUCKET" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :CLASS :SYMBOL
     (:NAME "CDB-WRITER" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :SUPER-CLASS-LIST
     NIL :DOCUMENTATION NIL :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "BUCKETS" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "BUCKETS" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "END-OF-RECORDS-POSITION" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "END-OF-RECORDS-POSITION" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "OUTPUT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "OUTPUT" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ADD-RECORD" :PACKAGE-NAME "ZCDB" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "KEY" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "VALUE" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "CDB-WRITER" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
     :DOCUMENTATION "Add KEY and VALUE to a cdb file. KEY and VALUE should both
be (unsigned-byte 8) vectors.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-BUCKET-HASH-TABLE" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "BUCKET" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Write BUCKET's hash table vector to STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-HASH-TABLES" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "CDB-WRITER" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
     :DOCUMENTATION "Write the traililng hash tables to the end of the cdb
file. Initializes the position of the buckets in the process.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-POINTERS" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "CDB-WRITER" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)) :DOCUMENTATION
     "Write the leading hash table pointers to the beginning of the cdb
file. Must be called after WRITE-HASH-TABLES, or the positions won't
be available.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FINISH-CDB-WRITER" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "CDB-WRITER" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
     :DOCUMENTATION
     "Write the trailing hash tables and leading table pointers to the
cdb file.")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*POINTER-PADDING*" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "(MAKE-ARRAY 2048 :ELEMENT-TYPE '(UNSIGNED-BYTE 8))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CALL-WITH-OUTPUT-TO-CDB" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "CDB-PATHNAME" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "TEMP-PATHNAME" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
      (:NAME "FUN" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
     :DOCUMENTATION
     "Call FUN with one argument, a CDB-WRITER instance to which records
can be added with ADD-RECORD.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "WITH-OUTPUT-TO-CDB" :PACKAGE-NAME "ZCDB" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "CDB" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
       (:NAME "FILE" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL)
       (:NAME "TEMP-FILE" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "ZCDB" :EXTERNALP NIL))
     :DOCUMENTATION
     "Evaluate BODY with CDB bound to a CDB-WRITER object. The CDB in
progress is written to TEMP-FILE, and then when the CDB is
successfully written, TEMP-FILE is renamed to FILE. For atomic
operation, FILE and TEMP-FILE must be on the same filesystem."))
   :EXTERNAL-SYMBOLS
   ((:NAME "ADD-RECORD" :PACKAGE-NAME "ZCDB" :EXTERNALP T)
    (:NAME "LOOKUP" :PACKAGE-NAME "ZCDB" :EXTERNALP T)
    (:NAME "WITH-OUTPUT-TO-CDB" :PACKAGE-NAME "ZCDB" :EXTERNALP T)
    (:NAME "MAP-CDB" :PACKAGE-NAME "ZCDB" :EXTERNALP T)))))
