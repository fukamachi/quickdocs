
(:TYPE :SYSTEM :NAME "text-query" :AUTHOR "Mark Kantrowitz" :MAINTAINER
 "Peter Scott <sketerpot@gmail.com>" :VERSION "1.1" :LICENCE
 "Free use, modification, and distribution. Copyright 1993 by Mark Kantrowitz."
 :DESCRIPTION "A general text-based system for querying the user."
 :LONG-DESCRIPTION NIL :DEPENDS-ON NIL :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "TEXT-QUERY" :FULL-NAME "TEXT-QUERY" :DOCUMENTATION NIL
   :SYMBOL-LIST
   ((:TYPE :VARIABLE :SYMBOL
     (:NAME "*Y-OR-N-P-CHOICES*" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "'(((T \"Yes\") #\\y #\\t #\\ ) ((NIL \"No\") #\\n) ((:HELP \"Help\") #\\h #\\?))")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*YES-OR-NO-P-CHOICES*" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "'((T \"Yes\") (NIL \"No\") (:HELP \"Help\" \"h\" \"?\"))")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*SLEEP-AMOUNT*" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
     :DOCUMENTATION
     "Amount of time to sleep between checking query-io. In multiprocessing
     Lisps, this allows other processes to continue while we busy-wait. If
     0, skips call to SLEEP."
     :INITIAL-VALUE "0.1")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*TIMEOUT*" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE "20")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*Y-OR-N-P-WAIT-DEFAULT*" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP
      NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE "#\\n")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*YES-OR-NO-P-WAIT-DEFAULT*" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP
      NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE "\"No\"")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "INTERNAL-REAL-TIME-IN-SECONDS" :PACKAGE-NAME "TEXT-QUERY"
      :EXTERNALP NIL)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-CHAR-WAIT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "TIMEOUT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL) 20)
      (:NAME "INPUT-STREAM" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      ((:NAME "EOF-ERROR-P" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (:NAME "EOF-VALUE" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "PEEK" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-LINE-WAIT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "TIMEOUT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL) 20)
      (:NAME "INPUT-STREAM" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      ((:NAME "EOF-ERROR-P" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (:NAME "EOF-VALUE" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "PEEK" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "QUERY" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "OPTIONS" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORMAT-STRING" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORMAT-ARGUMENTS" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL))
     :DOCUMENTATION
     "QUERY is used for asking questions of the user. OPTIONS is a property-list
   containing the following keywords:
      :TYPE              :char or :line (how *query-io* is read)
      :CHOICES           A list containing entries of the form 
                         (<value> . <key>*) or ((<value> <print>) . <key>*), 
                         where <value> is the value to be returned, <key> is
                         a character or string, as the case may be, that is
                         used to select the <value>, and <print> is printed
                         when the value is selected.
      :BEEP              Specifies whether to ring the bell.
      :CLEAR-INPUT       If T, does a clear-input before querying.
      :FRESH-LINE        If T, starts on a fresh line before printing
                         the prompt.
      :LIST-CHOICES      If T, prints a list of the choices after the prompt.
      :HELP-STRING       A string to be printed if the user asks for help.
      :TIMEOUT           The number of seconds to wait, if using timeouts.
      :TIMEOUT-DEFAULT   The default value to use if the query times out.
      :STREAM            The stream to use. Defaults to *query-io*
      :SIGNAL-CONDITION  If T, will signal a condition of type QUERY-ERROR
                         before proceeding. If non-NIL but not T, uses the
                         value as the name of the condition. 
      :EOF-ERROR-P       If T (the default), signals an error if eof is
                         reached. If NIL, returns EOF-VALUE upon reaching eof
      :EOF-VALUE         Value returned if eof is reached and eof-error-p is
                         NIL.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "Y-OR-N-P" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORMAT-STRING" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORMAT-ARGUMENTS" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL))
     :DOCUMENTATION
     "Y-OR-N-P prints the message, if supplied, and reads a character
   from *QUERY-IO* until the user types a Y or an N, returning T and
   NIL, respectively. Repeats the request if the user typed anything
   else. Also, if a H or ? is enterred, prints a brief help message.
   If you want a question mark at the end of the message, you must
   put it there yourself; Y-OR-N-P will not add it.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "YES-OR-NO-P" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORMAT-STRING" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORMAT-ARGUMENTS" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL))
     :DOCUMENTATION
     "YES-OR-NO-P prints the message, if supplied, rings the bell, and
   reads a line from *QUERY-IO* (ignoring whitespace) until the user
   types YES or NO, returning T and NIL, respectively. Repeats the
   request if the user typed anything else. Also, if HELP, H or ? is 
   enterred, prints a brief help message. If you want a question mark
   at the end of the message, you must put it there yourself;
   YES-OR-NO-P will not add it.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "Y-OR-N-P-WAIT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "DEFAULT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "*Y-OR-N-P-WAIT-DEFAULT*" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP
        NIL))
      ((:NAME "TIMEOUT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "*TIMEOUT*" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL))
      (:NAME "FORMAT-STRING" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORMAT-ARGUMENTS" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL))
     :DOCUMENTATION
     "Y-OR-N-P-WAIT is like Y-OR-N-P, but will timeout after TIMEOUT seconds
   with DEFAULT as the default value.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "YES-OR-NO-P-WAIT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "DEFAULT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "*YES-OR-NO-P-WAIT-DEFAULT*" :PACKAGE-NAME "TEXT-QUERY"
        :EXTERNALP NIL))
      ((:NAME "TIMEOUT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "*TIMEOUT*" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL))
      (:NAME "FORMAT-STRING" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORMAT-ARGUMENTS" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL))
     :DOCUMENTATION
     "YES-OR-NO-P-WAIT is like YES-OR-NO-P, but will timeout after TIMEOUT seconds
   with DEFAULT as the default value.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "QUERY-INTERNAL" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORMAT-STRING" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      (:NAME "FORMAT-ARGUMENTS" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      ((:NAME "TYPE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "CHAR" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))
      ((:NAME "CHOICES" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "*Y-OR-N-P-CHOICES*" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL))
      ((:NAME "BEEP" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "CLEAR-INPUT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "FRESH-LINE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "FRESH-LINE-P" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL))
      ((:NAME "LIST-CHOICES" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "HELP-STRING" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (:NAME "TIMEOUT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      (:NAME "TIMEOUT-DEFAULT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
      ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "*QUERY-IO*" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "SIGNAL-CONDITION" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "EOF-ERROR-P" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "EOF-VALUE" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP NIL)
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION NIL))
   :EXTERNAL-SYMBOLS
   ((:NAME "Y-OR-N-P-WAIT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP T)
    (:NAME "YES-OR-NO-P-WAIT" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP T)
    (:NAME "YES-OR-NO-P" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP T)
    (:NAME "Y-OR-N-P" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP T)
    (:NAME "QUERY" :PACKAGE-NAME "TEXT-QUERY" :EXTERNALP T)))))
