
(:TYPE :SYSTEM :NAME "rfc2388-binary" :AUTHOR NIL :MAINTAINER NIL :VERSION NIL
 :LICENCE NIL :DESCRIPTION NIL :LONG-DESCRIPTION NIL :DEPENDS-ON NIL
 :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "RFC2388-BINARY" :FULL-NAME "RFC2388-BINARY"
   :DOCUMENTATION NIL :SYMBOL-LIST
   ((:TYPE :VARIABLE :SYMBOL
     (:NAME "*DEBUG*" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
     :DOCUMENTATION
     "When T we compile the code with some logging statements built in."
     :INITIAL-VALUE "NIL")
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEBUG-MESSAGE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "MESSAGE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "MESSAGE-CONTROL" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "LINEAR-WHITESPACE-BYTE?" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP
      NIL)
     :LAMBDA-LIST ((:NAME "BYTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "In short: is it a space or a tab?")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "AS-ASCII-CHAR" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "BYTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Assuming BYTE is an ASCII coded character retun the corresponding character.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ASCII-STRING-TO-BOUNDARY-ARRAY" :PACKAGE-NAME "RFC2388-BINARY"
      :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MIME-PART-HEADERS-TO-ALIST" :PACKAGE-NAME "RFC2388-BINARY"
      :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "MIME-PART" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
      (:NAME "CONTENT" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-MIME-FILE-WRITER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "FILE-NAME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "BYTE-ENCODER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       ((:NAME "FUNCTION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CODE-CHAR" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-MIME-BUFFER-WRITER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "BYTE-ENCODER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       ((:NAME "FUNCTION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CODE-CHAR" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :GENERIC :SYMBOL
     (:NAME "READ-MIME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "SOURCE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
      (:NAME "BOUNDARY" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
      (:NAME "CALLBACK" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL))
     :DOCUMENTATION "Parses the MIME entites in SOURCE.

SOURCE is either a vector of (unsigned-byte 8) or a stream whose
element-type is (unsigned-byte 8). BOUNDARY is either a string of
US-ASCII encodeable characters or a byte vector. CALLBACK is a
function which will be passed one argument, a MIME-PART
containing the headers of the mime part and must return the following
values:

- a byte-handler function. This is a one argument function which
  will be passed every byte in the mime part's content.

- a termination function. This is a function without arguments
  and will be called when the operation finishes without errors.
  It must return whatever is to be returned from read-mime.

- an optional abort function. This is a function without arguments
  and will be called when the operation is aborted due to an error.

READ-MIME consumes bytes from SOURCE and returns a list of the
whatever the various termination functions returned.

Example:

 (read-mime #<a binary stream> \"123\"
            (lambda (mime-part)
              (values (lambda (byte) (collect-byte-somewhere byte))
                      (lambda () mime-part))))

  This call would return a list of mime-part objects passing each
byte to collect-byte-somewhere.

You may also want to look at UCW for a real-world example.")
    (:TYPE :CLASS :SYMBOL
     (:NAME "MIME-PART" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :SUPER-CLASS-LIST NIL :DOCUMENTATION NIL :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "CONTENT" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T) :ACCESSORS
       ((:NAME "CONTENT" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)) :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "CONTENT-LENGTH" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
       :ACCESSORS
       ((:NAME "CONTENT-LENGTH" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "CONTENT-TYPE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
       :ACCESSORS
       ((:NAME "CONTENT-TYPE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "CONTENT-CHARSET" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
       :ACCESSORS
       ((:NAME "CONTENT-CHARSET" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "HEADERS" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T) :ACCESSORS
       ((:NAME "HEADERS" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)) :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :GENERIC :SYMBOL
     (:NAME "MIME-PART-P" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "OBJECT" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "MIME-PART-P" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "OBJECT" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "MIME-PART-P" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "OBJECT" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "MIME-PART-P" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "OBJECT" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       (:NAME "MIME-PART" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "MIME-PART-P" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "OBJECT" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       (:NAME "MIME-PART" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PRINT-MIME-PART" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "PART" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "*TRACE-OUTPUT*" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :GENERIC :SYMBOL
     (:NAME "GET-HEADER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "PART" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
      (:NAME "HEADER-NAME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T))
     :DOCUMENTATION
     "Returns the mime-header object for the header named HEADER-NAME (a string).")
    (:TYPE :METHOD :SYMBOL
     (:NAME "GET-HEADER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "PART" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       (:NAME "MIME-PART" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T))
      ((:NAME "HEADER-NAME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
       (:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :CLASS :SYMBOL
     (:NAME "MIME-HEADER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
     :SUPER-CLASS-LIST NIL :DOCUMENTATION NIL :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "NAME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "HEADER-NAME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "VALUE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "HEADER-VALUE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ATTRIBUTES" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "HEADER-ATTRIBUTES" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP
         T))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :GENERIC :SYMBOL
     (:NAME "GET-HEADER-ATTRIBUTE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
      (:NAME "NAME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL))
     :DOCUMENTATION "Returns the value of the attribute named NAME
  in the header HEADER.")
    (:TYPE :METHOD :SYMBOL
     (:NAME "GET-HEADER-ATTRIBUTE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "HEADER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       (:NAME "MIME-HEADER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL))
      ((:NAME "NAME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       (:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-MIME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "SOURCE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
      (:NAME "BOUNDARY" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "WRITE-CONTENT-TO-FILE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP
       NIL)
      ((:NAME "BYTE-ENCODER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       ((:NAME "FUNCTION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CODE-CHAR" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))))
     :DOCUMENTATION "Parses MIME entities, returning them as a list.

Each element in the list is of form: (body headers), where BODY is the
contents of MIME part, and HEADERS are all headers for that part.
BOUNDARY is a string used to separate MIME entities.

This is the convenience interface to READ-MIME, all data is read
into memory or a file and we assume that every byte in the data
corresponds to exactly one character.

The SOURCE and BOUNDARY arguments are passed unchanged to
READ-MIME. See READ-MIME's documentation for details.")
    (:TYPE :METHOD :SYMBOL
     (:NAME "READ-MIME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "SOURCE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       (:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (:NAME "BOUNDARY" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
      (:NAME "CALLBACK-FACTORY" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "READ-MIME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "SOURCE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "BOUNDARY" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       (:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (:NAME "CALLBACK-FACTORY" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "READ-MIME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "SOURCE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "BOUNDARY" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
       (:NAME "ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (:NAME "CALLBACK-FACTORY" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-UNTIL-NEXT-BOUNDARY" :PACKAGE-NAME "RFC2388-BINARY"
      :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BOUNDARY" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
      (:NAME "DATA-HANDLER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ASSUME-FIRST-BOUNDARY" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP
       NIL))
     :DOCUMENTATION
     "Reads from STREAM up to the next boundary. For every byte of
data in stream we call DATA-HANDLER passing it the byte. Returns
T if there's more data to be read, NIL otherwise.

The ASSUME-FIRST-BOUNDARY parameter should T if we're reading the
first part of a MIME message, where there is no leading CR LF
sequence.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-NEXT-HEADER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Reads the next header from STREAM. Returns, as the first
  value, T if a header was found and NIL otherwise. When a header
  is found two more values are returned: the header name (a
  string) and the header value (also a string). Headers are
  assumed to be encoded in 7bit ASCII.

The returned strings may actually be displaced arrays.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-KEY-VALUES" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "KEY-VALUE-STRING" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns an alist of the keys and values in KEY-VALUE-STRING.

KEY-VALUE-STRING is of the form: (w+=\"w+\";)*")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-HEADER-VALUE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "HEADER-VALUE-STRING" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP
       NIL))
     :DOCUMENTATION "Returns the value in header-value-string and any associated
  attributes."))
   :EXTERNAL-SYMBOLS
   ((:NAME "GET-HEADER" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "CONTENT" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "CONTENT-TYPE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "READ-MIME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "HEADER-NAME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "MIME-PART-P" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "HEADERS" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "PARSE-HEADER-VALUE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "CONTENT-LENGTH" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "HEADER-VALUE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "CONTENT-CHARSET" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "PRINT-MIME-PART" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "MIME-PART" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "HEADER-ATTRIBUTES" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "PARSE-MIME" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP T)
    (:NAME "GET-HEADER-ATTRIBUTE" :PACKAGE-NAME "RFC2388-BINARY" :EXTERNALP
     T)))))
