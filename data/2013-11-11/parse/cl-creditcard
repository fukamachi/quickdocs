
(:TYPE :SYSTEM :NAME "cl-creditcard" :AUTHOR "<programmers@acceleration.net>"
 :MAINTAINER NIL :VERSION "0.1" :LICENCE "MIT" :DESCRIPTION
 "Generic interace library for talking with credit card processors."
 :LONG-DESCRIPTION NIL :DEPENDS-ON ("ITERATE") :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "CL-CREDITCARD" :FULL-NAME "CL-CREDITCARD"
   :DOCUMENTATION "Library for charging credit cards." :SYMBOL-LIST
   ((:TYPE :GENERIC :SYMBOL
     (:NAME "SALE" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "PROCESSOR" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "CC-DATA" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
      (:NAME "AMOUNT" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&ALLOW-OTHER-KEYS" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Do a one time charge on a credit card for an amount using
the given processor. Other provided keys are up to the processor to interpret
or ignore.

Returns the transaction's unique identifier if successful.")
    (:TYPE :GENERIC :SYMBOL
     (:NAME "AUTHORIZE" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "PROCESSOR" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "CC-DATA" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
      (:NAME "AMOUNT" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&ALLOW-OTHER-KEYS" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Do a pre-authorization without capture returning a
transaction identifier that can later be used with preauth-capture.")
    (:TYPE :GENERIC :SYMBOL
     (:NAME "PREAUTH-CAPTURE" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "PROCESSOR" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "TRANSACTION-ID" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "AMOUNT" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "&ALLOW-OTHER-KEYS" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Capture a charge that was previously authorized with authorize.
Some processors allow capturing a different amount than was originally authorized.")
    (:TYPE :GENERIC :SYMBOL
     (:NAME "VOID" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "PROCESSOR" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "TRANSACTION-ID" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&ALLOW-OTHER-KEYS" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Void a previous transaction.")
    (:TYPE :GENERIC :SYMBOL
     (:NAME "CREDIT" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "PROCESSOR" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "CC-DATA" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "TRANSACTION-ID" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "AMOUNT" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "&ALLOW-OTHER-KEYS" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Credit a charge, if transaction-id is present this is a credit against a precviouly charged authorization")
    (:TYPE :CLASS :SYMBOL
     (:NAME "CC-DATA" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
     :SUPER-CLASS-LIST NIL :DOCUMENTATION
     "Class to hold data that normally goes with a credit card charge.
We interact with this class only through the accessors and never actually check
the type, so you can feed it any data structure that responds to these set of accessors."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ACCOUNT" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T) :ACCESSORS
       ((:NAME "ACCOUNT" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)) :READERS
       NIL :WRITERS NIL :DOCUMENTATION "The card number.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "EXPDATE" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T) :ACCESSORS
       ((:NAME "EXPDATE" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)) :READERS
       NIL :WRITERS NIL :DOCUMENTATION "The card expiration date")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "CCV" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T) :ACCESSORS
       ((:NAME "CCV" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION
       "Card [Code] Verification value. Usually 3-4 digits on back of card.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ADDRESS" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T) :ACCESSORS
       ((:NAME "ADDRESS" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)) :READERS
       NIL :WRITERS NIL :DOCUMENTATION
       "Street address for AVS. Typically only numbers need to
be passed in this fields.  Letters and other characters are ignored.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ZIP" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T) :ACCESSORS
       ((:NAME "ZIP" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION "Zipcode for AVS verfication.")))
    (:TYPE :GENERIC :SYMBOL
     (:NAME "LUHN-CHECK-P" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "CARD-NUMBER" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL))
     :DOCUMENTATION "Check the credit-card number is valid looking based on
the luhn algorithm: http://en.wikipedia.org/wiki/Luhn_algorithm")
    (:TYPE :GENERIC :SYMBOL
     (:NAME "ENOUGH-DATA-P" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "CC-DATA" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "REQUIRE-AVS" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "REQUIRE-CCV" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "ERROR-P" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL))
     :DOCUMENTATION "Check that a cc-data like structure has enough data to
complete a transaction.
Can optionally require that AVS verification, Card Verfication data be present.
Can optionally signal an error if data isn't present.

Some merchant accounts will incur extra fees if AVS isn't used.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-KEYWORD-FROM-STRING" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP
      NIL)
     :LAMBDA-LIST ((:NAME "STR" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL))
     :DOCUMENTATION "Safely read a string into the keyword package.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REPLACE-ALL" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "PART" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "REPLACEMENT" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "TEST" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP NIL)
       ((:NAME "FUNCTION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CHAR=" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))))
     :DOCUMENTATION
     "Returns a new string in which all the occurences of the part 
is replaced with replacement. [FROM http://cl-cookbook.sourceforge.net/strings.html#manip]"))
   :EXTERNAL-SYMBOLS
   ((:NAME "ADDRESS" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "NAME" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "EXPDATE" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "VOID" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "DENY-EXCEPTION" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "LUHN-CHECK-P" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "ACCOUNT" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "CC-DATA" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "AUTHORIZE" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "PREAUTH-CAPTURE" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "TEST-MODE" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "CCV" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "ENOUGH-DATA-P" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "SALE" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)
    (:NAME "ZIP" :PACKAGE-NAME "CL-CREDITCARD" :EXTERNALP T)))))
