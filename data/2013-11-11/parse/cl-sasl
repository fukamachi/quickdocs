
(:TYPE :SYSTEM :NAME "cl-sasl" :AUTHOR
 "Magnus Henoch <magnus.henoch@gmail.com>" :MAINTAINER NIL :VERSION "0.3.1"
 :LICENCE "BSD-style" :DESCRIPTION "SASL library" :LONG-DESCRIPTION NIL
 :DEPENDS-ON ("IRONCLAD") :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "SASL" :FULL-NAME "SASL" :DOCUMENTATION NIL
   :SYMBOL-LIST
   ((:TYPE :FUNCTION :SYMBOL
     (:NAME "STRING-TO-UTF8" :PACKAGE-NAME "SASL" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)) :DOCUMENTATION
     "Convert STRING to UTF-8.  Return a vector of unsigned-bytes.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "STRING-TO-UTF8-LISP" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Convert STRING to UTF-8.  Return a vector of unsigned-bytes.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "IN-LATIN1-P" :PACKAGE-NAME "SASL" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "CHAR" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)) :DOCUMENTATION
     "Return non-nil if CHAR is in the ISO 8859-1 character set.")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "MECHANISMS" :PACKAGE-NAME "SASL" :EXTERNALP NIL) :DOCUMENTATION
     "List of SASL mechanisms in order of preference.
Each element is a list describing a mechanism.  The first item is
the name of the mechanism.  The second item is the class
implementing it.  The remaining items are properties of the
mechanism:

:CLEARTEXT    Password is sent in clear text or with weak encryption
:ANONYMOUS    Mechanism negotiates anonymous access"
     :INITIAL-VALUE
     "'((\"DIGEST-MD5\" SASL:DIGEST-MD5) (\"PLAIN\" SASL:PLAIN :CLEARTEXT)
  (\"ANONYMOUS\" SASL:ANONYMOUS :ANONYMOUS))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "GET-MECHANISM" :PACKAGE-NAME "SASL" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "NAME" :PACKAGE-NAME "SASL" :EXTERNALP NIL)) :DOCUMENTATION
     "Return the class name for the mechanism called NAME, or nil if not implemented.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CHOOSE-MECHANISM" :PACKAGE-NAME "SASL" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "AVAILABLE" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "CLEARTEXT" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "ANONYMOUS" :PACKAGE-NAME "SASL" :EXTERNALP T)
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION "Choose an SASL mechanism from AVAILABLE.
Return the class implementing the mechanism, or nil if no mechanism
is suitable.
AVAILABLE is a list of strings, naming the mechanisms offered by the
server.
If CLEARTEXT is true, accept mechanisms that send passwords in clear
text or with weak encryption.
If ANONYMOUS is true, use mechanisms that acquire anonymous access.")
    (:TYPE :CLASS :SYMBOL (:NAME "CLIENT" :PACKAGE-NAME "SASL" :EXTERNALP T)
     :SUPER-CLASS-LIST NIL :DOCUMENTATION
     "Abstract base class for SASL clients using various mechanisms."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "AUTHC-ID" :PACKAGE-NAME "SASL" :EXTERNALP T) :ACCESSORS
       ((:NAME "AUTHC-ID" :PACKAGE-NAME "SASL" :EXTERNALP T)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION "The authentication id.
This is the user whose credentials you are providing to the server.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "AUTHZ-ID" :PACKAGE-NAME "SASL" :EXTERNALP T) :ACCESSORS
       ((:NAME "AUTHZ-ID" :PACKAGE-NAME "SASL" :EXTERNALP T)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION "The authorization id.
This is the user you want to act as.  You don't need to provide it
unless it is different from the authentication id.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "PASSWORD" :PACKAGE-NAME "SASL" :EXTERNALP T) :ACCESSORS
       ((:NAME "PASSWORD" :PACKAGE-NAME "SASL" :EXTERNALP T)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION "The password.
This is either a string, or a function taking no arguments and
returning the password.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "SERVICE" :PACKAGE-NAME "SASL" :EXTERNALP T) :ACCESSORS
       ((:NAME "SERVICE" :PACKAGE-NAME "SASL" :EXTERNALP T)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION "The service name.
Common values include \"xmpp\" and \"imap\".")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "HOST" :PACKAGE-NAME "SASL" :EXTERNALP T) :ACCESSORS
       ((:NAME "HOST" :PACKAGE-NAME "SASL" :EXTERNALP T)) :READERS NIL :WRITERS
       NIL :DOCUMENTATION "The hostname of the service.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "SERV-NAME" :PACKAGE-NAME "SASL" :EXTERNALP T) :ACCESSORS
       ((:NAME "SERV-NAME" :PACKAGE-NAME "SASL" :EXTERNALP T)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION "The specific server you are connecting to
(if different from the hostname).")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "MECHANISM-NAME" :PACKAGE-NAME "SASL" :EXTERNALP T) :ACCESSORS
       NIL :READERS
       ((:NAME "MECHANISM-NAME" :PACKAGE-NAME "SASL" :EXTERNALP T)) :WRITERS
       NIL :DOCUMENTATION NIL)))
    (:TYPE :GENERIC :SYMBOL
     (:NAME "CLIENT-STEP" :PACKAGE-NAME "SASL" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "CLIENT" :PACKAGE-NAME "SASL" :EXTERNALP T)
      (:NAME "SERVER-INPUT" :PACKAGE-NAME "SASL" :EXTERNALP NIL))
     :DOCUMENTATION "Perform a step in the SASL authentication.
SERVER-INPUT is a byte vector containing the response from the
server, or NIL if the client should start the exchange, or the
keyword :SUCCESS if the server reported successful
authentication.

Returns a byte vector to be sent in response to the server,
or :SUCCESS if the client should consider authentication
successful, or :FAILURE if the client should consider
authentication failed.  Obeying this result is important, as some
mechanisms provide mutual authentication.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "GET-PASSWORD" :PACKAGE-NAME "SASL" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "PASSWORD" :PACKAGE-NAME "SASL" :EXTERNALP T)) :DOCUMENTATION NIL)
    (:TYPE :CLASS :SYMBOL (:NAME "PLAIN" :PACKAGE-NAME "SASL" :EXTERNALP T)
     :SUPER-CLASS-LIST ((:NAME "CLIENT" :PACKAGE-NAME "SASL" :EXTERNALP T))
     :DOCUMENTATION "Client-side implementation of the SASL PLAIN mechanism,
as specified in RFC 2595, section 6."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "STATE" :PACKAGE-NAME "SASL" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "STATE" :PACKAGE-NAME "SASL" :EXTERNALP NIL)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "MECHANISM-NAME" :PACKAGE-NAME "SASL" :EXTERNALP T) :ACCESSORS
       NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :METHOD :SYMBOL
     (:NAME "CLIENT-STEP" :PACKAGE-NAME "SASL" :EXTERNALP T) :LAMBDA-LIST
     (((:NAME "C" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
       (:NAME "PLAIN" :PACKAGE-NAME "SASL" :EXTERNALP T))
      (:NAME "SERVER-INPUT" :PACKAGE-NAME "SASL" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :CLASS :SYMBOL
     (:NAME "DIGEST-MD5" :PACKAGE-NAME "SASL" :EXTERNALP T) :SUPER-CLASS-LIST
     ((:NAME "CLIENT" :PACKAGE-NAME "SASL" :EXTERNALP T)) :DOCUMENTATION
     "Client-side implementation of the SASL DIGEST-MD5 mechanism,
as specified in RFC 2831."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "REALM" :PACKAGE-NAME "SASL" :EXTERNALP T) :ACCESSORS
       ((:NAME "REALM" :PACKAGE-NAME "SASL" :EXTERNALP T)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION
       "The realm to which the user's account belongs.
If it is not specified, the first realm that the server advertises will
be chosen.  Many servers don't use realms.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "STATE" :PACKAGE-NAME "SASL" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "STATE" :PACKAGE-NAME "SASL" :EXTERNALP NIL)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "NONCE" :PACKAGE-NAME "SASL" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "NONCE" :PACKAGE-NAME "SASL" :EXTERNALP NIL)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "CNONCE" :PACKAGE-NAME "SASL" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "CNONCE" :PACKAGE-NAME "SASL" :EXTERNALP NIL)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "DIGEST-URI-VALUE" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "DIGEST-URI-VALUE" :PACKAGE-NAME "SASL" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "MECHANISM-NAME" :PACKAGE-NAME "SASL" :EXTERNALP T) :ACCESSORS
       NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :METHOD :SYMBOL
     (:NAME "CLIENT-STEP" :PACKAGE-NAME "SASL" :EXTERNALP T) :LAMBDA-LIST
     (((:NAME "C" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
       (:NAME "DIGEST-MD5" :PACKAGE-NAME "SASL" :EXTERNALP T))
      (:NAME "SERVER-INPUT" :PACKAGE-NAME "SASL" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "RESPONSE-VALUE" :PACKAGE-NAME "SASL" :EXTERNALP NIL) :LAMBDA-LIST
     (((:NAME "C" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
       (:NAME "DIGEST-MD5" :PACKAGE-NAME "SASL" :EXTERNALP T))
      (:NAME "REQUEST" :PACKAGE-NAME "SASL" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "RESPONSE" :PACKAGE-NAME "SASL" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "AUTHC-ID" :PACKAGE-NAME "SASL" :EXTERNALP T)
      (:NAME "AUTHZ-ID" :PACKAGE-NAME "SASL" :EXTERNALP T)
      (:NAME "REALM" :PACKAGE-NAME "SASL" :EXTERNALP T)
      (:NAME "PASSWORD" :PACKAGE-NAME "SASL" :EXTERNALP T)
      (:NAME "DIGEST-URI" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
      (:NAME "NONCE" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
      (:NAME "CNONCE" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
      (:NAME "NC" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
      (:NAME "QOP" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
      (:NAME "REQUEST" :PACKAGE-NAME "SASL" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-CHALLENGE" :PACKAGE-NAME "SASL" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "CHALLENGE" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "START" :PACKAGE-NAME "SASL" :EXTERNALP NIL) 0)
      (:NAME "ACCUMULATED" :PACKAGE-NAME "SASL" :EXTERNALP NIL))
     :DOCUMENTATION "Parse CHALLENGE and return it as an alist.
Start at index START.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "STRING-TO-LATIN1-OR-UTF8" :PACKAGE-NAME "SASL" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Convert STRING to ISO 8859-1 if possible, else to UTF-8.
Return a byte vector."))
   :EXTERNAL-SYMBOLS
   ((:NAME "GET-MECHANISM" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "DIGEST-MD5" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "SERV-NAME" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "CLIENT" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "REALM" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "ANONYMOUS" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "MECHANISM-NAME" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "CHOOSE-MECHANISM" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "AUTHC-ID" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "HOST" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "PLAIN" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "AUTHZ-ID" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "CLIENT-STEP" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "SERVICE" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "TRACE-DATA" :PACKAGE-NAME "SASL" :EXTERNALP T)
    (:NAME "PASSWORD" :PACKAGE-NAME "SASL" :EXTERNALP T)))))
