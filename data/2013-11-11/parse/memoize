
(:TYPE :SYSTEM :NAME "memoize" :AUTHOR NIL :MAINTAINER NIL :VERSION NIL
 :LICENCE NIL :DESCRIPTION NIL :LONG-DESCRIPTION NIL :DEPENDS-ON NIL
 :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "ORG.TFEB.HAX.MEMOIZE" :FULL-NAME
   "ORG.TFEB.HAX.MEMOIZE" :DOCUMENTATION NIL :SYMBOL-LIST
   ((:TYPE :VARIABLE :SYMBOL
     (:NAME "*MEMOIZED-FUNCTIONS*" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE"
      :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE "'NIL")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-MEMO" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "FN" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL)
      (:NAME "KEY" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL)
      (:NAME "TEST" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MEMOIZE-FUNCTION" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP
      T)
     :LAMBDA-LIST
     ((:NAME "FN-NAME" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "KEY" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL)
       ((:NAME "FUNCTION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "FIRST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
      ((:NAME "TEST" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL)
       ((:NAME "FUNCTION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))))
     :DOCUMENTATION
     "Memoize FN-NAME, a symbol, causing its results to be stashed.
KEY is a function which is given the arglist of FN-NAME, and should return
a key to hash on for memoizing.  TEST is a function which  the test for the
ashtable.
See Norvig P269-275.

Note this function may not work on self-recursive functions because the
compiler can optimize away self-calls in various ways.  
DEF-MEMOIZED-FUNCTION should work for those cases as it is careful to ensure
the function can not be inlined like this.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "UNMEMOIZE-FUNCTION" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE"
      :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "FN-NAME" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL))
     :DOCUMENTATION "Remove memoization for FN-NAME")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "UNMEMOIZE-FUNCTIONS" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE"
      :EXTERNALP T)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION "Unmemoize all functions")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CLEAR-MEMOIZED-FUNCTION" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE"
      :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "FN-NAME" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL))
     :DOCUMENTATION "Clear memoized results for FN-NAME")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CLEAR-MEMOIZED-FUNCTIONS" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE"
      :EXTERNALP T)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION "Clear memoized results for all functions")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FUNCTION-MEMOIZED-P" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE"
      :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "FN-NAME" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL))
     :DOCUMENTATION "Is FN-NAME memoized?")
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEF-MEMOIZED-FUNCTION" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE"
      :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "FNSPEC" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL)
      (:NAME "ARGS" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BOD" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL))
     :DOCUMENTATION "Define a memoized function.
FNSPEC is either the name of the function, or a list suitable as an arglist
for MEMOIZE-FUNCTION.  ARGS & BOD are passed off to DEFUN.

This will declare FNSPEC NOTINLINE, which may be necessary to prevent good
compilers optimizing away self calls & stuff like that.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "MEMOIZED-LABELS" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP
      T)
     :LAMBDA-LIST
     (((:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "LABDEFS" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL))
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BOD" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP NIL))
     :DOCUMENTATION "A version of LABELS that memoizes the local functions.  See
MEMOIZE-FUNCTION and DEF-MEMOIZED-FUNCTION.  If code that uses this is
compiled (either by COMPILE or COMPILE-FILE, then the table of memoized
results will be unique, if interpreted then a new table may be generated for
each use.  The function `names' are generalised in the same way as for 
DEF-MEMOIZED-FUNCTION."))
   :EXTERNAL-SYMBOLS
   ((:NAME "UNMEMOIZE-FUNCTION" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP
     T)
    (:NAME "DEF-MEMOIZED-FUNCTION" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE"
     :EXTERNALP T)
    (:NAME "MEMOIZED-LABELS" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP T)
    (:NAME "UNMEMOIZE-FUNCTIONS" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE"
     :EXTERNALP T)
    (:NAME "MEMOIZE-FUNCTION" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE" :EXTERNALP
     T)
    (:NAME "FUNCTION-MEMOIZED-P" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE"
     :EXTERNALP T)
    (:NAME "CLEAR-MEMOIZED-FUNCTIONS" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE"
     :EXTERNALP T)
    (:NAME "CLEAR-MEMOIZED-FUNCTION" :PACKAGE-NAME "ORG.TFEB.HAX.MEMOIZE"
     :EXTERNALP T)))))
