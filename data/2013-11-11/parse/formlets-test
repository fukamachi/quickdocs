
(:TYPE :SYSTEM :NAME "formlets-test" :AUTHOR "leo.zovic@gmail.com" :MAINTAINER
 "leo.zovic@gmail.com" :VERSION "0.1" :LICENCE "MIT-style" :DESCRIPTION
 "Testing system to simplify development of the validating formlets system for Hunchentoot"
 :LONG-DESCRIPTION NIL :DEPENDS-ON
 ("CL-WHO" "DRAKMA" "HUNCHENTOOT" "CL-PPCRE" "FORMLETS") :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "FORMLETS-TEST" :FULL-NAME "FORMLETS-TEST"
   :DOCUMENTATION
   "A package implementing the testing tools auto-validating formlets for Hunchentoot"
   :SYMBOL-LIST
   ((:TYPE :VARIABLE :SYMBOL
     (:NAME "*CSS*" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "\".form-fields { list-style: none; padding-bottom: 0px; }
.form-fields li { margin-bottom: 10px; clear: both; }
.form-fields input { margin: 0px; }
.form-fields .text-box { border: 1px solid #1c2a51; width: 250px; }
.form-fields textarea { border: 1px solid #1c2a51; width: 246px; height: 60px; }
.submit { border: 1px solid #1c2a51; background-color: #1c2a51; color: #fff; font-weight: bold; padding: 3px 8px; }
.form-fields .label { width: 130px; display: block; float: left; text-align: right; padding-right: 5px; height: 20px; }

.general-error p, .formlet-error p { border: 1px solid #900; background-color: #faa; margin: 0px; padding: 2px 5px; }
.general-error p { margin: 10px 0px 0px 195px; width: 236px; }

.formlet-error { position: absolute; padding: 2px; margin-left: 5px; }
.general-error { position: relative; }\"")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*WEB-SERVER*" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE "NIL")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FORMLETS-TEST" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "PORT" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL) 4141))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "PAGE-TEMPLATE" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL)
     :LAMBDA-LIST
     (((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "TITLE" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL))
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "TEST-FORM" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "(MAKE-INSTANCE 'FORMLETS:FORMLET :NAME 'FORMLETS-TEST::TEST-FORM :SUBMIT
               \"Submit\" :ENCTYPE \"application/x-www-form-urlencoded\"
               :VALIDATION-FUNCTIONS NIL :ERROR-MESSAGES NIL :FIELDS
               (LIST
                (MAKE-INSTANCE 'FORMLETS:TEXT :NAME \"one\" :DEFAULT-VALUE NIL
                               :VALIDATION-FUNCTIONS
                               (LIST (FORMLETS:NOT-BLANK?)
                                     (FORMLETS:MISMATCHES? \"blah\")
                                     (FORMLETS:LONGER-THAN? 5))
                               :ERROR-MESSAGES
                               (LIST \"This field cannot be left empty\"
                                     \"You can't write \\\"blah\\\" here\"
                                     \"You need to enter more than 5 characters\"))
                (MAKE-INSTANCE 'FORMLETS:TEXTAREA :NAME \"two\" :DEFAULT-VALUE
                               NIL :VALIDATION-FUNCTIONS (LIST) :ERROR-MESSAGES
                               (LIST))
                (MAKE-INSTANCE 'FORMLETS:PASSWORD :NAME \"three\" :DEFAULT-VALUE
                               NIL :VALIDATION-FUNCTIONS (LIST) :ERROR-MESSAGES
                               (LIST))
                (MAKE-INSTANCE 'FORMLETS:RECAPTCHA :NAME \"recaptcha\"
                               :DEFAULT-VALUE NIL :VALIDATION-FUNCTIONS (LIST)
                               :ERROR-MESSAGES (LIST)))
               :ON-SUCCESS
               (LAMBDA
                   (FORMLETS-TEST::ONE FORMLETS-TEST::TWO FORMLETS-TEST::THREE
                    FORMLETS:RECAPTCHA)
                 (PROGN
                  (FORMLETS-TEST::PAGE-TEMPLATE (:TITLE \"Results\")
                    (:H4 \"Fuck yeah!\")
                    (:P
                     (CL-WHO:STR
                      (WRITE-TO-STRING (HUNCHENTOOT:POST-PARAMETERS*))))
                    (:P (CL-WHO:STR FORMLETS-TEST::ONE))
                    (:P (CL-WHO:STR FORMLETS-TEST::TWO))
                    (:P (CL-WHO:STR FORMLETS:RECAPTCHA))))))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALIDATE-TEST-FORM" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "TEST-FORM-TWO" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "(MAKE-INSTANCE 'FORMLETS:FORMLET :NAME 'FORMLETS-TEST::TEST-FORM-TWO :SUBMIT
               \"Submit\" :ENCTYPE \"multipart/form-data\" :VALIDATION-FUNCTIONS
               NIL :ERROR-MESSAGES NIL :FIELDS
               (LIST
                (MAKE-INSTANCE 'FORMLETS:TEXT :NAME \"one\" :DEFAULT-VALUE NIL
                               :VALIDATION-FUNCTIONS
                               (LIST
                                (LAMBDA (FORMLETS-TEST::V)
                                  (> 6 (LENGTH FORMLETS-TEST::V))))
                               :ERROR-MESSAGES
                               (LIST
                                \"You can't enter more than 5 characters here\"))
                (MAKE-INSTANCE 'FORMLETS:FILE :NAME \"two\" :DEFAULT-VALUE NIL
                               :VALIDATION-FUNCTIONS (LIST) :ERROR-MESSAGES
                               (LIST))
                (MAKE-INSTANCE 'FORMLETS:SELECT :NAME \"pull-down\"
                               :DEFAULT-VALUE NIL :VALUE-SET
                               (LIST \"one\" \"two\" \"three\" \"four\")
                               :VALIDATION-FUNCTIONS (LIST) :ERROR-MESSAGES
                               (LIST))
                (MAKE-INSTANCE 'FORMLETS:RADIO-SET :NAME \"radio-set\"
                               :DEFAULT-VALUE NIL :VALUE-SET
                               (LIST \"one\" \"two\" \"three\" \"four\")
                               :VALIDATION-FUNCTIONS (LIST) :ERROR-MESSAGES
                               (LIST))
                (MAKE-INSTANCE 'FORMLETS:PASSWORD :NAME \"password\"
                               :DEFAULT-VALUE NIL :VALIDATION-FUNCTIONS (LIST)
                               :ERROR-MESSAGES (LIST))
                (MAKE-INSTANCE 'FORMLETS:PASSWORD :NAME \"confirm-password\"
                               :DEFAULT-VALUE NIL :VALIDATION-FUNCTIONS
                               (LIST (FORMLETS:SAME-AS? \"password\"))
                               :ERROR-MESSAGES
                               (LIST
                                \"You have to enter the same thing here and in the 'Password' field\")))
               :ON-SUCCESS
               (LAMBDA
                   (FORMLETS-TEST::ONE FORMLETS-TEST::TWO
                    FORMLETS-TEST::PULL-DOWN FORMLETS:RADIO-SET
                    FORMLETS:PASSWORD FORMLETS-TEST::CONFIRM-PASSWORD)
                 (PROGN
                  (FORMLETS-TEST::PAGE-TEMPLATE (:TITLE \"Results TWO\")
                    (:H4 \"Wooo!\")
                    (:P
                     (CL-WHO:STR
                      (WRITE-TO-STRING (HUNCHENTOOT:POST-PARAMETERS*))))
                    (:P (CL-WHO:STR FORMLETS-TEST::ONE))
                    (:P (CL-WHO:STR FORMLETS-TEST::PULL-DOWN))
                    (:P (CL-WHO:STR FORMLETS:RADIO-SET))
                    (:P (CL-WHO:STR FORMLETS-TEST::TWO))
                    (:P (CL-WHO:STR FORMLETS:PASSWORD))))))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALIDATE-TEST-FORM-TWO" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP
      NIL)
     :LAMBDA-LIST ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "TEST-FORM-THREE" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "(MAKE-INSTANCE 'FORMLETS:FORMLET :NAME 'FORMLETS-TEST::TEST-FORM-THREE :SUBMIT
               \"Submit\" :ENCTYPE \"application/x-www-form-urlencoded\"
               :VALIDATION-FUNCTIONS NIL :ERROR-MESSAGES NIL :FIELDS
               (LIST
                (MAKE-INSTANCE 'FORMLETS:MULTI-SELECT :NAME \"pull-down\"
                               :DEFAULT-VALUE NIL :VALUE-SET
                               (LIST \"a\" \"b\" \"c\" \"d\") :VALIDATION-FUNCTIONS
                               (LIST
                                (LAMBDA (FORMLETS-TEST::VAL)
                                  (= 2 (LENGTH FORMLETS-TEST::VAL))))
                               :ERROR-MESSAGES
                               (LIST \"Please pick exactly two options\"))
                (MAKE-INSTANCE 'FORMLETS:RADIO-SET :NAME \"radio-set\"
                               :DEFAULT-VALUE NIL :VALUE-SET
                               (LIST \"one\" \"two\" \"three\" \"four\")
                               :VALIDATION-FUNCTIONS (LIST) :ERROR-MESSAGES
                               (LIST))
                (MAKE-INSTANCE 'FORMLETS:CHECKBOX :NAME \"single-check\"
                               :DEFAULT-VALUE NIL :VALIDATION-FUNCTIONS (LIST)
                               :ERROR-MESSAGES (LIST))
                (MAKE-INSTANCE 'FORMLETS:CHECKBOX-SET :NAME \"checking\"
                               :DEFAULT-VALUE NIL :VALUE-SET
                               (LIST \"aye\" \"bee\" \"sea\" \"dee\")
                               :VALIDATION-FUNCTIONS (LIST) :ERROR-MESSAGES
                               (LIST)))
               :ON-SUCCESS
               (LAMBDA
                   (FORMLETS-TEST::PULL-DOWN FORMLETS:RADIO-SET
                    FORMLETS-TEST::SINGLE-CHECK FORMLETS-TEST::CHECKING)
                 (PROGN
                  (FORMLETS-TEST::PAGE-TEMPLATE (:TITLE \"Results TWO\")
                    (:H4 \"Yay!\")
                    (:P
                     (CL-WHO:STR
                      (WRITE-TO-STRING (HUNCHENTOOT:POST-PARAMETERS*))))
                    (:P (CL-WHO:STR FORMLETS-TEST::PULL-DOWN))
                    (:P (CL-WHO:STR FORMLETS:RADIO-SET))
                    (:P (CL-WHO:STR FORMLETS-TEST::SINGLE-CHECK))
                    (:P (CL-WHO:STR FORMLETS-TEST::CHECKING))))))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALIDATE-TEST-FORM-THREE" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP
      NIL)
     :LAMBDA-LIST ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "FAUX-LOGIN-FORM" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "(MAKE-INSTANCE 'FORMLETS:FORMLET :NAME 'FORMLETS-TEST::FAUX-LOGIN-FORM :SUBMIT
               \"Login\" :ENCTYPE \"application/x-www-form-urlencoded\"
               :VALIDATION-FUNCTIONS
               (LIST
                (LAMBDA (FORMLETS-TEST::USER-NAME FORMLETS:PASSWORD)
                  (AND (STRING= \"blah\" FORMLETS-TEST::USER-NAME)
                       (STRING= \"pass\" FORMLETS:PASSWORD))))
               :ERROR-MESSAGES
               (LIST \"I see what you did there. &#3232;_&#3232;\") :FIELDS
               (LIST
                (MAKE-INSTANCE 'FORMLETS:TEXT :NAME \"user-name\" :DEFAULT-VALUE
                               NIL :VALIDATION-FUNCTIONS (LIST) :ERROR-MESSAGES
                               (LIST))
                (MAKE-INSTANCE 'FORMLETS:PASSWORD :NAME \"password\"
                               :DEFAULT-VALUE NIL :VALIDATION-FUNCTIONS (LIST)
                               :ERROR-MESSAGES (LIST)))
               :ON-SUCCESS
               (LAMBDA (FORMLETS-TEST::USER-NAME FORMLETS:PASSWORD)
                 (PROGN
                  (FORMLETS-TEST::PAGE-TEMPLATE (:TITLE \"You got it\")
                    (:P
                     (CL-WHO:STR
                      (WRITE-TO-STRING (HUNCHENTOOT:POST-PARAMETERS*))))
                    (:P (CL-WHO:STR FORMLETS-TEST::USER-NAME))
                    (:P (CL-WHO:STR FORMLETS:PASSWORD))))))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALIDATE-FAUX-LOGIN-FORM" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP
      NIL)
     :LAMBDA-LIST ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "DEFAULT-VALUES-FORM" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "(MAKE-INSTANCE 'FORMLETS:FORMLET :NAME 'FORMLETS-TEST::DEFAULT-VALUES-FORM
               :SUBMIT \"Nope\" :ENCTYPE \"application/x-www-form-urlencoded\"
               :VALIDATION-FUNCTIONS NIL :ERROR-MESSAGES NIL :FIELDS
               (LIST
                (MAKE-INSTANCE 'FORMLETS:HIDDEN :NAME \"minus-one\"
                               :DEFAULT-VALUE NIL :VALIDATION-FUNCTIONS (LIST)
                               :ERROR-MESSAGES (LIST))
                (MAKE-INSTANCE 'FORMLETS:TEXT :NAME \"one\" :DEFAULT-VALUE NIL
                               :VALIDATION-FUNCTIONS
                               (LIST (FORMLETS:LONGER-THAN? 3)) :ERROR-MESSAGES
                               (LIST \"It has to be longer than 3\"))
                (MAKE-INSTANCE 'FORMLETS:TEXTAREA :NAME \"two\" :DEFAULT-VALUE
                               NIL :VALIDATION-FUNCTIONS (LIST) :ERROR-MESSAGES
                               (LIST))
                (MAKE-INSTANCE 'FORMLETS:CHECKBOX :NAME \"three\" :DEFAULT-VALUE
                               NIL :VALIDATION-FUNCTIONS (LIST) :ERROR-MESSAGES
                               (LIST))
                (MAKE-INSTANCE 'FORMLETS:CHECKBOX-SET :NAME \"four\"
                               :DEFAULT-VALUE NIL :VALUE-SET
                               (LIST \"one\" \"two\" \"three\") :VALIDATION-FUNCTIONS
                               (LIST) :ERROR-MESSAGES (LIST)))
               :ON-SUCCESS
               (LAMBDA
                   (FORMLETS-TEST::MINUS-ONE FORMLETS-TEST::ONE
                    FORMLETS-TEST::TWO FORMLETS-TEST::THREE
                    FORMLETS-TEST::FOUR)
                 (PROGN
                  (FORMLETS-TEST::PAGE-TEMPLATE (:TITLE \"You got it\")
                    (:P
                     (CL-WHO:STR
                      (WRITE-TO-STRING (HUNCHENTOOT:POST-PARAMETERS*))))))))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALIDATE-DEFAULT-VALUES-FORM" :PACKAGE-NAME "FORMLETS-TEST"
      :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "TEST-PAGE" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL))
   :EXTERNAL-SYMBOLS
   ((:NAME "FORMLETS-TEST" :PACKAGE-NAME "FORMLETS-TEST" :EXTERNALP T)))))
