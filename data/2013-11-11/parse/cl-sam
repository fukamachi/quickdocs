
(:TYPE :SYSTEM :NAME "cl-sam" :AUTHOR "Keith James" :MAINTAINER NIL :VERSION
 "0.15.1" :LICENCE "GPL v3" :DESCRIPTION NIL :LONG-DESCRIPTION NIL :DEPENDS-ON
 ("(VERSION DEOXYBYTE-GZIP 0.5.1)" "(VERSION DEOXYBYTE-UNIX 0.7.2)")
 :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "BGZF-FFI" :FULL-NAME "BGZF-FFI" :DOCUMENTATION
   "A foreign function interface to the block gzip
  functions provided by the Broad Institute. See bgzf.h in the
  SAMtools package for function documentation."
   :SYMBOL-LIST NIL :EXTERNAL-SYMBOLS
   ((:NAME "BGZF-READ" :PACKAGE-NAME "BGZF-FFI" :EXTERNALP T)
    (:NAME "BGZF-OPEN" :PACKAGE-NAME "BGZF-FFI" :EXTERNALP T)
    (:NAME "BGZF-WRITE" :PACKAGE-NAME "BGZF-FFI" :EXTERNALP T)
    (:NAME "BGZF-CHECK-EOF" :PACKAGE-NAME "BGZF-FFI" :EXTERNALP T)
    (:NAME "BGZF-SEEK" :PACKAGE-NAME "BGZF-FFI" :EXTERNALP T)
    (:NAME "BGZF-TELL" :PACKAGE-NAME "BGZF-FFI" :EXTERNALP T)
    (:NAME "BGZF-CLOSE" :PACKAGE-NAME "BGZF-FFI" :EXTERNALP T)))
  (:TYPE :PACKAGE :NAME "SAM" :FULL-NAME "SAM" :DOCUMENTATION
   "cl-sam is a Common Lisp toolkit for manipulation of
DNA sequence alignment data stored in the Sequence Alignment/Map (SAM)
format <http://samtools.sourceforge.net>. The SAM specficiation
describes text (SAM) and binary (BAM) formats.

cl-sam uses the BGZF block compression code from the SAMtools C
toolkit, but is otherwise an independent Lisp implementation capable
of editing every aspect of BAM files or creating BAM data de novo.

The following example implements something similar to samtools
flagstat:

;;; (with-bgzf (bgzf \"example.bam\" :direction :input)
;;;   (multiple-value-bind (header num-refs ref-meta)
;;;       (read-bam-meta bgzf)
;;;     (format t \"BAM header: ~s~%\" header)
;;;     (format t \"Number of references: ~d~%\" num-refs)
;;;     (loop
;;;        for (id name length) in ref-meta
;;;        do (format t \"Reference name: ~s Length: ~d~%\" id name length)))
;;;   (loop
;;;      for alignment = (read-alignment bgzf)
;;;      while alignment
;;;      for flag = (alignment-flag alignment)
;;;      count flag into total
;;;      count (fails-platform-qc-p flag) into qc-fail
;;;      count (pcr/optical-duplicate-p flag) into duplicates
;;;      count (not (query-unmapped-p flag)) into mapped
;;;      count (sequenced-pair-p flag) into seq-paired
;;;      count (first-in-pair-p flag) into read1
;;;      count (second-in-pair-p flag) into read2
;;;      count (mapped-proper-pair-p flag) into proper-paired
;;;      count (and (not (query-unmapped-p flag))
;;;                 (not (mate-unmapped-p flag))) into both-mapped
;;;      count (mate-unmapped-p flag) into singletons
;;;      finally (format t (str \"~d in total~%\"
;;;                             \"~d QC failure~%\"
;;;                             \"~d duplicates~%\"
;;;                             \"~d mapped (~$%)~%\"
;;;                             \"~d paired in sequencing~%\"
;;;                             \"~d read1~%\"
;;;                             \"~d read2~%\"
;;;                             \"~d properly paired (~$%)~%\"
;;;                             \"~d both mapped~%\"
;;;                             \"~d singletons (~$%)~%\")
;;;                      total qc-fail duplicates mapped
;;;                      (* 100 (/ mapped total))
;;;                      seq-paired read1 read2 proper-paired
;;;                      (* 100 (/ proper-paired total))
;;;                      both-mapped singletons
;;;                      (* 100 (/ singletons total)))))"
   :SYMBOL-LIST
   ((:TYPE :CONSTANT :SYMBOL
     (:NAME "+XLEN+" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :DOCUMENTATION
     "The value of the RCF1952 eXtra LENgth field used by BGZ members."
     :INITIAL-VALUE "6")
    (:TYPE :CONSTANT :SYMBOL (:NAME "+SF1+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION
     "The value of the RCF1952 first extra subfield used by BGZ members."
     :INITIAL-VALUE "(CHAR-CODE #\\B)")
    (:TYPE :CONSTANT :SYMBOL (:NAME "+SF2+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION
     "The value of the RCF1952 first extra subfield used by BGZ members."
     :INITIAL-VALUE "(CHAR-CODE #\\C)")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+SLEN+" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :DOCUMENTATION
     "The value of the RFC1952 subfield length field used by BGZ members."
     :INITIAL-VALUE "2")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+MEMBER-HEADER-LENGTH+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "The total number of bytes in the BGZ header."
     :INITIAL-VALUE "18")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+MEMBER-FOOTER-LENGTH+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "The total number of bytes in the BGZ footer."
     :INITIAL-VALUE "8")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+BGZ-MAX-PAYLOAD-LENGTH+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "The maximium size in bytes of a BGZ member payload. This is
  dictated by the fact that the SAM spec makes 16 bits are avaliable
  for addressing positions with the BGZ member."
     :INITIAL-VALUE "(EXPT 2 16)")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*DEFAULT-COMPRESSION*" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "The default bgz compression level (Zlib level 5)."
     :INITIAL-VALUE "5")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*EMPTY-BGZ-RECORD*" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION
     "SAMtools version >0.1.5 appends an empty BGZF record to allow
  detection of truncated BAM files. These 28 bytes constitute such a
  record."
     :INITIAL-VALUE
     "(MAKE-ARRAY 28 :ELEMENT-TYPE 'UK.CO.DEOXYBYTE-UTILITIES:OCTET :INITIAL-CONTENTS
            '(31 139 8 4 0 0 0 0 0 255 6 0 66 67 2 0 27 0 3 0 0 0 0 0 0 0 0 0))")
    (:TYPE :STRUCT :SYMBOL
     (:NAME "BGZ-MEMBER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :SUPER-CLASS-LIST
     ((:NAME "GZ-MEMBER" :PACKAGE-NAME "UK.CO.DEOXYBYTE-GZIP" :EXTERNALP T))
     :DOCUMENTATION
     "A block-gzip data chunk; a gzip member with extensions, as defined
by RFC1952. The extensions are described in RFC1952 and the SAM format
specification.

- sf1: RCF1952 first extra SubField.
- sf2: RCF1952 second extra SubField.
- slen: RFC1952 Subfield LENgth.
- bsize: SAM spec total Block (member) SIZE. The serialized value is (1- bsize).
- udata: Uncompressed DATA."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "SF1" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "SF2" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "SLEN" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "BSIZE" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "UDATA" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-BGZ-MEMBER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (((:NAME "ID1" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM0" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "+ID1+" :PACKAGE-NAME "UK.CO.DEOXYBYTE-GZIP" :EXTERNALP T))
      (((:NAME "ID2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM1" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "+ID2+" :PACKAGE-NAME "UK.CO.DEOXYBYTE-GZIP" :EXTERNALP T))
      (((:NAME "CM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM2" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "+CM-DEFLATE+" :PACKAGE-NAME "UK.CO.DEOXYBYTE-GZIP" :EXTERNALP
        T))
      (((:NAME "FLG" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM3" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "+FLAG-EXTRA+" :PACKAGE-NAME "UK.CO.DEOXYBYTE-GZIP" :EXTERNALP
        T))
      (((:NAME "MTIME" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM4" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "XFL" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM5" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "OS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM6" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "+OS-UNKNOWN+" :PACKAGE-NAME "UK.CO.DEOXYBYTE-GZIP" :EXTERNALP
        T))
      (((:NAME "XLEN" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM7" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "ISIZE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM8" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "CRC32" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM9" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "CDATA" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM10" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) 0
        (:NAME "ELEMENT-TYPE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
         (:NAME "OCTET" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP
          T))))
      (((:NAME "CEND" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM11" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "SF1" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM12" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "+SF1+" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (((:NAME "SF2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM13" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "+SF2+" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (((:NAME "SLEN" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM14" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "+SLEN+" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (((:NAME "BSIZE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM15" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "UDATA" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM16" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) 0
        (:NAME "ELEMENT-TYPE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
         (:NAME "OCTET" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP
          T)))))
     :DOCUMENTATION NIL)
    (:TYPE :STRUCT :SYMBOL (:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :SUPER-CLASS-LIST
     ((:NAME "STRUCTURE-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "A block gzip file.

- pathname: The file pathname.
- stream: The file stream.
- buffer: A simple-octet-vector used for buffering reads.
- position: The file position component of the BGZF virtual file
  offset (most significant 48 bits). This is the position in the
  stream at which this member starts.
- offset: The within-member offset component of the BGZF virtual file
  offset (least significant 16 bits). This is a position within the
  uncompressed data of the member.
- pointer: The buffer index after the last usable data element. i.e.
  the index at which new data may be written to the buffer prior to
  deflating. Calling (subseq buffer 0 bgzf-pointer) will extract the
  current usable bytes.
- util-buffer: a 4 byte buffer used internally to store an integer.
- loaded-p: T if the bgz data has been loaded into the buffer (used
  internally in decompression and reading).
- load-seek: On loading the bgz data, proceed immediately to this
  offset (used internally in decompression and reading).
- eof: T if the decompression process has reached EOF (used internally
  in decompression and reading)."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "PATHNAME" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) :ACCESSORS
       NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "COMPRESSION" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "BUFFER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "POSITION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) :ACCESSORS
       NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "OFFSET" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "POINTER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "UTIL-BUFFER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "LOADED-P" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "LOAD-SEEK" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "EOF" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-BGZF" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (((:NAME "PATHNAME" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM115" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "STREAM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM116" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "COMPRESSION" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM117" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "*DEFAULT-COMPRESSION*" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (((:NAME "BUFFER" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM118" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "+BGZ-MAX-PAYLOAD-LENGTH+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
        (:NAME "ELEMENT-TYPE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
         (:NAME "OCTET" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP
          T))))
      (((:NAME "POSITION" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM119" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "OFFSET" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM120" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "POINTER" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM121" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "UTIL-BUFFER" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM122" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) 4
        (:NAME "ELEMENT-TYPE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
         (:NAME "OCTET" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP
          T))
        (:NAME "INITIAL-ELEMENT" :PACKAGE-NAME "KEYWORD" :EXTERNALP T) 0))
      (((:NAME "LOADED-P" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM123" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "LOAD-SEEK" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM124" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "EOF" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM125" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL (:NAME "WITH-BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "VAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "ARGS" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Executes BODY with VAR bound to a BGZF handle structure created by
opening the file denoted by FILESPEC.

Arguments:

- var (symbol): The symbol to be bound.
- filespec (pathname designator): The file to open.

Rest:

- args: Arguments applicable to bgzf-open.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BGZF-OPEN" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZFSPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ARGS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "COMPRESSION" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "*DEFAULT-COMPRESSION*" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "&ALLOW-OTHER-KEYS" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Opens a block gzip file for reading or writing.

Arguments:

- bgzfspec (pathname designator, open stream or bgzf object): The file
  to open or an open stream or bgzf object (which is returned unmodified).
  The *standard-input* or *standard-ouput* streams may be used.

Key:

- compression (keyword): The zlib compression level (for writing).

Also accepts the keyword arguments applicable to CL:OPEN. However,
an :element-type argument will be ignored as the type is always octet.

Returns:

- A BGZF structure.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BGZF-CLOSE" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)) :DOCUMENTATION
     "Closes an open block gzip file.

Arguments:

- bgzf (bgzf structure): The file to close.

Returns:

- T on success.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BGZF-OPEN-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)) :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BGZF-COFFSET" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "POSITION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Returns the compressed offset (most significant bits) component of
BGZF virtual offset POSITION.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BGZF-UOFFSET" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "POSITION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Returns the uncompressed (least significant bits) component of BGZF
virtual offset POSITION.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BGZF-SEEK" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "POSITION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Seeks with the file encapsulated by a block gzip file.

Arguments:

- bgzf (bgzf structure): The handle to seek.

- position (integer): The position to seek. Only values previously
  returned by {defun bgzf-tell} may be used. The most significant 48
  bits denote the real file position and the least significant 16 bits
  the offset within the uncompressed gzip member (see the SAM spec).

Returns:

- The new position.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BGZF-TELL" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)) :DOCUMENTATION
     "Returns the current position in the encapsulated file of a block gzip
file.

Arguments:

- bgzf (bgzf structure): The file.

Returns:

- The file position.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BGZF-EMPTY-P" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)) :DOCUMENTATION
     "Returns T if all decompressed bytes have been read from the current
decompressed BGZ block.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BGZF-EOF-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)) :DOCUMENTATION
     "Returns T if the BGZF stream is terminated by an empty record.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "INFLATE-BGZ-MEMBER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "BGZ" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DEFLATE-BGZ-MEMBER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "BGZ" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "COMPRESSION" :PACKAGE-NAME "SAM" :EXTERNALP NIL) -1)
      ((:NAME "MTIME" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0)
      ((:NAME "BACKOFF" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "N" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BUFFER" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-STRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "N" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "NULL-TERMINATED" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Reads N characters from handle BGZF and returns them as a Lisp
string. The NULL-TERMINATED keyword is used to indicate whether the C
string is null-terminated so that the terminator may be consumed.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-BGZ-MEMBER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BUFFER" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Reads one BGZ member from STREAM, using BUFFER to hold integers as
they are read.

Arguments:

- stream (octet input-stream): An open stream.
- buffer (simple-octet-vector): A re-usable read buffer which must be
  able to contain at least 4 bytes.

Returns:

- A BGZ structure, or NIL.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-CHUNKED-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "N" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "COMPRESS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "MTIME" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "N" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "COMPRESS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "MTIME" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0))
     :DOCUMENTATION "Write N elements from vector BYTES to stream BGZF.

Key:

- compress (boolean): If T, compress at current BGZF compression level
  when the current block becomes full. Defaults to T.
- mtime (uint32): The zlib mtime. Defaults to 0.

Returns:

- The number of bytes written.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BGZF-FLUSH" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "COMPRESS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "APPEND-EOF" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "MTIME" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-BGZ-MEMBER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "BGZ" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BUFFER" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Writes one BGZ member to STREAM.

Arguments:

- bgz (bgz member): A bgz member to write.
- stream (octet output-stream): An open stream.
- buffer (simple-octet-vector): A re-usable read buffer which must be
  able to contain at least 4 bytes.

Returns:

- The number of bytes written.")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+BGZIP-BUFFER-SIZE+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION
     "Buffer size for {defclass bgzip-input-stream} internal buffer."
     :INITIAL-VALUE "4096")
    (:TYPE :TYPE :SYMBOL
     (:NAME "BGZIP-BUFFER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) :DOCUMENTATION NIL)
    (:TYPE :TYPE :SYMBOL
     (:NAME "BGZIP-BUFFER-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION NIL)
    (:TYPE :CLASS :SYMBOL
     (:NAME "BGZF-HANDLE-MIXIN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :SUPER-CLASS-LIST NIL :DOCUMENTATION NIL :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T) :ACCESSORS NIL :READERS
       NIL :WRITERS NIL :DOCUMENTATION "The BGZF file handle.")))
    (:TYPE :CLASS :SYMBOL
     (:NAME "BGZIP-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP T) :SUPER-CLASS-LIST
     ((:NAME "FUNDAMENTAL-BINARY-STREAM" :PACKAGE-NAME "SB-GRAY" :EXTERNALP T)
      (:NAME "BGZF-HANDLE-MIXIN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "A BGZF stream capable of reading or writing block
compressed data."
     :SLOT-LIST NIL)
    (:TYPE :CLASS :SYMBOL
     (:NAME "BGZIP-INPUT-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :SUPER-CLASS-LIST
     ((:NAME "BGZIP-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "FUNDAMENTAL-BINARY-INPUT-STREAM" :PACKAGE-NAME "SB-GRAY"
       :EXTERNALP T))
     :DOCUMENTATION "A stream that reads from a BGZF file." :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "BUFFER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION
       "The Lisp buffer from which data are read.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "NUM-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION
       "The number of bytes that were read into
the buffer from the stream.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "OFFSET" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION
       "The offset in the byte buffer from which
the next byte is to be read.")))
    (:TYPE :MACRO :SYMBOL
     (:NAME "WITH-OPEN-BGZIP" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     (((:NAME "VAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "ARGS" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BGZIP-OPEN" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "DIRECTION" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "INPUT" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
     :DOCUMENTATION "Opens a block gzip stream for FILESPEC.

Key:

- direction (symbol): One of :input (the default) or :output

Returns:

- A {defclass bgzip-stream}")
    (:TYPE :METHOD :SYMBOL
     (:NAME "STREAM-ELEMENT-TYPE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "BGZIP-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "STREAM-CLOSE" :PACKAGE-NAME "UK.CO.DEOXYBYTE-IO" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "BGZIP-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP T))
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ABORT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "STREAM-FILE-POSITION" :PACKAGE-NAME "SB-GRAY" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "BGZIP-INPUT-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP T))
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "POSITION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "STREAM-READ-BYTE" :PACKAGE-NAME "SB-GRAY" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "BGZIP-INPUT-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "STREAM-READ-SEQUENCE" :PACKAGE-NAME "SB-GRAY" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "BGZIP-INPUT-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP T))
      (:NAME "SEQUENCE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0)
      (:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BUFFER-EMPTY-P" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)) :DOCUMENTATION
     NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FILL-BUFFER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)) :DOCUMENTATION
     NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "%STREAM-READ-SEQUENCE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "SEQUENCE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0)
      (:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*SAM-VERSION*" :PACKAGE-NAME "SAM" :EXTERNALP T) :DOCUMENTATION
     "The SAM version written by cl-sam." :INITIAL-VALUE "\"1.3\"")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*VALID-HEADER-TYPES*" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "A list of valid SAM header types." :INITIAL-VALUE
     "'(:HD :SQ :RG :PG :CO)")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*MANDATORY-HEADER-TAGS*" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION
     "A mapping that describes the mandatory tags for each SAM header
  record type."
     :INITIAL-VALUE
     "(PAIRLIS SAM::*VALID-HEADER-TYPES* '((:VN) (:SN :LN) (:ID) (:ID) NIL))")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*VALID-HEADER-TAGS*" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION
     "A mapping that describes the valid tags for each SAM header record
  type."
     :INITIAL-VALUE "(PAIRLIS SAM::*VALID-HEADER-TYPES*
         '((:VN :SO :GO) (:SN :LN :AS :M5 :UR :SP)
           (:ID :SM :LB :DS :FO :KS :PU :PI :CN :DT :PL) (:ID :PN :VN :PP :CL)
           NIL))")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*VALID-SORT-ORDERS*" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "Valid values for SAM sort order tags." :INITIAL-VALUE
     "'(:UNKNOWN :UNSORTED :COORDINATE :QUERYNAME)")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*VALID-GROUP-ORDERS*" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION
     "Valid values for SAM group order tags. Group order is no longer a
valid tag in SAM version 1.3."
     :INITIAL-VALUE "'(:NONE :QUERY :REFERENCE)")
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFINE-HEADER-TAG-PARSER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "NAME" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "HEADER-TYPE" :PACKAGE-NAME "SAM" :EXTERNALP T)
       (:NAME "VAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "TAG-SPECS" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Defines a tag parsing function NAME that parses tag values for SAM
header HEADER-TYPE.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-HD-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-SQ-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-RG-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-PG-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-HEADER-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T))
     :DOCUMENTATION
     "Parses a single SAM header record STR and returns a list. May
raise a {define-condition malformed-record-error} or {define-condition
malformed-field-error} . SAM tags are converted to keyword symbols.

Given a header record of

;;; \"@SQ	SN:AL096846	LN:6490	SP:Schizosaccharomyces pombe\"

the returned list will be

;;;  (:SQ (:SN . \"AL096846\") (:LN . 6490)
;;;       (:SP . \"Schizosaccharomyces pombe\"))

thus the list's first element is a keyword describing the record type
and the rest of the list is itself an alist of record keys and values.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "HEADER-RECORDS" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "HEADER-TYPE" :PACKAGE-NAME "SAM" :EXTERNALP T))
     :DOCUMENTATION
     "Returns a list of all records of HEADER-TYPE from HEADER.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "HEADER-TYPE" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns a symbol indicating the header-type of RECORD, being one
of :HD , :SQ , :RG or :PG .")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "HEADER-TAGS" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns an alist of the tag-values of RECORD.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "HEADER-VALUE" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns the value associated with TAG in RECORD.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "USER-HEADER-TAG-P" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns T if TAG is a SAM 1.4 user-defined header tag. User-defined
tags are recognised by containing lower case letters.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MANDATORY-HEADER-TAGS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "HEADER-TYPE" :PACKAGE-NAME "SAM" :EXTERNALP T))
     :DOCUMENTATION "Returns a list of the mandatory tags for SAM header
HEADER-TYPE. Both HEADER-TYPE. and the returned tags are represented
as symbols.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALID-HEADER-TAGS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "HEADER-TYPE" :PACKAGE-NAME "SAM" :EXTERNALP T))
     :DOCUMENTATION
     "Returns a list of the valid tags for SAM header HEADER-TYPE. Both
HEADER-TYPE and the returned tags are represented as symbols.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-MANDATORY-HEADER-TAGS" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns HEADER-RECORD if all mandatory tags are present, or raises
a {define-condition malformed-record-error} .")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-VALID-HEADER-TAGS" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Checks list HEADER-RECORD for tag validity and returns
HEADER-RECORD or raises a {define-condition malformed-record-error} if
invalid tags are present. Ignores any user tags (lower case tags).")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-VALID-PROGRAMS" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns HEADER if its PG records have unique ID tag values and
valid PP tag values. A valid PP tag must point to the ID of one of the
other PG records in the header.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MERGE-HEADER-RECORDS" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "RECORD1" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "RECORD2" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns a new header record created by merging the tags of
header-records RECORD1 and RECORD2. Records may be safely merged if
they have the same header-type and do not contain any conflicting tag
values.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-SAM-HEADER" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T))
     :DOCUMENTATION "Returns a list containing the data in header STR as Lisp
objects. If the header is NIL (there was no header) this function
returns NIL.

Given a header of

;;; \"@HD	VN:1.0
;;; @SQ	SN:AL096846	LN:6490	SP:Schizosaccharomyces pombe
;;; @PG	ID:bwa	VN:0.4.6	CL:aln -n 0.04 -o 1 -e -1 -i 5 -d 10 -k 2 -M 3 -O 11 -E 4\"

the returned list will be

;;; ((:HD (:VN . \"1.0\"))
;;;  (:SQ (:SN . \"AL096846\") (:LN . 6490)
;;;       (:SP . \"Schizosaccharomyces pombe\"))
;;;  (:PG (:ID . \"bwa\") (:VN . \"0.4.6\")
;;;       (:CL . \"aln -n 0.04 -o 1 -e -1 -i 5 -d 10 -k 2 -M 3 -O 11 -E 4\"))))

thus each list element is a list whose first element is a keyword
describing the record type. The rest of each list is itself an alist
of record keys and values.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "NAME-SORTED-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if parsed HEADER indicates that the file is sorted by
name, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "COORDINATE-SORTED-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns T if parsed HEADER indicates that the file is sorted by
coordinate, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALID-SAM-VERSION-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T))
     :DOCUMENTATION
     "Returns T if SAM version string STR matches /^[0-9]+.[0-9]$/, or
NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALID-REFERENCE-NAME-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T))
     :DOCUMENTATION
     "Returns T if STR is a valid reference sequence name matching the
regex [!-)+-<>-~][!-~]* , or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PREVIOUS-PROGRAMS" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "IDENTITY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Returns a list of PG ID values from HEADER that are previous
programs with respect to PG ID IDENTITY. The list is ordered with the
most recently used program first i.e. reverse chronological order.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "LAST-PROGRAMS" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns a list of the PG ID values from HEADER that are the last
programs to act on the data. i.e. these are the leaf programs in the
previous program tree.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "HEADER-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "RECORD-TYPE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ARGS" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a new header record of HEADER-TYPE. ARGS are tag values in
the same order as the tag returned by {defun valid-header-tags} ,
which is the same order as they are presented in the SAM spec.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "HD-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "VERSION" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "*SAM-VERSION*" :PACKAGE-NAME "SAM" :EXTERNALP T))
      ((:NAME "SORT-ORDER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "UNSORTED" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
     :DOCUMENTATION "Returns a new HD record.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SQ-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "SEQ-NAME" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "SEQ-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ASSEMBLY-IDENTITY" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "SEQ-MD5" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "SEQ-URI" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "SEQ-SPECIES" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns a new SQ record.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "RG-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "IDENTITY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "SAMPLE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "LIBRARY" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "DESCRIPTION" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "PLATFORM-UNIT" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "LANE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))
      ((:NAME "INSERT-SIZE" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0)
      (:NAME "SEQUENCING-CENTRE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "SEQUENCING-DATE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "PLATFORM-TECH" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "FLOW-ORDER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "KEY-SEQUENCE" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns a new RG record.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PG-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "IDENTITY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "PROGRAM-NAME" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "PROGRAM-VERSION" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "PREVIOUS-PROGRAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "COMMAND-LINE" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns a new PG record.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MERGE-SAM-HEADERS" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "HEADERS" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns a new SAM header that is the result of merging
HEADERS. Headers may be safely merged if none of their constituent
records contain conflicting tag values once merged.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SUBST-SAM-VERSION" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "VERSION" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "*SAM-VERSION*" :PACKAGE-NAME "SAM" :EXTERNALP T)))
     :DOCUMENTATION
     "Returns a copy of HEADER with any header version tag initially
present substituted by string VERSION, defaulting to *SAM-VERSION* .")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SUBST-SORT-ORDER" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ORDER" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a copy of HEADER with any sort order tag initially present
substituted by symbol ORDER, which must be one of the valid SAM sort
orders. If there is no HD record in HEADER, one is added.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SUBST-GROUP-ORDER" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ORDER" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a copy of HEADER with any group order tag initially present
substituted by symbol ORDER, which must be one of the valid SAM sort
orders. If there is no HD record in HEADER, one is added.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-SAM-VERSION" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "VERSION" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "*SAM-VERSION*" :PACKAGE-NAME "SAM" :EXTERNALP T)))
     :DOCUMENTATION
     "Returns a copy of HEADER that is guaranteed to contain a version
  tag.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-UNIQUE-TAG-VALUES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "RECORD-TYPE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns HEADER if all records of RECORD-TYPE have unique TAG
values, with respect to each other, or raises a {define-condition
malformed-field-error} .")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-ORDER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "DOMAIN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a copy of HEADER that is guaranteed to contain a sort tag
for DOMAIN, which must be one of :sort or :group .")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARTITION-BY-TYPE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "HEADERS" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Collects all the header-records in HEADERS by header-type, sorts
them and returns 4 values that are lists of the collected :hd , :sq
, :rg and :pg header-records, respectively. Does not modify HEADERS.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SIMPLIFY-RECORDS" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "RECORDS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "HEADER-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns a simplified list of header-records copied from
RECORDS. The RECORDS must all be of the same type. The simplifications
are: removal of perfect duplicates, grouping of header-records by
HEADER-TAG value and subsequent merging of header-records that share
that HEADER-TAG value. RECORDS may be an empty list.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "GROUP-BY-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "RECORDS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "HEADER-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a hash-table of header-records taken from list RECORDS. The
hash-table keys are HEADER-TAG values taken from the records and the
hash-table values are lists of header-records that share that
HEADER-TAG value.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FIND-DUPLICATE-HEADER-TAGS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a list of duplicate SAM header tags found in RECORD. Each
list element contains the tag, followed by a list of the conflicting
values.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FIND-DUPLICATE-RECORDS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "HEADER-TYPE" :PACKAGE-NAME "SAM" :EXTERNALP T))
     :DOCUMENTATION
     "Returns a list of any duplicate records of HEADER-TYPE in HEADER.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ADD-PG-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "NEW-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a copy of HEADER with PG record NEW-RECORD added. If the ID
of NEW-RECORD clashes with existing IDs, all IDs are remapped to new,
generated sequential integer IDs, starting at 0. PP links are also
updated. NEW-RECORD must have its PP field set by the caller.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "UPDATE-PG-RECORDS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "CURRENT-RECORDS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "NEW-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns a copy of CURRENT-RECORDS with NEW-RECORD added.")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+TAG-SIZE+" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :DOCUMENTATION
     "The size of a BAM auxilliary tag in bytes." :INITIAL-VALUE "2")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+ALIGNMENT-SIZE-TAG+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "The size of the BAM alignment size indicator."
     :INITIAL-VALUE "4")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+NULL-BYTE+" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :DOCUMENTATION
     "The termination byte for BAM strings." :INITIAL-VALUE "0")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+UNKNOWN-QUALITY+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "The value for unavailable quality scores." :INITIAL-VALUE
     "255")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+UNKNOWN-POSITION+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "The position value for unmapped reads." :INITIAL-VALUE
     "-1")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+UNKNOWN-REFERENCE+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "The reference id for unmapped reads." :INITIAL-VALUE "-1")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*BAM-MAGIC*" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :DOCUMENTATION
     "The BAM file magic header bytes." :INITIAL-VALUE
     "(MAKE-ARRAY 4 :ELEMENT-TYPE 'UK.CO.DEOXYBYTE-UTILITIES:OCTET :INITIAL-CONTENTS
            '(66 65 77 1))")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*INVALID-READ-NAME-CHARS*" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "(MAKE-ARRAY 4 :ELEMENT-TYPE 'BASE-CHAR :INITIAL-CONTENTS
            '(#\\  #\\Tab #\\Newline #\\Return))")
    (:TYPE :MACRO :SYMBOL (:NAME "WITH-BAM" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "VAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
        (:NAME "NUM-REFS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
        (:NAME "REF-META" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
       (:NAME "FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "ARGS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       ((:NAME "COMPRESS-HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
        (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
       ((:NAME "PAD-HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0)
       (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "REGIONS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "&ALLOW-OTHER-KEYS" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Evaluates BODY with VAR bound to a new BAM generator function on
pathname designator FILESPEC. The direction (:input versus :output) is
determined by the stream-opening arguments in ARGS. The standard
generator interface functions NEXT and HAS-MORE-P may be used in
operations on the returned generator.

On reading, HEADER, NUM-REFS and REF-META will be automatically bound
to the BAM file metadata i.e. the metadata are read automatically and
the iterator positioned before the first alignment record.

Optionally, iteration may be restricted to a specific reference,
designated by REF-NUM and to alignments that start between reference
positions START and END. Furthermore, a BAM-INDEX object INDEX may be
provided to allow the stream to seek directly to the desired region of
the file.

On writing, HEADER, NUM-REFS and REF-META should be bound to
appropriate values for the BAM file metadata, which will be
automatically written to the underlying stream.

The COMPRESS-HEADER and PAD-HEADER keyword arguments are only
applicable on writing where they control whether the records and
header block should be compressed and whether the header string should
be padded with nulls to allow space for expansion. Writing an
uncompressed, padded header means that a header that fits in the first
BGZF block may be updated without re-writing the entire BAM file. The
BGZF COMPRESSION keyword is also accepted, permitting the Zlib
compression level to be set for the stream.

A list REGIONS may be supplied to limit the returned alignments to
specific references and reference coordinates. REGIONS may be region
objects or region designators in the form of list tuples

;;; (<reference designator> start end)

where a reference designator is either the reference name string or
its identifier number in the BAM file. REGIONS will be normalised
automatically by sorting according to reference position in the BAM
file (according to the BAM metadata) and then by start and
end. Overlapping regions will be merged.

For example:

To count all records in a BAM file:

;;; (with-bam (in () \"in.bam\")
;;;   (loop
;;;      while (has-more-p in)
;;;      count (next in)))

To copy only records with a mapping quality of >= 30 to another BAM
file:

;;; (with-bam (in (header n ref-meta) \"in.bam\")
;;;   (with-bam (out (header n rer-meta) \"out.bam\" :direction :output)
;;;     (let ((q30 (discarding-if (lambda (x)
;;;                                 (< (mapping-quality x) 30)) in)))
;;;       (loop
;;;          while (has-more-p q30)
;;;          do (consume out (next q30))))))

To count records with mapping quality of >= 30 in a set of genomic
ranges, using an index:

;;; (with-bam-index (index \"index.bai\")
;;;   (with-bam (bam () bam-file :index index
;;;                  :regions '((0 1000000 1100000) (1 1000000 1100000)))
;;;     (loop
;;;        while (has-more-p bam)
;;;        count (>= (mapping-quality (next bam)) 30))))")
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFINE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "VALUE-TYPE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "DOCSTRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Defines a new alignment tag to hold a datum of a particular SAM
type.

Arguments:

- tag (symbol): The tag e.g. :rg
- value-type (symbol): The value type, one of :char , :string , :hex
:int32 or :float .

Optional:

- docstring (string): Documentation for the tag.")
    (:TYPE :STRUCT :SYMBOL
     (:NAME "ALIGNMENT" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :SUPER-CLASS-LIST
     ((:NAME "STRUCTURE-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL (:NAME "BIN" :PACKAGE-NAME "SAM" :EXTERNALP T)
       :ACCESSORS NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "POS" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "MATE-POS" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "REF-ID" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "MATE-REF-ID" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "REF-LEN" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "MAP-QUAL" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "INSERT-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "READ-NAME" :PACKAGE-NAME "SAM" :EXTERNALP T) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "SEQ-STR" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "QUAL-STR" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "CIGAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "READ-NAME" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "SEQ-STR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "QUAL-STR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REF-ID" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "MATE-REF-ID" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "POS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "MATE-POS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "CIGAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REF-LEN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "MAP-QUAL" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INSERT-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "BIN" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "PRINT-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "OBJECT177" :PACKAGE-NAME NIL :EXTERNALP NIL)
       (:NAME "ALIGNMENT" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "STREAM178" :PACKAGE-NAME NIL :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-ALIGNMENT" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns a new ALIGNMENT structure given BAM record ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PRINT-ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FLAG-SYMBOL" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns a 3 character string symbolising the read pairing denoted
by FLAG. The left character indicates the query strand, the middle the
alignment pairing and the right the mate strand.

Query mapped forward  >
Query mapped reverse  <
Query unmapped        .

Not paired             .
Mapped proper pair     =
Mapped pair            -
Singleton              ~

Mate mapped forward     >
Mate mapped reverse     <
Mate unmapped           .")
    (:TYPE :GENERIC :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "VECTOR" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Performs binary encoding of VALUE into VECTOR under
  TAG at INDEX, returning VECTOR.")
    (:TYPE :GENERIC :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns the documentation for TAG or NIL if none is
  available.")
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "VECTOR" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "AM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "AM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "AS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "AS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "BQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "BQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CC" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CC" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CP" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CP" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "CS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "E2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "E2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "FI" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "FI" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "FS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "FS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "FZ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "FZ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "GC" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "GC" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "GS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "GS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "GQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "GQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "LB" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "LB" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "H0" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "H0" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "H1" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "H1" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "H2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "H2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "HI" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "HI" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "IH" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "IH" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "MD" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "MD" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "MF" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "MF" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "MQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "MQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "NH" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "NH" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "NM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "NM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "PG" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "PG" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "PQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "PQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "PU" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "PU" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "Q2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "Q2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "R2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "R2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "RG" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "RG" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "S2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "S2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "SM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "SM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "SQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "SQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "U2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "U2" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "UQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "UQ" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "ZA" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "ZA" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "ZF" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "ZF" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "X0" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "X0" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "X1" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "X1" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XA" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XA" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XF" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XF" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XG" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XG" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XO" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XO" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ENCODE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XT" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)))
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "EQL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "XT" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-REFERENCE-TABLE" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "REF-META-LIST" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a hash-table mapping reference identifiers to reference
names for the reference data in REF-META-LIST.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-ALIGNMENT-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "READ-NAME" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "SEQ-STR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ALIGNMENT-FLAG" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T)
       (:NAME "+UNKNOWN-REFERENCE+" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      ((:NAME "ALIGNMENT-POS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "+UNKNOWN-POSITION+" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      ((:NAME "MATE-REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T)
       (:NAME "+UNKNOWN-REFERENCE+" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      ((:NAME "MATE-ALIGNMENT-POS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "+UNKNOWN-POSITION+" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      ((:NAME "MAPPING-QUALITY" :PACKAGE-NAME "SAM" :EXTERNALP T) 0)
      ((:NAME "ALIGNMENT-BIN" :PACKAGE-NAME "SAM" :EXTERNALP T) 0)
      ((:NAME "INSERT-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T) 0)
      (:NAME "CIGAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "QUALITY-STR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "TAG-VALUES" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns a new alignment record array.

Arguments:

- read-name (string): The read name.
- seq-str (string): The read sequence.
- alignment-flag (integer): The binary alignment flag.

Key:

- reference-id (integer): The reference identifier, defaults to -1
- alignment-pos (integer): The 1-based alignment position, defaults to -1.
- mate-reference-id (integer): The reference identifier of the mate,
  defaults to -1.
- mate-alignment-pos (integer): The 1-based alignment position of the mate.
- mapping-quality (integer): The mapping quality, defaults to 0.
- alignment-bin (integer): The alignment bin, defaults to 0.
- insert-length (integer): The insert size, defaults to 0.
- cigar (alist): The cigar represented as an alist of operations e.g.

;;; '((:M . 9) (:I . 1) (:M . 25))

- quality-str (string): The read quality string.
- tag-values (alist): The alignment tags represented as an alist e.g.

;;; '((:XT . #U) (:NM . 1) (:X0 . 1) (:X1 . 0)
;;;   (:XM . 1) (:XO . 0) (:XG . 0) (:MD . \"3T31\"))

The tags must have been defined with {defmacro define-alignment-tag} .

Returns:

- A vector of '(unsigned-byte 8).")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "COPY-ALIGNMENT-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ALIGNMENT-FLAG" :PACKAGE-NAME "SAM" :EXTERNALP T)
      ((:NAME "REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T)
       ((:NAME "REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T)
        (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)))
      ((:NAME "ALIGNMENT-POS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "ALIGNMENT-POSITION" :PACKAGE-NAME "SAM" :EXTERNALP T)
        (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)))
      ((:NAME "MATE-REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T)
       ((:NAME "MATE-REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T)
        (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)))
      ((:NAME "MATE-ALIGNMENT-POS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "MATE-ALIGNMENT-POSITION" :PACKAGE-NAME "SAM" :EXTERNALP T)
        (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)))
      ((:NAME "MAPPING-QUALITY" :PACKAGE-NAME "SAM" :EXTERNALP T)
       ((:NAME "MAPPING-QUALITY" :PACKAGE-NAME "SAM" :EXTERNALP T)
        (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)))
      ((:NAME "ALIGNMENT-BIN" :PACKAGE-NAME "SAM" :EXTERNALP T)
       ((:NAME "ALIGNMENT-BIN" :PACKAGE-NAME "SAM" :EXTERNALP T)
        (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)))
      ((:NAME "INSERT-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T)
       ((:NAME "INSERT-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T)
        (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)))
      ((:NAME "CIGAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "ALIGNMENT-CIGAR" :PACKAGE-NAME "SAM" :EXTERNALP T)
        (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)))
      ((:NAME "TAG-VALUES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "ALIGNMENT-TAG-VALUES" :PACKAGE-NAME "SAM" :EXTERNALP T)
        (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))))
     :DOCUMENTATION
     "Returns a copy of ALN, optionally setting some fields to new values.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FLAG-BITS" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BIT-NAMES" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns an integer FLAG that had BAM flag bits named by symbols
BIT-NAMES set.

Arguments:

-  flag (unsigned-byte 8): a BAM alignment flag.

Rest:

- bit-names (symbols): Any number of valid bit flag names:

;;; :sequenced-pair
;;; :mapped-proper-pair
;;; :query-mapped , :query-unmapped
;;; :mate-mapped , :mate-unmapped
;;; :query-forward , :query-reverse
;;; :mate-forward , :mate-reverse
;;; :first-in-pair , :second-in-pair
;;; :alignment-primary , :alignment-not-primary
;;; :fails-platform-qc
;;; :pcr/optical-duplicate

Returns:

- An (unsigned-byte 8)")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the reference sequence identifier of ALN. This is an
integer locally assigned to a reference sequence within the context of
a BAM file.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-POSITION" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the 0-based sequence coordinate of ALN in the reference
sequence of the first base of the clipped read.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-READ-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns the length of the alignment on the read.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-REFERENCE-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns the length of the alignment on the reference.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-REFERENCE-END" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns the end position of the alignment on the
reference. Requires decoding the CIGAR string.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-NAME-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the length in ASCII characters of the read name of ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAPPING-QUALITY" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the integer mapping quality of ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-BIN" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns an integer that indicates the alignment bin to which
ALN has been assigned.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CIGAR-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the number of CIGAR operations in ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-FLAG" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "VALIDATE" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns an integer whose bits are flags that describe properties of
the ALN. If the VALIDATE key is T (the default) the flag's bits are
checked for internal consistency.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SEQUENCED-PAIR-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read was sequenced as a member
of a pair, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAPPED-PROPER-PAIR-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns T if FLAG indicates that the read was mapped as a member of
a properly oriented read-pair, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "QUERY-UNMAPPED-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read was not mapped to a
reference, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "QUERY-MAPPED-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read's mate was mapped to a
reference, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MATE-UNMAPPED-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read's mate was not mapped to
a reference, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MATE-MAPPED-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read's mate was mapped to a
reference, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "QUERY-FORWARD-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read was mapped to the forward
strand of a reference, or NIL if it was mapped to the reverse strand.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "QUERY-REVERSE-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read was mapped to the reverse
strand of a reference, or NIL if it was mapped to the forward strand.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MATE-FORWARD-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read's mate was mapped to the
forward, or NIL if it was mapped to the reverse strand.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MATE-REVERSE-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read's mate was mapped to the
reverse, or NIL if it was mapped to the forward strand.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FIRST-IN-PAIR-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read was the first in a pair
of reads from one template, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SECOND-IN-PAIR-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read was the second in a pair
of reads from one template, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-NOT-PRIMARY-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns T if FLAG indicates that the read mapping was not the
primary mapping to a reference, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-PRIMARY-P" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns T if FLAG indicates that the read mapping was the primary
mapping to a reference, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FAILS-PLATFORM-QC-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns T if FLAG indicates that the read failed plaform quality
control, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PCR/OPTICAL-DUPLICATE-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns T if FLAG indicates that the read is a PCR or optical
duplicate, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MEDIAL-FRAG-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read was sequenced as a
non-terminal part of a linear template, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "UNKNOWN-FRAG-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if FLAG indicates that the read was sequenced as part of
a non-linear template or as part of a linear template where the
position has been lost, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALID-MAPPED-PAIR-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns T if FLAG indicates valid mapping states for a pair of
mapped reads, that is both must be mapped, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALID-MAPPED-PROPER-PAIR-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns T if FLAG indicates valid proper mapping states for a pair
of mapped reads, that is both must be mapped and on opposite strands,
or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALID-FLAG-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns T if the paired-read-specific bits of FLAG are internally
consistent.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALID-READ-NAME-P" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T))
     :DOCUMENTATION "Returns T if STR is a valid read name matching the regex
[!-?A-~]1,255 , or NIL otherwise. The length limit is implicit in the
BAM format, there being 8 bits to store the read name length. This
function is not used as it is not clear that this check is accepted by
other implementations.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the length of the read described by ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MATE-REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the integer reference ID of ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MATE-ALIGNMENT-POSITION" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns the 0-based sequence position of the read mate's alignment
described by ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "INSERT-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the insert length described by ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-NAME" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the read name string described by ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-CIGAR" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the CIGAR record list of the alignment described by
ALN. CIGAR operations are given as a list, each member being a list of
a CIGAR operation keyword and an integer operation length.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SEQ-STRING" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the sequence string described by ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "QUALITY-STRING" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the sequence quality string described by ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-TAG-VALUES" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns an alist of tag and values described by ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-CORE" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "VALIDATE" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a list of the core data described by ALN. The list elements
are comprised of reference-id, alignment-position, read-name length,
mapping-quality alignment-bin, cigar length, alignment flag, read
length, mate reference-id, mate alignment-position and insert length.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-CORE-ALIST" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "VALIDATE" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns the same data as {defun alignment-core} in the form of an
alist.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-FLAG-ALIST" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "VALIDATE" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns the bitwise flags of ALN in the form of an alist. The
primary purpose of this function is debugging.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-INDICES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns 7 integer values which are byte-offsets within ALN at which
the various core data lie. See the SAM spec.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DECODE-READ-NAME" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "NUM-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a string containing the template/read name of length
NUM-BYTES, encoded at byte INDEX in ALN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-READ-NAME" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "READ-NAME" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns ALN having encoded READ-NAME into it, starting at INDEX.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DECODE-SEQ-STRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "NUM-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a string containing the alignment query sequence of length
NUM-BYTES. The sequence must be present in ALN at INDEX.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-SEQ-STRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns ALN having encoded STR into it, starting at INDEX.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DECODE-QUALITY-STRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "NUM-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a string containing the alignment query sequence of length
NUM-BYTES. The sequence must be present in ALN at INDEX. The SAM spec
states that quality data are optional, with absence indicated by
0xff. If the first byte of quality data is 0xff, NIL is returned.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-QUALITY-STRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns ALN having encoded quality string STR into it, starting at
INDEX.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-UNKNOWN-QUALITY" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "N" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns ALN having encoded N unknown qualities into it, starting at
INDEX.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DECODE-CIGAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "NUM-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns an alist of CIGAR operations from NUM-BYTES bytes within
ALN, starting at INDEX. The decoding of the = and X operations is not
documented in the spec.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-CIGAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "CIGAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns ALN having encoded alist CIGAR into it, starting at INDEX.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DECODE-TAG-VALUES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a list of auxilliary data from ALN at INDEX. The BAM
two-letter data keys are transformed to Lisp keywords.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-INT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns ALN having encoded integer VALUE into it, starting at
INDEX. BAM format is permitted to use more compact integer storage
where possible.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-FLOAT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns ALN having encoded float VALUE into it,
starting at INDEX.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-CHAR-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns ALN having encoded character VALUE into it,
starting at INDEX.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-HEX-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns ALN having encoded hex string VALUE into it,
starting at INDEX.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-STRING-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns ALN having encoded string VALUE into it,
starting at INDEX.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "%ENCODE-STRING-TAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-TAG-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "VALUE" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns the number of bytes required to encode VALUE.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-VALID-REFERENCE-NAME" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T))
     :DOCUMENTATION
     "Returns STR if it is a valid reference sequence name, or raises a
{define-condition malformed-field-error} if not.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-VALID-READ-NAME" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-VALID-FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FLAG-VALIDATION-ERROR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "FLAG" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Raised a {define-condition malformed-field-error} for alignment
FLAG in ALN, with MESSAGE.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BAM-SORT-ERROR" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "PREVIOUS-REF" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "PREVIOUS-POS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REF" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "POS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "MESSAGE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "MESSAGE-ARGUMENTS" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+MAX-NUM-BINS+" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :DOCUMENTATION
     "The maximum number of bins possible in the BAM indexing scheme."
     :INITIAL-VALUE "(/ (1- (ASH 1 18)) 7)")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+SAMTOOLS-KLUDGE-BIN+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "Extra bin with different semantics added by samtools."
     :INITIAL-VALUE "37450")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+LINEAR-BIN-SIZE+" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "The size in bases of intervals in the linear bin index."
     :INITIAL-VALUE "(EXPT 2 14)")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*BAM-INDEX-MAGIC*" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION "The BAI index file magic header bytes." :INITIAL-VALUE
     "(MAKE-ARRAY 4 :ELEMENT-TYPE 'UK.CO.DEOXYBYTE-UTILITIES:OCTET :INITIAL-CONTENTS
            '(66 65 73 1))")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*BAM-INDEX-FILE-TYPE*" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE "\"bai\"")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*TREE-DEEPENING-BOUNDARIES*" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE "'(4681 585 73 9 1)")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*VOFFSET-MERGE-DISTANCE*" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :DOCUMENTATION
     "If two index chunks are this number of bytes or closer to each
other, they should be merged."
     :INITIAL-VALUE "(EXPT 2 14)")
    (:TYPE :STRUCT :SYMBOL (:NAME "BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :SUPER-CLASS-LIST
     ((:NAME "STRUCTURE-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "A BAM file index covering all the reference sequences in a BAM
file."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "REFS" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (((:NAME "REFS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM0" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) 0)))
     :DOCUMENTATION NIL)
    (:TYPE :STRUCT :SYMBOL
     (:NAME "SAMTOOLS-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :SUPER-CLASS-LIST ((:NAME "BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T))
     :DOCUMENTATION
     "A samtools-specific index containing extra, undocumented data:
 - unassigned: number of unmapped reads not assigned to a reference"
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "UNASSIGNED" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-SAMTOOLS-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (((:NAME "REFS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM38" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) 0))
      (((:NAME "UNASSIGNED" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM39" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0))
     :DOCUMENTATION NIL)
    (:TYPE :STRUCT :SYMBOL (:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :SUPER-CLASS-LIST
     ((:NAME "STRUCTURE-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "An index for a single reference sequence. An index is composed of a
vector of bins (the binning index) and a vector of intervals (the
linear index). The bins are sorted by increasing bin number. The
binning index is hierarchical, while the linear index is flat, being a
projection of reads from all bins onto a single vector."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ID" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "BINS" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "INTERVALS" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (((:NAME "ID" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM81" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "+UNKNOWN-REFERENCE+" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (((:NAME "BINS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM82" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) 0
        (:NAME "INITIAL-ELEMENT" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
      (((:NAME "INTERVALS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM83" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) 0
        (:NAME "ELEMENT-TYPE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
         (:NAME "FIXNUM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "PRINT-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "OBJECT84" :PACKAGE-NAME NIL :EXTERNALP NIL)
       (:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T))
      (:NAME "STREAM85" :PACKAGE-NAME NIL :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :STRUCT :SYMBOL
     (:NAME "SAMTOOLS-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :SUPER-CLASS-LIST ((:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T))
     :DOCUMENTATION "A samtools-specific reference index containing extra,
undocumented data:

 - start: the start offset of the reference
 - end: the end offset of the reference
 - mapped: number of reads mapped to the reference
 - unmapped: number of unmapped reads assigned to the reference by
   magic"
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "MAPPED" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "UNMAPPED" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-SAMTOOLS-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (((:NAME "ID" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM151" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "+UNKNOWN-REFERENCE+" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (((:NAME "BINS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM152" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) 0
        (:NAME "INITIAL-ELEMENT" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
      (((:NAME "INTERVALS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM153" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) 0
        (:NAME "ELEMENT-TYPE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
         (:NAME "FIXNUM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))))
      (((:NAME "START" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM154" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "END" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM155" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "MAPPED" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM156" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "UNMAPPED" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM157" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "PRINT-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "OBJECT158" :PACKAGE-NAME NIL :EXTERNALP NIL)
       (:NAME "SAMTOOLS-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "STREAM159" :PACKAGE-NAME NIL :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :STRUCT :SYMBOL (:NAME "BIN" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :SUPER-CLASS-LIST
     ((:NAME "STRUCTURE-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "A bin within a BAM binning index. A bin is a region on a reference
sequence that is identified by a number. The bin location and
numbering system used is the UCSC binning scheme by Richard Durbin and
Lincoln Stein. A bin contains a vector of chunks."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "NUM" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "CHUNKS" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-BIN" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (((:NAME "NUM" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM241" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "CHUNKS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM242" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) 0)))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "PRINT-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "OBJECT243" :PACKAGE-NAME NIL :EXTERNALP NIL)
       (:NAME "BIN" :PACKAGE-NAME "SAM" :EXTERNALP T))
      (:NAME "STREAM244" :PACKAGE-NAME NIL :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :STRUCT :SYMBOL (:NAME "CHUNK" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :SUPER-CLASS-LIST
     ((:NAME "STRUCTURE-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "A chunk within a BAM index bin. Chunks are groups of records that
lie within a bin and are close together within the BAM file."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-CHUNK" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (((:NAME "START" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM289" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "END" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM290" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "MOST-POSITIVE-FIXNUM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP
        T)))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "PRINT-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "OBJECT291" :PACKAGE-NAME NIL :EXTERNALP NIL)
       (:NAME "CHUNK" :PACKAGE-NAME "SAM" :EXTERNALP T))
      (:NAME "STREAM292" :PACKAGE-NAME NIL :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :STRUCT :SYMBOL (:NAME "REGION" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :SUPER-CLASS-LIST
     ((:NAME "STRUCTURE-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "A range of bases over a reference sequence. A region is expressed
in zero-based, half-open, interbase coordinates."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "REF" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-REGION" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "REF" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0)
      ((:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REGION" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "REF" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "PRINT-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "OBJECT341" :PACKAGE-NAME NIL :EXTERNALP NIL)
       (:NAME "REGION" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "STREAM342" :PACKAGE-NAME NIL :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FIND-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BAM-FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the pathname of an index file for BAM-FILESPEC, if the file
is present and conforms to the naming convention of either Picard or
Samtools. If both are present, the Picard convention is favoured.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PRINT-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Prints a string representation of REF-INDEX to STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PRINT-SAMTOOLS-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Prints a string representation of REF-INDEX to STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PRINT-BIN" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "BIN" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Prints a string representation of BIN to STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PRINT-CHUNK" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "CHUNK" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Prints a string representation of CHUNK to STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PRINT-REGION" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "REGION" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Prints a string representation of RANGE to STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T))
     :DOCUMENTATION
     "Returns the reference index for reference number REFERENCE-ID in
BAM-INDEX.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REF-INDEX-BIN" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "BIN-NUM" :PACKAGE-NAME "SAM" :EXTERNALP T))
     :DOCUMENTATION "Returns the BIN number BIN-NUM in REF-INDEX.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "EMPTY-BIN-P" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BIN" :PACKAGE-NAME "SAM" :EXTERNALP T)) :DOCUMENTATION
     "Returns T if BIN contains no chunks, or NIL otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BIN-CHUNK" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BIN" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "CHUNK-NUM" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns the chunk number CHUNK-NUM in BIN.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FIND-INTERVAL" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAX-BIN-NUM" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "REF-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REGION-TO-BINS" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a bit vector with the bits for relevant bins set, given a
0-based range. Each bin may span 2^29, 2^26, 2^23, 2^20, 2^17 or 2^14
bp. Bin 0 spans a 512 Mbp region, bins 1-8 span 64 Mbp, 9-72 8 Mbp,
73-584 1 Mbp, 585-4680 128 Kbp and bins 4681-37449 span 16 Kbp
regions.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REGION-TO-BIN" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns a bin number given a 0-based range.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REGION-TO-INTERVAL" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "COORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Given a coordinate COORD, returns the array index of its interval
in the BAM linear index.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FIND-BINS" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a list of all the bins for reference REFERENCE-ID in INDEX,
between reference positions START and END.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ADJACENTP" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "CHUNK1" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "CHUNK2" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns T if BAM index CHUNK1 and CHUNK2 are adjacent. In this
context this means that they are sequential in a file stream and close
enough together for it to be more efficient to continue reading across
the intervening bytes, rather than seeking.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MERGE-CHUNKS" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "CHUNKS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns a new list of BAM index chunks created by merging members
of list CHUNKS that are {defun adjacentp} .")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VOFFSET-MERGE-P" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "VOFFSET1" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "VOFFSET2" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns T if BGZF virtual offsets are close enough to save disk
seeks. Continuing to read from the current position may be faster than
seeking forward a short distance.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-BAM-CHUNKS" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REGION" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a list of read chunks from INDEX covering REGION, sorted by
increasing chunk start.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "RUN-LENGTH-ENCODE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "INTERVALS" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a run-length encoded list representing INTERVALS, a BGZF
linear index. Each element of the list has a car of the run-length and
a cdr of the BGZF file position. Used in printing text representations
of the index.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "WITH-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     (((:NAME "VAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Evaluates BODY with VAR bound to a BAM-INDEX read from file denoted
by pathname designator FILESPEC.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-INDEX-MAGIC" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)) :DOCUMENTATION
     "Reads the BAI magic number from STREAM and returns T if it is valid
or raises a {define-condition malformed-file-error} if not.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)) :DOCUMENTATION
     "Reads a BAM (.bai) index from STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Reads an index for a single reference sequence from STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-BINNING-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "NUM-BINS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Reads NUM-BINS bins from STREAM, returning a vector of bins, sorted
by increasing bin number.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-BIN" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)) :DOCUMENTATION
     "Reads an index bin from STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-LINEAR-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "NUM-INTERVALS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Reads NUM-INTERVALS linear bin intervals from STREAM, returning
them in a vector. Identical intervals are run-length compressed.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-INDEX-MAGIC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :GENERIC :SYMBOL
     (:NAME "WRITE-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "WRITE-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     (((:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "SAMTOOLS-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "WRITE-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     (((:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "SAMTOOLS-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "WRITE-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     (((:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T))
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "WRITE-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     (((:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T))
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :GENERIC :SYMBOL
     (:NAME "WRITE-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "WRITE-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     (((:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
       (:NAME "SAMTOOLS-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "WRITE-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     (((:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
       (:NAME "SAMTOOLS-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "WRITE-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     (((:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
       (:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T))
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "WRITE-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     (((:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
       (:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T))
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-BINNING-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "BINS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-BIN" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "BIN" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-LINEAR-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "INTERVALS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "%WRITE-INT32" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "N" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "BUFFER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "%WRITE-INT64" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "N" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "BUFFER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "INDEX-BAM-FILE" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns a new BAM-INDEX object, given pathname designator FILESPEC.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "%MAKE-REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "REF-START" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REF-END" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "CHUNKS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INTERVALS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "MAPPED" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0)
      ((:NAME "UNMAPPED" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "%MAKE-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "NUM-REFS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REF-INDICES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "UNASSIGNED" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-BAM-FULL-SCAN-INPUT" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "BAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a generator function that returns BAM alignment records for
BAM stream BAM by scanning the entire stream. This to be used in cases
where a full scan is necessary, or as a fallback when neither index,
nor regions are available. The standard generator interface functions
NEXT and HAS-MORE-P may be used in operations on the returned
generator.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-BAM-SCAN-INPUT" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "BAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REGIONS" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a generator function that returns BAM alignment records for
BAM stream BAM by scanning for alignments in the list of REGIONS. Note
that REGIONS use zero-based, closed base coordinates. This to be used
in cases where a full scan is necessary, or as a fallback when an
index is not available. The standard generator interface functions
NEXT and HAS-MORE-P may be used in operations on the returned
generator.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-BAM-INDEX-INPUT" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "BAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REGIONS" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a generator function that returns BAM alignment records for
BAM stream BAM by scanning for alignments in the list of REGIONS.
Note that REGIONS are zero-based, closed base coordinates. The
standard generator interface functions NEXT and HAS-MORE-P may be used
in operations on the returned generator.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-REGION<" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "REF-META" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns a new comparator function which sorts regions according to
the BAM reference metadata REF-META. Ranges are sorted first by the
reference order in the BAM file, then by region start and finally by
region end. Regions are sorted before they are normalised.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-REGION-STRING" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "UK.CO.DEOXYBYTE-UTILITIES" :EXTERNALP T))
     :DOCUMENTATION "Returns a new region from a string region designator in
samtools-style format:

  <reference name>:<start coordinate>-<end coordinate>

The reference name must be one of those described in the BAM header
metadata. The reference sequence coordinates are zero-based, half
open with start < end.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "NORMALISE-REGIONS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "REGIONS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REF-META" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns a list of REGIONS, normalised according to the BAM
reference metadata REF-META. Reference names in REGIONS are converted
to their corresponding reference ID and REGIONS are sorted first by
the reference order in the BAM file, then by region start and finally
by region end. Overlapping REGIONS are merged.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARTITION-REGIONS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "REGIONS" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Partitions a list of normalised REGIONS into lists, each pertaining
to a specific reference sequence. The overall order of the REGIONS is
maintained.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-VALID-REGION" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "REGION" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns REGION if it is a valid region designator, or raises an
{define-condition invalid-argument-error} .

A region designator may be any of the following:

 - A list of a string and two integers, being a reference name,
   start position and end position, respectively.

 - A list of three integers, being a reference identifier, start
   position and end position, respectively.

 - A region struct.

The start position must be less than, or equal to the end position.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-BAM-MAGIC" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)) :DOCUMENTATION
     "Reads the BAM magic number from the handle BGZF and returns T if it
is valid or raises a {define-condition malformed-file-error} if not.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-BAM-HEADER" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)) :DOCUMENTATION
     "Returns the unparsed BAM header from the handle BGZF as a Lisp
string.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-NUM-REFERENCES" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T))
     :DOCUMENTATION
     "Returns the number of reference sequences described in the BAM
header of handle BGZF.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-REFERENCE-META" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T))
     :DOCUMENTATION
     "Returns the reference sequence metadata for a single reference
sequence described in the BAM header of handle BGZF. Two values are
returned, the reference name as a string and the reference length as
an integer,")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-ALIGNMENT" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "VALIDATE" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Reads one alignment block from handle BGZF, returns it as a Lisp
array of unsigned-byte 8. The handle is advanced to the next
alignment. If no more alignments are available, returns NIL.

This is the preferred function to use for validation. i.e. validate
early. A USE-VALUE restart is provided so that an invalid alignment
may be modified and re-read without unwinding the stack.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-BAM-META" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)) :DOCUMENTATION
     "Reads all BAM metadata from handle BGZF, leaving the handle
pointing at the first alignment record. Returns the header string, the
number of references and a list of reference sequence metadata. The
list contains one element per reference sequence, each element being a
list of reference identifier, reference name and reference length.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-BAM-TERMINATOR" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T))
     :DOCUMENTATION
     "Reads the EOF from handle BGZF, returning T if it is present, or
raising a {define-condition malformed-file-error} otherwise.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BAM-META-SIZE" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns the number of bytes occupied by the metadata in the BAM
file FILESPEC. Metadata is defined here as the magic number, header
and header padding, reference sequence count and reference sequence
names and lengths.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BAM-META-SIZE2" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "REF-META" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BLOCK-SIZES" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "N" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-BAM-OUTPUT" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL)) :DOCUMENTATION
     "Returns a consumer function that accepts an argument of a BAM
record and writes it to BAM output stream BAM. The standard consumer
interface function CONSUME may be used in operations on the returned
consumer.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-BAM-MAGIC" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "COMPRESS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION "Writes the BAM magic number to the handle BGZF.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-BAM-HEADER" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "COMPRESS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "NULL-PADDING" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0)
      ((:NAME "MTIME" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0))
     :DOCUMENTATION
     "Writes the BAM header string HEADER to handle BGZF, followed by
padding of NULL-PADDING null bytes. This function also writes the
header length, including padding, in the 4 bytes preceding the
header.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-NUM-REFERENCES" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "N" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Writes the number of reference sequences N to handle BGZF.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-REFERENCE-META" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "REF-NAME" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REF-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Writes the metadata for a single reference sequence named REF-NAME,
of length REF-LENGTH bases, to handle BGZF.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-ALIGNMENT" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "ALIGNMENT-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Writes one ALIGNMENT-RECORD to handle BGZF and returns the number
of bytes written.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-BAM-META" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "HEADER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "NUM-REFS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REF-META" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "COMPRESS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "NULL-PADDING" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0))
     :DOCUMENTATION
     "Writes BAM magic number and then all metadata to handle BGZF. The
metadata consist of the HEADER string, number of reference sequences
NUM-REFS and a list reference sequence metadata REF-META. The list
contains one element per reference sequence, each element being a list
of reference identifier, reference name and reference length. Returns
the number of bytes written.

Key:

- compress-header (boolean): Compress the header block if T.
- null-padding (fixnum): A number of null bytes to be appended to the
end of the header string, as allowed by the SAM spec. This is useful
for creating slack space so that BAM headers may be edited in place.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-HEADER-STRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "ALIST" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns a new SAM header string representing the header data in
ALIST.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-SAM-HEADER" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALIST" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION "Writes SAM header ALIST as a string to STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-HEADER-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "HEADER-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION "Writes alist HEADER-RECORD to STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-SAM-ALIGNMENT" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "ALIGNMENT-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REF-TABLE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION "Writes ALIGNMENT-RECORD to STREAM as SAM. REF-TABLE is a
hash-table created by {defun make-reference-table} .")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-CIGAR" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "ALIGNMENT-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "NUM-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION
     "Writes the CIGAR string of ALIGNMENT-RECORD at INDEX as NUM-BYTES
bytes, to STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-SEQ-STRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "ALIGNMENT-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "NUM-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION "Writes the sequence string of ALIGNMENT-RECORD at INDEX as
NUM-BYTES bytes, to STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-QUALITY-STRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "ALIGNMENT-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "NUM-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION "Writes the quality string of ALIGNMENT-RECORD at INDEX as
NUM-BYTES, to STREAM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-TAG-VALUES" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "ALIGNMENT-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "INDEX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION
     "Writes the auxilliary data of ALIGNMENT-RECORD at INDEX to STREAM.")
    (:TYPE :CLASS :SYMBOL
     (:NAME "BAM-SORT-INPUT-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :SUPER-CLASS-LIST
     ((:NAME "SORT-INPUT-STREAM" :PACKAGE-NAME "UK.CO.DEOXYBYTE-IO" :EXTERNALP
       T)
      (:NAME "BGZF-HANDLE-MIXIN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL :SLOT-LIST NIL)
    (:TYPE :CLASS :SYMBOL
     (:NAME "BAM-SORT-OUTPUT-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :SUPER-CLASS-LIST
     ((:NAME "SORT-OUTPUT-STREAM" :PACKAGE-NAME "UK.CO.DEOXYBYTE-IO" :EXTERNALP
       T)
      (:NAME "BGZF-HANDLE-MIXIN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL :SLOT-LIST NIL)
    (:TYPE :CLASS :SYMBOL
     (:NAME "BAM-MERGE-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :SUPER-CLASS-LIST
     ((:NAME "MERGE-STREAM" :PACKAGE-NAME "UK.CO.DEOXYBYTE-IO" :EXTERNALP T)
      (:NAME "WRAPPED-STREAM-MIXIN" :PACKAGE-NAME "UK.CO.DEOXYBYTE-IO"
       :EXTERNALP T))
     :DOCUMENTATION NIL :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "BUFFER" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS ((:NAME "BUFFER-OF" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
       :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :METHOD :SYMBOL
     (:NAME "STREAM-READ-ELEMENT" :PACKAGE-NAME "UK.CO.DEOXYBYTE-IO" :EXTERNALP
      T)
     :LAMBDA-LIST
     (((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "BAM-SORT-INPUT-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL)))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "STREAM-WRITE-ELEMENT" :PACKAGE-NAME "UK.CO.DEOXYBYTE-IO"
      :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "ALIGNMENT-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "VECTOR" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "BAM-SORT-OUTPUT-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL)))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "MAKE-MERGE-STREAM" :PACKAGE-NAME "UK.CO.DEOXYBYTE-IO" :EXTERNALP
      T)
     :LAMBDA-LIST
     (((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "BAM-SORT-INPUT-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "PREDICATE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "KEY" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "BUFFER-SIZE" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 100000))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "INITIALIZE-INSTANCE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "BAM-MERGE-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "STREAM-MERGE" :PACKAGE-NAME "UK.CO.DEOXYBYTE-IO" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "BAM-MERGE-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL)))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-RECORD<" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALIGNMENT-RECORD1" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ALIGNMENT-RECORD2" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns T if ALIGNMENT-RECORD1 sorts before
ALIGNMENT-RECORD2. Sorting semantics are not fully defined in the SAM
spec, however, an informal consensus on sequence order sorting seems
to be:

- mapped reads should first be sorted by their reference in the order
  in which reference sequences appear in the header
- unmapped reads should sort after mapped reads
- reads mapped to the same reference must appear in ascending order of
  their alignment position

This function compares first by reference sequence, then alignment
position, by alignment strand and finally by read name. The output is
identical to a coordinate sort performed by Picard 1.07.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-NAME<" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "ALIGNMENT-RECORD1" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ALIGNMENT-RECORD2" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns T if ALIGNMENT-RECORD1 sorts before ALIGNMENT-RECORD2 by
read name. Sorting semantics of read names are not fully defined in
the SAM spec; whether you should expect natural order or numeric order
of read name strings is not defined.

This function compares numerically by read name, then by alignment
template region for reads paired in sequencing and finally by
alignment strand.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-NAME-NATURAL<" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "ALIGNMENT-RECORD1" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "ALIGNMENT-RECORD2" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SORT-BAM-FILE" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "IN-FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "OUT-FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "SORT-ORDER" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       (:NAME "COORDINATE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))
      ((:NAME "BUFFER-SIZE" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 1000000))
     :DOCUMENTATION "Sorts a BAM file by coordinate or by read name.

Arguments:

- in-filespec (pathname designator): The input BAM file.
- out-filespec (pathname designator): The output BAM file.

Key:

- sort-order (symbol): The sort order, either :coordinate
  or :queryname .

- buffer-size (fixnum): The maximum number of reads to sort in memory
  at any one time, defaulting to 1000000.

Returns:

- The number of alignments sorted.
- The number of files used in the external merge sort.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SORT-BAM-ALIGNMENTS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "BGZF-IN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "BGZF-OUT" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "PREDICATE" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "KEY" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "BUFFER-SIZE" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 1000000))
     :DOCUMENTATION
     "Sorts alignments from block gzip input stream BGZF-IN and writes
them to block gzip output stream BGZF-OUT, sorted by PREDICATE. A
function KEY may be supplied to transform alignments into arguments
for PREDICATE. The BUFFER-SIZE argument declares the maximum number of
alignments that will be sorted in memory at any time, defaulting to
1000000.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "%READ-BAM-ALIGNMENT" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "NUM-BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-DIGITS" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-DIGITS" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "BYTES" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REPAIR-MAPPING-FLAGS" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "ALN" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns alignment ALN if it has correct mapped-proper-pair,
query-mapped and mate-mapped flags, or a modified copy with fixed
flags. Also sets the user tag ZF:I:<original flag> if the flags are
changed.

Alignments produced by the BWA aligner have been observed to contain
invalid flags. This is caused by BWA creating mappings that overhang
the end of the reference. The underlying cause is reference
concatenation in the Burrows-Wheeler index.

This function attempts to fix invalid mapped-proper-pair flags in
cases where query-unmapped and/or mate-unmapped flags are set. Such
unmapped reads may also have reference-ids set and good mapping
scores. This function does not correct these other fields.

It is necessary to use this function in order to obtain correct flag
counts when using samtools flagstat or {defun flagstat} .")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "GENERATE-REFERENCE-FILE" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "NAME" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "LENGTH" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "FN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "LAMBDA" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        ((:NAME "CHAR" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) "acgt"
         ((:NAME "RANDOM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) 4)))))
     :DOCUMENTATION
     "Creates an artificial reference genome Fasta file to accompany a
generated BAM file.

Arguments:

- filespec (pathname designator): The file to create.
- name (string): The name of the reference sequence.
- length (integer): The length of the reference sequence.

Optional:

- fn (function): A function that returns a single base character. The
  default randomly returns a, c, g or t in equal proportions.

Returns:

- The filespec.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-PHRED-QUALITY" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "Q" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION "Returns the character encoding Phred quality Q.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DEFAULT-SEQ-STRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "LENGTH" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DEFAULT-QUAL-STRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "LENGTH" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-GENERATOR" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T)
      (:NAME "READ-GROUP" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "READ-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T) 50)
      (:NAME "NAME-SUFFIX" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      ((:NAME "INSERT-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T) 250)
      ((:NAME "START" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 0)
      ((:NAME "END" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "+" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "INSERT-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T)
        ((:NAME "*" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) 2
         (:NAME "READ-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T))
        1))
      ((:NAME "STEP-SIZE" :PACKAGE-NAME "SAM" :EXTERNALP NIL) 10)
      ((:NAME "MAPPING-QUALITY" :PACKAGE-NAME "SAM" :EXTERNALP T) 50)
      ((:NAME "SEQ-FN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "FUNCTION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "DEFAULT-SEQ-STRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL)))
      ((:NAME "QUALITY-FN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "FUNCTION" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "DEFAULT-QUAL-STRING" :PACKAGE-NAME "SAM" :EXTERNALP NIL))))
     :DOCUMENTATION
     "Returns a new standard generator function which returns pairs of
BAM alignment records.

Arguments:

- reference-id (integer): The BAM reference identifier.
- read-group (string): The read group name.

Key:

- read-length (integer): The read length.
- insert-length (integer): The insert length, defined as the distance
  between the inner boundaries of the paired alignments.
- start (integer): The position at which to start generating alignments.
- end (integer): The position at which to stop generating alignments,
  expressed in Lisp vector indices (zero-based, half-open), rather
  than BAM's (zero-based, closed).
- step-size (integer): The distance between each successive pair of
  alignments.
- mapping-quality (integer): The mapping quality of the alignments.

Returns

- A function.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DEFAULT-ORPHANIZER-TEST" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION
     "Returns a new orphanizer test that causes alternate last fragments
to be omitted.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIGNMENT-ORPHANIZER" :PACKAGE-NAME "SAM" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "GEN" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "TEST" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
       ((:NAME "DEFAULT-ORPHANIZER-TEST" :PACKAGE-NAME "SAM" :EXTERNALP NIL))))
     :DOCUMENTATION
     "Given an alignment generator function GEN, returns a new function
that omits some alignments, yielding orphans. Any alignments for which
TEST returns T will be omitted. The default is to omit alternate last
fragment alignments.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "GENERATE-BAM-FILE" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "NUM-REFS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "REF-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "READ-GROUPS" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ALN-GENERATORS" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Writes a very uniform BAM file to the file denoted by pathname
designator FILESPEC, for testing purposes.

Arguments:

- filespec (pathname designator): The BAM file to be written.
- num-refs (integer): The number of reference sequences in the BAM header.
- read-groups (list of string): The read group names in the BAM header. Each
  reference will have a set of reads generated in each read group.

Rest:

- aln-generators (list of function): A list of alignment generator functions
  created with {defun alignment-generator} function. All of these functions
  will be called until exhausted, so they should represent finite sequences.

Returns

- filespec.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VIEW-SAM" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BAM-FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "SAM-FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL))
     :DOCUMENTATION
     "Writes the contents of binary BAM file BAM-FILESPEC to SAM text
file SAM-FILESPEC.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "STREAM-VIEW-SAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "BAM" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION
     "Writes the binary BAM records from BGZF stream BAM to STREAM, in
SAM text format.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FLAGSTAT" :PACKAGE-NAME "SAM" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "BAM-FILESPEC" :PACKAGE-NAME "SAM" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION "Writes SAM flag counts from BAM-FILESPEC to STREAM."))
   :EXTERNAL-SYMBOLS
   ((:NAME "BGZF-TELL" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "READ-REFERENCE-META" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "READ-NUM-REFERENCES" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WRITE-REFERENCE-META" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "READ-ALIGNMENT" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BAM-ERROR" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-STRAND<" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WRITE-ALIGNMENT" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "VALID-SAM-VERSION-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WRITE-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-FLAG-ALIST" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "SORT-BAM-FILE" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "REF-INDEX-BIN" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "SEQ-STRING" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "SUBST-SORT-ORDER" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "QUERY-MAPPED-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "READ-NAME-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BGZF-EOF-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "VALID-FLAG-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "QUERY-REVERSE-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "PARSE-REGION-STRING" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WRITE-BAM-HEADER" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BIN-NUM" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MATE-UNMAPPED-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BGZF-OPEN-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "HEADER-VALUE" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "CIGAR-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "REF-INDEX-NUM" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WRITE-BAM-MAGIC" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "NEXT-UNMAPPED-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "CHUNK" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "READ-BAM-META" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-CIGAR" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BAM-SORT-ERROR" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "PG-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BAM-INDEX-REFS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "INDEX-BAM-FILE" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "VALID-MAPPED-PAIR-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "VALID-REFERENCE-NAME-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "*SAM-VERSION*" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BGZF-CLOSE" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WRITE-BAM-META" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "FIND-BINS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "GENERATE-BAM-FILE" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "LAST-PROGRAMS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "READ-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BGZF-FILE" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "REF-INDEX-BINS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "HEADER-TYPE" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "READ-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MATE-FORWARD-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-NAME<" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "VALID-MAPPED-PROPER-PAIR-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MERGE-SAM-HEADERS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "HEADER-TAGS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WRITE-SAM-HEADER" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "RG-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BIN-CHUNKS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "FRAG-MAPPED-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-BIN" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "DEFINE-ALIGNMENT-TAG" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BGZF-OPEN" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "NEXT-FORWARD" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "QUALITY-STRING" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "READ-NAME" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "SUBST-GROUP-ORDER" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "SUBST-SAM-VERSION" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MATE-ALIGNMENT-POSITION" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WRITE-SAM-ALIGNMENT" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MAKE-HEADER-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "HEADER-RECORDS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BGZIP-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-NOT-PRIMARY-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "READ-BAM-HEADER" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "COPY-ALIGNMENT-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "SECOND-IN-PAIR-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "HD-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-POSITION" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "SQ-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-ORPHANIZER" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "NEXT-REVERSE-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BGZIP-OPEN" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BGZIP-OUTPUT-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "EMPTY-BIN-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "READ-BAM-TERMINATOR" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "READ-BAM-MAGIC" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MATE-MAPPED-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "CHUNK-END" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "QUERY-UNMAPPED-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-GENERATOR" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "FAILS-PLATFORM-QC-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ADD-PG-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-RECORD<" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ENSURE-VALID-PROGRAMS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "CHUNK-START" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "UNKNOWN-FRAG-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ENSURE-MANDATORY-HEADER-TAGS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MAKE-BAM-INPUT" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WRITE-NUM-REFERENCES" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ENSURE-VALID-HEADER-TAGS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BIN" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MAKE-REFERENCE-TABLE" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-TAG-VALUES" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WITH-BAM" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "REF-INDEX-INTERVALS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BGZF-SEEK" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "FIND-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MAKE-BAM-OUTPUT" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MAKE-ALIGNMENT-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "QUERY-FORWARD-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MATE-REFERENCE-ID" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BZGF-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BIN-CHUNK" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MAPPING-QUALITY" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "SEQUENCED-PAIR-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "PCR/OPTICAL-DUPLICATE-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "FLAGSTAT" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MATE-REVERSE-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-TAG-DOCUMENTATION" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BGZIP-INPUT-STREAM" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WITH-OPEN-BGZIP" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "FRAG-FORWARD-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "FRAG-UNMAPPED-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WRITE-HEADER-RECORD" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-CORE" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "REPAIR-MAPPING-FLAGS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "NAME-SORTED-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MAPPED-PROPER-PAIR-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "REF-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WITH-BGZF" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "VIEW-SAM" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MAKE-SAM-HEADER" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "FIRST-IN-PAIR-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "PREVIOUS-PROGRAMS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-FLAG" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MERGE-HEADER-RECORDS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "LAST-FRAG-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "FLAG-BITS" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "PROPER-ALIGNED-FRAGS-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MULTIPLE-FRAGS-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "INSERT-LENGTH" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "BGZF-IO-ERROR" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-REFERENCE-END" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "ALIGNMENT-CORE-ALIST" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "COORDINATE-SORTED-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "MEDIAL-FRAG-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "FIRST-FRAG-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "FRAG-REVERSE-P" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "WITH-BAM-INDEX" :PACKAGE-NAME "SAM" :EXTERNALP T)
    (:NAME "GENERATE-REFERENCE-FILE" :PACKAGE-NAME "SAM" :EXTERNALP T)))))
