
(:TYPE :SYSTEM :NAME "logv" :AUTHOR NIL :MAINTAINER NIL :VERSION NIL :LICENCE
 NIL :DESCRIPTION "simple logging for cl-terrace" :LONG-DESCRIPTION NIL
 :DEPENDS-ON ("TRIVIAL-UTF-8" "BORDEAUX-THREADS") :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "LOGV" :FULL-NAME "LOGV" :DOCUMENTATION NIL
   :SYMBOL-LIST
   ((:TYPE :VARIABLE :SYMBOL
     (:NAME "*LOG-OUTPUT*" :PACKAGE-NAME "LOGV" :EXTERNALP T) :DOCUMENTATION
     "see WRITE-STRING-TO-LOG" :INITIAL-VALUE "T")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*LOG-PREFIX-STRING*" :PACKAGE-NAME "LOGV" :EXTERNALP T)
     :DOCUMENTATION
     "the leftmost string prepended to the string sent to WRITE-STRING-TO-LOG-FILE by
FORMAT-LOG"
     :INITIAL-VALUE "\"
;\"")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*LOG-THREAD-NAME-P*" :PACKAGE-NAME "LOGV" :EXTERNALP T)
     :DOCUMENTATION
     "set to NIL if you don't want FORMAT-LOG to log the name of the current"
     :INITIAL-VALUE "T")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*LOG-DATE-P*" :PACKAGE-NAME "LOGV" :EXTERNALP T) :DOCUMENTATION
     "set to NIL if you don't want FORMAT-LOG to log the current date"
     :INITIAL-VALUE "T")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*LOG-TIME-P*" :PACKAGE-NAME "LOGV" :EXTERNALP T) :DOCUMENTATION
     "set to NIL if you don't want FORMAT-LOG to log the current time"
     :INITIAL-VALUE "T")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*LOG-MUTEX%*" :PACKAGE-NAME "LOGV" :EXTERNALP NIL) :DOCUMENTATION
     "prevents multiple threads from writing to *LOG-OUTPUT* at the same time"
     :INITIAL-VALUE "(BORDEAUX-THREADS:MAKE-LOCK \"log stream\")")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-STRING-TO-LOG" :PACKAGE-NAME "LOGV" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "if *LOG-OUTPUT* is

   -a stream: writes `STRING' to *LOG-OUTPUT*
   -T: writes `STRING' to *STANDARD-OUTPUT*
   -NIL: doesn't do anything
   -a pathname designator: writes `STRING' to the file designated by *LOG-OUTPUT*")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME ".FORMAT-THREAD-NAME" :PACKAGE-NAME "LOGV" :EXTERNALP NIL)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION
     "writes the name of the thread like \"[thread-name] \" for FORMAT-LOG")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME ".FORMAT-LOG-DATE" :PACKAGE-NAME "LOGV" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "UT" :PACKAGE-NAME "LOGV" :EXTERNALP NIL))
     :DOCUMENTATION "writes the date like \"[DD:MM:YYY] \" for FORMAT-LOG")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME ".FORMAT-LOG-TIME" :PACKAGE-NAME "LOGV" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "TIME" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "writes the time like \"[HH:MM:SS] \" for FORMAT-LOG")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FORMAT-LOG" :PACKAGE-NAME "LOGV" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "FMT-STRING" :PACKAGE-NAME "LOGV" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FMT-ARGS" :PACKAGE-NAME "LOGV" :EXTERNALP NIL))
     :DOCUMENTATION
     "calls WRITE-STRING-TO-LOG with the string created by combining `FMT-STRING' with
`FMT-ARGS' like FORMAT and prepending the result with all the necessary informative
garbage

the following code:

    (format-log \"foo bar ~A\" 'baz)

might result in the following line being sent to WRITE-STRING-TO-LOG:

   ;[repl-thread] [01:06:2008] [13:53:27] foo bar BAZ

see also: *LOG-PREFIX-STRING*, *LOG-THREAD-NAME-P*, *LOG-DATE-P*, and *LOG-TIME-P*")
    (:TYPE :MACRO :SYMBOL (:NAME "LOGV" :PACKAGE-NAME "LOGV" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "FORM" :PACKAGE-NAME "LOGV" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "MORE-FORMS" :PACKAGE-NAME "LOGV" :EXTERNALP NIL))
     :DOCUMENTATION
     "behaves like PROGN except it logs its forms and their return values using
FORMAT-LOG. [and of course its forms are not reckognized by the compiler as being
top-level forms because it's not a special operator like PROGN]

the following code:

   (logv (+ 1 2) (+ 1 (logv (+ 1 1))))

will return 3 and probably result in something like the following lines being sent to
WRITE-STRING-TO-LOG:

   ;[repl-thread] [01:06:2008] [14:07:53] (+ 1 2) -> 3
   ;[repl-thread] [01:06:2008] [14:07:53] (+ 1 1) -> 2
   ;[repl-thread] [01:06:2008] [14:07:53] (+ 1 (LOGV (+ 1 1))) -> 3

see also: FORMAT-LOG, LOGVS")
    (:TYPE :MACRO :SYMBOL (:NAME "LOGVS" :PACKAGE-NAME "LOGV" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "FORM" :PACKAGE-NAME "LOGV" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "MORE-FORMS" :PACKAGE-NAME "LOGV" :EXTERNALP NIL))
     :DOCUMENTATION "lke LOGV but works with multiple return values"))
   :EXTERNAL-SYMBOLS
   ((:NAME "*LOG-TIME-P*" :PACKAGE-NAME "LOGV" :EXTERNALP T)
    (:NAME "FORMAT-LOG" :PACKAGE-NAME "LOGV" :EXTERNALP T)
    (:NAME "LOGV" :PACKAGE-NAME "LOGV" :EXTERNALP T)
    (:NAME "WRITE-STRING-TO-LOG" :PACKAGE-NAME "LOGV" :EXTERNALP T)
    (:NAME "*LOG-OUTPUT*" :PACKAGE-NAME "LOGV" :EXTERNALP T)
    (:NAME "*LOG-THREAD-NAME-P*" :PACKAGE-NAME "LOGV" :EXTERNALP T)
    (:NAME "LOGVS" :PACKAGE-NAME "LOGV" :EXTERNALP T)
    (:NAME "*LOG-PREFIX-STRING*" :PACKAGE-NAME "LOGV" :EXTERNALP T)
    (:NAME "*LOG-DATE-P*" :PACKAGE-NAME "LOGV" :EXTERNALP T)))))
