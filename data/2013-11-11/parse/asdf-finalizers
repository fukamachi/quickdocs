
(:TYPE :SYSTEM :NAME "asdf-finalizers" :AUTHOR NIL :MAINTAINER NIL :VERSION NIL
 :LICENCE NIL :DESCRIPTION "Enforced calling of finalizers for Lisp code"
 :LONG-DESCRIPTION NIL :DEPENDS-ON NIL :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "ASDF-FINALIZERS" :FULL-NAME "ASDF-FINALIZERS"
   :DOCUMENTATION NIL :SYMBOL-LIST
   ((:TYPE :VARIABLE :SYMBOL
     (:NAME "*WARN-WHEN-FINALIZERS-OFF*" :PACKAGE-NAME "ASDF-FINALIZERS"
      :EXTERNALP T)
     :DOCUMENTATION "Flag to enable or disable the raising warnings
when finalizers are used outside of context.
Typically, you want that flag to be on while compiling your application, but
off when your application is done compiled and you're at runtime."
     :INITIAL-VALUE "T")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*DEBUG-FINALIZERS*" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP
      NIL)
     :DOCUMENTATION "Flag to enable debugging output for finalizers."
     :INITIAL-VALUE "NIL")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*FINALIZERS*" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL)
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*FINALIZERS-DATA*" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE "NIL")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "USING-FINALIZERS-P" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "RESET-FINALIZERS" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DISABLE-FINALIZERS" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP
      NIL)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "FINAL-FORMS" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION
     "This macro will expand into any final forms so far registered.
  The forms will be expanded inside an
    (EVAL-WHEN (:COMPILE-TOPLEVEL :LOAD-TOPLEVEL :EXECUTE) ...)
  but you can override that with your own EVAL-WHEN.
  You need to have finalizers enabled to use this macro (see WITH-FINALIZERS).
  In a file that uses finalizers, you MUST include (FINAL-FORMS)
  after the last finalizer was used and before the end of the file,
  or the compilation will fail.
  Typically, you will write (FINAL-FORMS) as the very last form in your file,
  or if you didn't use the asdf-finalizers package, you will instead write
  (ASDF-FINALIZERS:FINAL-FORMS).")
    (:TYPE :MACRO :SYMBOL
     (:NAME "FINAL-FORMS-INTERNAL" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP
      NIL)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "EXPAND-FINAL-FORMS" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP
      NIL)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REGISTER-FINALIZER" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "FINALIZER" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL))
     :DOCUMENTATION
     "This function, to be used within a macro, reader-macro, deftype, etc.,
  will register a THUNK to be called during finalization.
  Dependencies may be enforced by thunk calling thunk dependencies.
  Any form returned by the THUNK will be included in the finalized code
  after the code from any previously registered thunk of constant code fragment,
  and after the code from any registered dependency.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REGISTER-FINAL-FORM" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "FORM" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL))
     :DOCUMENTATION
     "This function, to be used within a macro, reader-macro, deftype, etc.,
  will register a constant piece of code to the evaluated at toplevel
  at the end of the current code fragment (e.g. file).")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "NO-FINALIZER-LEFT-BEHIND-P" :PACKAGE-NAME "ASDF-FINALIZERS"
      :EXTERNALP T)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ASSERT-NO-FINALIZER-LEFT-BEHIND" :PACKAGE-NAME "ASDF-FINALIZERS"
      :EXTERNALP T)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "WITH-FINALIZERS" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "FINALIZE" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL))
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL))
     :DOCUMENTATION "Evaluate BODY in a context where finalizers are enabled.
  By default, don't finalize, because we want to catch code
  that fails to finalize in the same file that requires code finalization.
  This macro is typically used by ASDF when you configure it as below.
  For convenience, you may also use it to test code at the REPL;
  you may then pass an argument FINALIZE with true value,
  and WITH-FINALIZERS will evaluate finalization forms.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CALL-WITH-FINALIZERS" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP
      T)
     :LAMBDA-LIST
     ((:NAME "THUNK" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FINALIZE" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "EVAL-AT-TOPLEVEL" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "FORM" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ALREADY-DONE-P-FORM" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP
       NIL)
      (:NAME "WARNING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "WARNING-ARGUMENTS" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP
       NIL))
     :DOCUMENTATION
     "This function, to be used within a macro, deftype, reader-macro, etc.,
  will evaluate toplevel FORM now during the macroexpansion phase, but also
  register it to be evaluated at the toplevel as part of the FINAL-FORMS,
  so that assuming you use the FINAL-FORMS afterwards but before the end of current file,
  so it is available to whoever load the associated FASL or CFASL.
  If the FORM has already been registered, it is skipped.
  Either now or when loading the (C?)FASL, the evaluation of FORM will be skipped
  when ALREADY-DONE-P-FORM evaluates to a true value.
  When finalizers are not enabled, warn with given warning and arguments or
  with a default warning, unless ALREADY-DONE-P-FORM evaluated to a true value,
  at which point we trust the user to somehow have done the right thing,
  and a build from clean will hopefully catch him if he didn't.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "COMPILE-CHECK-FINALIZERS" :PACKAGE-NAME "ASDF-FINALIZERS"
      :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "INPUT-FILE" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "KEYS" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&ALLOW-OTHER-KEYS" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CHECK-FINALIZERS-AROUND-COMPILE" :PACKAGE-NAME "ASDF-FINALIZERS"
      :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "FUN" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL))
     :DOCUMENTATION "Assuming your system :depends-on (:asdf-finalizers),
  you may use this function as your :around-compile function
  for an ASDF system, module or file, as in
	:around-compile \"asdf-finalizers:check-finalizers-around-compile\"
  This will allow you to use finalizers within covered source files,
  and will issue an error if you fail to evaluate (FINAL-FORMS)
  after the last finalizer was used and before the end of the file.
  Alternatively, you may use ASDF::FINALIZED-CL-SOURCE-FILE below.
  You may also have your own custom :around-compile hooks
  chain into CHECK-FINALIZERS-AROUND-COMPILE
  to achieve the same effect and more.")
    (:TYPE :CLASS :SYMBOL
     (:NAME "FINALIZED-CL-SOURCE-FILE" :PACKAGE-NAME "ASDF/INTERFACE"
      :EXTERNALP NIL)
     :SUPER-CLASS-LIST
     ((:NAME "CL-SOURCE-FILE" :PACKAGE-NAME "ASDF/LISP-ACTION" :EXTERNALP T))
     :DOCUMENTATION
     "Assuming your system :defsystem-depends-on (:asdf-finalizers),
  you may use this class as your system's :default-component-class,
  or as the class of a component as in
	(:finalized-cl-source-file \"foo\" :depends-on (\"bar\" \"baz\"))
  This will automatically declare CHECK-FINALIZERS-AROUND-COMPILE
  as the relevant component's :around-compile hook."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "AROUND-COMPILE" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP NIL)
       :ACCESSORS NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL))))
   :EXTERNAL-SYMBOLS
   ((:NAME "FINALIZERS-OFF-SIMPLE-WARNING" :PACKAGE-NAME "ASDF-FINALIZERS"
     :EXTERNALP T)
    (:NAME "FINALIZERS-OFF-WARNING" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP
     T)
    (:NAME "CALL-WITH-FINALIZERS" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
    (:NAME "FINALIZERS-OFF-ERROR" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
    (:NAME "REGISTER-FINAL-FORM" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
    (:NAME "USING-FINALIZERS-P" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
    (:NAME "ASSERT-NO-FINALIZER-LEFT-BEHIND" :PACKAGE-NAME "ASDF-FINALIZERS"
     :EXTERNALP T)
    (:NAME "CHECK-FINALIZERS-AROUND-COMPILE" :PACKAGE-NAME "ASDF-FINALIZERS"
     :EXTERNALP T)
    (:NAME "EVAL-AT-TOPLEVEL" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
    (:NAME "FINALIZERS-OFF-SIMPLE-ERROR" :PACKAGE-NAME "ASDF-FINALIZERS"
     :EXTERNALP T)
    (:NAME "NO-FINALIZER-LEFT-BEHIND-P" :PACKAGE-NAME "ASDF-FINALIZERS"
     :EXTERNALP T)
    (:NAME "COMPILE-CHECK-FINALIZERS" :PACKAGE-NAME "ASDF-FINALIZERS"
     :EXTERNALP T)
    (:NAME "FINAL-FORMS" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
    (:NAME "WITH-FINALIZERS" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
    (:NAME "FINALIZERS-OFF" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP T)
    (:NAME "*WARN-WHEN-FINALIZERS-OFF*" :PACKAGE-NAME "ASDF-FINALIZERS"
     :EXTERNALP T)
    (:NAME "REGISTER-FINALIZER" :PACKAGE-NAME "ASDF-FINALIZERS" :EXTERNALP
     T)))))
