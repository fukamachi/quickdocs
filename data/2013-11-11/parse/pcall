
(:TYPE :SYSTEM :NAME "pcall" :AUTHOR NIL :MAINTAINER NIL :VERSION NIL :LICENCE
 NIL :DESCRIPTION NIL :LONG-DESCRIPTION NIL :DEPENDS-ON
 ("BORDEAUX-THREADS" "PCALL-QUEUE") :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "PCALL" :FULL-NAME "PCALL" :DOCUMENTATION NIL
   :SYMBOL-LIST
   ((:TYPE :CLASS :SYMBOL (:NAME "TASK" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)
     :SUPER-CLASS-LIST NIL :DOCUMENTATION
     "A task is a piece of code that is scheduled to run
  in the thread pool."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "THUNK" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS ((:NAME "TASK-THUNK" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
       :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ERROR" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) :ACCESSORS
       ((:NAME "TASK-ERROR" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "VALUES" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) :ACCESSORS
       ((:NAME "TASK-VALUES" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)) :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "LOCK" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS ((:NAME "TASK-LOCK" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
       :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "WAIT-LOCKS" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "TASK-WAIT-LOCKS" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "STATUS" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "TASK-STATUS" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)) :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "WAITING" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "TASK-WAITING" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)) :READERS
       NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WITH-LOCKS" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "LOCKS" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)
      (:NAME "THUNK" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "EXECUTE-TASK" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "TASK" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)) :DOCUMENTATION
     "Execute a task, and store the result or error in the task object.
When a task's status is not :free, that means the joiner has already
started executing it, so this thread should leave it alone.")
    (:TYPE :FUNCTION :SYMBOL (:NAME "JOIN" :PACKAGE-NAME "PCALL" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "TASK" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
     :DOCUMENTATION
     "Join a task, meaning stop execution of the current thread until the
result of the task is available, and then return this result. When
this is called on a task that no thread is currently working on, the
current thread executes the task directly.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SELECT-ONE" :PACKAGE-NAME "PCALL" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "TASKS" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns the first task that can be joined without blocking.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DONE-P" :PACKAGE-NAME "PCALL" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "TASK" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)) :DOCUMENTATION NIL)
    (:TYPE :STRUCT :SYMBOL (:NAME "POOL" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)
     :SUPER-CLASS-LIST
     ((:NAME "STRUCTURE-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "THREADS" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "SIZE" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "LOCK" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ENV" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "QUEUE" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-POOL" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (((:NAME "THREADS" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM0" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "SIZE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM1" :PACKAGE-NAME NIL :EXTERNALP NIL))
       3)
      (((:NAME "LOCK" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM2" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-LOCK" :PACKAGE-NAME "BORDEAUX-THREADS" :EXTERNALP T)))
      (((:NAME "ENV" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM3" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "QUEUE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM4" :PACKAGE-NAME NIL :EXTERNALP NIL))
       ((:NAME "MAKE-QUEUE" :PACKAGE-NAME "PCALL-QUEUE" :EXTERNALP T))))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*POOL*" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :DOCUMENTATION NIL
     :INITIAL-VALUE "(PCALL::MAKE-POOL)")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "AUDIT-THREAD-POOL" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION
     "Make sure the thread pool holds the correct amount of live threads.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SPAWN-THREAD" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "POOL" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)) :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SPAWN-THREAD" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "POOL" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)) :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "STOP-THREAD" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "THREAD" :PACKAGE-NAME "BORDEAUX-THREADS" :EXTERNALP T)
      (:NAME "AT-ONCE-P" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FINISH-TASKS" :PACKAGE-NAME "PCALL" :EXTERNALP T) :LAMBDA-LIST
     (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "THREAD-POOL-SIZE" :PACKAGE-NAME "PCALL" :EXTERNALP T) :LAMBDA-LIST
     (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     ((:NAME "SETF" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "THREAD-POOL-SIZE" :PACKAGE-NAME "PCALL" :EXTERNALP T))
     :LAMBDA-LIST ((:NAME "SIZE" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SET-WORKER-ENVIRONMENT" :PACKAGE-NAME "PCALL" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "WRAPPER" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WORKER-THREAD" :PACKAGE-NAME "PCALL" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "QUEUE" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)) :DOCUMENTATION
     "The code running inside the pooled threads. Repeatedly tries to
take a task from the queue, and handles it.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "WITH-LOCAL-THREAD-POOL" :PACKAGE-NAME "PCALL" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       ((:NAME "SIZE" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)
        ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
         ((:NAME "POOL-SIZE" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)
          (:NAME "*POOL*" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))))
       ((:NAME "ON-UNWIND" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)
        (:NAME "WAIT" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))
       ((:NAME "WORKER-ENVIRONMENT" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)
        ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
         ((:NAME "POOL-ENV" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)
          (:NAME "*POOL*" :PACKAGE-NAME "PCALL" :EXTERNALP NIL)))))
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
     :DOCUMENTATION
     "Run body with a fresh thread pool. If on-unwind is :wait, it will
wait for all tasks to finish before returning. If it is :leave, the
form will return while threads are still working. If it is :stop
or :destroy, the threads will be stopped at the end of the body.
With :stop, they will first finish their current task (if any),
with :destroy, they will be brutally destroyed and might leak
resources, leave stuff in inconsistent state, etc.")
    (:TYPE :FUNCTION :SYMBOL (:NAME "PCALL" :PACKAGE-NAME "PCALL" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "THUNK" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
     :DOCUMENTATION
     "Call a thunk in parallel. Returns a task that can be joined. When
an exclusive is given, the task will only run when no other tasks with
that exclusive are running.")
    (:TYPE :MACRO :SYMBOL (:NAME "PEXEC" :PACKAGE-NAME "PCALL" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
     :DOCUMENTATION "Shorthand for pcall.")
    (:TYPE :MACRO :SYMBOL (:NAME "PLET" :PACKAGE-NAME "PCALL" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "BINDINGS" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "PCALL" :EXTERNALP NIL))
     :DOCUMENTATION NIL))
   :EXTERNAL-SYMBOLS
   ((:NAME "SELECT-ONE" :PACKAGE-NAME "PCALL" :EXTERNALP T)
    (:NAME "DONE-P" :PACKAGE-NAME "PCALL" :EXTERNALP T)
    (:NAME "FINISH-TASKS" :PACKAGE-NAME "PCALL" :EXTERNALP T)
    (:NAME "JOIN" :PACKAGE-NAME "PCALL" :EXTERNALP T)
    (:NAME "PCALL" :PACKAGE-NAME "PCALL" :EXTERNALP T)
    (:NAME "WITH-LOCAL-THREAD-POOL" :PACKAGE-NAME "PCALL" :EXTERNALP T)
    (:NAME "SET-WORKER-ENVIRONMENT" :PACKAGE-NAME "PCALL" :EXTERNALP T)
    (:NAME "PLET" :PACKAGE-NAME "PCALL" :EXTERNALP T)
    (:NAME "PEXEC" :PACKAGE-NAME "PCALL" :EXTERNALP T)
    (:NAME "THREAD-POOL-SIZE" :PACKAGE-NAME "PCALL" :EXTERNALP T)))))
