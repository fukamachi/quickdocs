
(:TYPE :SYSTEM :NAME "clack-middleware-csrf" :AUTHOR "Eitarow Fukamachi"
 :MAINTAINER NIL :VERSION "11.9" :LICENCE "LLGPL" :DESCRIPTION
 "Middleware for easy CSRF protection" :LONG-DESCRIPTION NIL :DEPENDS-ON
 ("CLACK" "CL-SYNTAX" "CL-SYNTAX-ANNOT" "ANAPHORA") :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "CLACK.MIDDLEWARE.CSRF" :FULL-NAME
   "CLACK.MIDDLEWARE.CSRF" :DOCUMENTATION "# 
Clack.Middleware.Csrf - Middleware for easy CSRF protection.


## SYNOPSIS

    ;; building application.
    (builder <clack-middleware-csrf> app)
    
    ;; in CL-EMB template.
    <form name=\"test-form\" method=\"post\" action=\"/\">
    <input type=\"text\" name=\"name\" />
    <%= (csrf-html-tag session) %>
    <input type=\"submit\" value=\"Send\" />
    </form>

## DESCRIPTION

## Block behavior

    (builder
     <clack-middleware-session>
     (<clack-middleware-csrf>
      :block-app #'(lambda (env)
                     @ignore env
                     '(302
                       (:location \"http://en.wikipedia.org/wiki/CSRF\")
                       nil)))
     app)

## AUTHOR

* Eitarow Fukamachi (e.arrows@gmail.com)

## SEE ALSO

* Clack.Middleware.Session

"
   :SYMBOL-LIST
   ((:TYPE :CLASS :SYMBOL
     (:NAME "<CLACK-MIDDLEWARE-CSRF>" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF"
      :EXTERNALP T)
     :SUPER-CLASS-LIST
     ((:NAME "<MIDDLEWARE>" :PACKAGE-NAME "CLACK.MIDDLEWARE" :EXTERNALP T))
     :DOCUMENTATION "Clack Middleware for easy CSRF protection." :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "BLOCK-APP" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "BLOCK-APP" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP
         NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ONE-TIME-P" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP
        NIL)
       :ACCESSORS
       ((:NAME "ONE-TIME-P" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP
         NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :METHOD :SYMBOL
     (:NAME "CALL" :PACKAGE-NAME "CLACK.COMPONENT" :EXTERNALP T) :LAMBDA-LIST
     (((:NAME "THIS" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP NIL)
       (:NAME "<CLACK-MIDDLEWARE-CSRF>" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF"
        :EXTERNALP T))
      (:NAME "ENV" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "RETURN-400" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "ENV" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DANGER-METHOD-P" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "REQUEST-METHOD" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP
       NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "VALID-TOKEN-P" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "ENV" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CSRF-HTML-TAG" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "SESSION" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP NIL))
     :DOCUMENTATION "Return an 'input' tag containing random CSRF token.
Note this has a side-effect, natually. This function stores the generated id into the current session when called."))
   :EXTERNAL-SYMBOLS
   ((:NAME "<CLACK-MIDDLEWARE-CSRF>" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF"
     :EXTERNALP T)
    (:NAME "CSRF-HTML-TAG" :PACKAGE-NAME "CLACK.MIDDLEWARE.CSRF" :EXTERNALP
     T)))))
