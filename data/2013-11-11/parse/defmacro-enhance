
(:TYPE :SYSTEM :NAME "defmacro-enhance" :AUTHOR
 "Alexander Popolitov <popolit@itep.ru>" :MAINTAINER NIL :VERSION "0.3"
 :LICENCE "GPL" :DESCRIPTION
 "Deformation of defmacro to defmacro!, macrolet to macrolet! etc. in spirit of let-over-lambda."
 :LONG-DESCRIPTION NIL :DEPENDS-ON ("ALEXANDRIA" "ITERATE") :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "DEFMACRO-ENHANCE" :FULL-NAME "DEFMACRO-ENHANCE"
   :DOCUMENTATION NIL :SYMBOL-LIST
   ((:TYPE :MACRO :SYMBOL
     (:NAME "DEF-*!-SYMBOL-P" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "SYMB" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION
     "Define test-function for argument to be prefix-bang-hyphen symbol.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "G!-SYMBOL-P" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "SYMB" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "O!-SYMBOL-P" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "SYMB" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "E!-SYMBOL-P" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "SYMB" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DECLARE-G!-SYMS-AS-GSYMS" :PACKAGE-NAME "DEFMACRO-ENHANCE"
      :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFINE-/G!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "SRC-NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "DST-NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "ARGS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION
     "Define macro SRC-NAME on top of DST-NAME. Arg list of DST-NAME should
contain BODY. All g!-symbols in BODY are transformed to gensyms.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFMACRO/G!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "ARGS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFMACRO-DRIVER/G!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "CLAUSE-TEMPLATE" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFUN/G!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "ARGS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "MACROLET/G!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "DEFINITIONS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "FLET/G!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "DEFINITIONS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "LABELS/G!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "DEFINITIONS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "ONCE-ONLY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     (((:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "SPECS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-O!-ONCE-ONLY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "ARGS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFINE-/O!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "SRC-NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "DST-NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "ARGS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION
     "All o!-symbols in the ARGS variable of the DST-NAME macro are
treated as once-only symbols. BODY variable is parsed accordingly.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFMACRO/G!/O!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "ARGS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "MACROLET/G!/O!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "DEFINITIONS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-E!-INTERNABLE" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFINE-/E!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "SRC-NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "DST-NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "ARGS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION "Deformation, in which E!-symbols are interned in package,
where macro is expanded, not where it is defined.
Useful for writing anaphoric macros.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFMACRO/G!/O!/E!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "ARGS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFMACRO-DRIVER/G!/E!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "CLAUSE-TEMPLATE" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFUN/G!/E!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "ARGS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "MACROLET/G!/O!/E!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "DEFINITIONS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "FLET/G!/E!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "DEFINITIONS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "LABELS/G!/E!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "DEFINITIONS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFMACRO!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "ARGS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION "Like defmacro, but with some extra perks.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFMACRO-DRIVER!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "CLAUSE-TEMPLATE" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION "Like defmacro, but with some extra perks.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFUN!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "NAME" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "ARGS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "MACROLET!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "DEFINITIONS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "FLET!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "DEFINITIONS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "LABELS!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "DEFINITIONS" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP NIL))
     :DOCUMENTATION NIL))
   :EXTERNAL-SYMBOLS
   ((:NAME "DEFMACRO-DRIVER!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
    (:NAME "LABELS!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
    (:NAME "MACROLET!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
    (:NAME "FLET!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
    (:NAME "DEFINE-/G!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
    (:NAME "DEFINE-/E!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
    (:NAME "DEFINE-/O!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
    (:NAME "DEFUN!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)
    (:NAME "DEFMACRO!" :PACKAGE-NAME "DEFMACRO-ENHANCE" :EXTERNALP T)))))
