
(:TYPE :SYSTEM :NAME "cl-secure-read" :AUTHOR
 "Alexander Popolitov <popolit@gmail.com>" :MAINTAINER NIL :VERSION NIL
 :LICENCE "GPLv3" :DESCRIPTION
 "Secure lisp reader in spirit of Let over Lambda" :LONG-DESCRIPTION NIL
 :DEPENDS-ON
 ("DEFMACRO-ENHANCE" "RUTILS" "NAMED-READTABLES" "ITERATE" "YACLANAPHT"
  "ALEXANDRIA")
 :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "CL-SECURE-READ" :FULL-NAME "CL-SECURE-READ"
   :DOCUMENTATION NIL :SYMBOL-LIST
   ((:TYPE :VARIABLE :SYMBOL
     (:NAME "SAFE-READ-FROM-STRING-BLACKLIST" :PACKAGE-NAME "CL-SECURE-READ"
      :EXTERNALP T)
     :DOCUMENTATION
     "Macro characters to disable in a readtable. If NIL, disable all macrocharacters there are."
     :INITIAL-VALUE "NIL")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "SAFE-READ-FROM-STRING-WHITELIST" :PACKAGE-NAME "CL-SECURE-READ"
      :EXTERNALP T)
     :DOCUMENTATION "Macro characters and features to enable in a readtable.
If NIL, nothing is enabled. Defaults to enabling construction of arbitrary conses and strings."
     :INITIAL-VALUE "'(:LISTS :QUOTES #\\\")")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ANALYZE-READTABLE-CHARS" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "READTABLE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "*READTABLE*" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION
     "Figure out, what characters in readtable are macro, and what are dispatch-macro.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "HASH->ASSOC" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "HASH" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "EXPAND-WHITE-BLACK-LIST" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP
      NIL)
     :LAMBDA-LIST ((:NAME "LST" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL))
     :DOCUMENTATION "Expand keyword abbreviations, found in a whitelist.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "WITH-LOCKED-READTABLE" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     (((:NAME "NAME" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
       (:NAME "READTABLE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "BLACKLIST" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
       (:NAME "WHITELIST" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL))
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL))
     :DOCUMENTATION
     "Parse black and whitelists, lock the readtable, then pass control to the body.
Binds RT to tightened readtable, BLACKLIST and WHITELIST to parsed black- and white-list, respectively.
NAME is the name of a function, which is used in the error report.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "SECURE-READ-FROM-STRING-LAMBDA" :PACKAGE-NAME "CL-SECURE-READ"
      :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "SAFE-NAME" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "READTABLE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "STANDARD" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))
      ((:NAME "BLACKLIST" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
       ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "SAFE-READ-FROM-STRING-BLACKLIST" :PACKAGE-NAME "CL-SECURE-READ"
         :EXTERNALP T)))
      ((:NAME "WHITELIST" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
       ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "SAFE-READ-FROM-STRING-WHITELIST" :PACKAGE-NAME "CL-SECURE-READ"
         :EXTERNALP T)))
      (:NAME "FAIL-VALUE" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL))
     :DOCUMENTATION "Define a safer version of READ-FROM-STRING.
READTABLE is a name of a readtable, on base of which to build a 'locked' version of a readtable.
BLACKLIST is a list of macrocharacters and dispatching macro-characters not to allow.
WHITELIST is a list of macrocharacters and dispatching macro-characters to allow.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFINE-SECURE-READ-FROM-STRING" :PACKAGE-NAME "CL-SECURE-READ"
      :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "SAFE-NAME" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "READTABLE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "STANDARD" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))
      ((:NAME "BLACKLIST" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
       ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "SAFE-READ-FROM-STRING-BLACKLIST" :PACKAGE-NAME "CL-SECURE-READ"
         :EXTERNALP T)))
      ((:NAME "WHITELIST" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
       ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "SAFE-READ-FROM-STRING-WHITELIST" :PACKAGE-NAME "CL-SECURE-READ"
         :EXTERNALP T)))
      (:NAME "FAIL-VALUE" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "SECURE-READ-LAMBDA" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "SAFE-NAME" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "READTABLE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "STANDARD" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))
      ((:NAME "BLACKLIST" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
       ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "SAFE-READ-FROM-STRING-BLACKLIST" :PACKAGE-NAME "CL-SECURE-READ"
         :EXTERNALP T)))
      ((:NAME "WHITELIST" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
       ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "SAFE-READ-FROM-STRING-WHITELIST" :PACKAGE-NAME "CL-SECURE-READ"
         :EXTERNALP T)))
      (:NAME "PRESERVING-WHITESPACE" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP
       NIL)
      (:NAME "FAIL-VALUE" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :MACRO :SYMBOL
     (:NAME "DEFINE-SECURE-READ" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "SAFE-NAME" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "READTABLE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "STANDARD" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))
      ((:NAME "BLACKLIST" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
       ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "SAFE-READ-FROM-STRING-BLACKLIST" :PACKAGE-NAME "CL-SECURE-READ"
         :EXTERNALP T)))
      ((:NAME "WHITELIST" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL)
       ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "SAFE-READ-FROM-STRING-WHITELIST" :PACKAGE-NAME "CL-SECURE-READ"
         :EXTERNALP T)))
      (:NAME "PRESERVING-WHITESPACE" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP
       NIL)
      (:NAME "FAIL-VALUE" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP NIL))
     :DOCUMENTATION NIL))
   :EXTERNAL-SYMBOLS
   ((:NAME "SAFE-READ-FROM-STRING-BLACKLIST" :PACKAGE-NAME "CL-SECURE-READ"
     :EXTERNALP T)
    (:NAME "SECURE-READ-FROM-STRING-LAMBDA" :PACKAGE-NAME "CL-SECURE-READ"
     :EXTERNALP T)
    (:NAME "DEFINE-SECURE-READ" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP T)
    (:NAME "SECURE-READ-LAMBDA" :PACKAGE-NAME "CL-SECURE-READ" :EXTERNALP T)
    (:NAME "DEFINE-SECURE-READ-FROM-STRING" :PACKAGE-NAME "CL-SECURE-READ"
     :EXTERNALP T)
    (:NAME "SAFE-READ-FROM-STRING-WHITELIST" :PACKAGE-NAME "CL-SECURE-READ"
     :EXTERNALP T)))))
