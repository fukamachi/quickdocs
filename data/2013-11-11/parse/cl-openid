
(:TYPE :SYSTEM :NAME "cl-openid" :AUTHOR "Maciej Pasternacki" :MAINTAINER
 "Maciej Pasternacki" :VERSION "0.1" :LICENCE
 "LLGPL, see http://opensource.franz.com/preamble.html for details"
 :DESCRIPTION "cl-openid" :LONG-DESCRIPTION NIL :DEPENDS-ON
 ("DRAKMA" "IRONCLAD" "XMLS" "SPLIT-SEQUENCE" "PURI" "CL-HTML-PARSE"
  "CL-BASE64" "TRIVIAL-UTF-8" "BORDEAUX-THREADS" "SECURE-RANDOM")
 :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "CL-OPENID" :FULL-NAME "CL-OPENID" :DOCUMENTATION NIL
   :SYMBOL-LIST
   ((:TYPE :MACRO :SYMBOL
     (:NAME "DEFINE-CONSTANT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "NAME" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "VALUE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "OPTIONS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION
     "Do a DEFCONSTANT, but do not attempt to redefine if already bound.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "AGET" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "KEY" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "ALIST" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION "Get a CDR of an (ASSOC KEY ALIST).

Sequence (e.g. string) keys are searched with :TEST #'EQUAL.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BTWOC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "I" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "OCTETS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       ((:NAME "INTEGER-TO-OCTETS" :PACKAGE-NAME "IRONCLAD" :EXTERNALP T)
        (:NAME "I" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))))
     :DOCUMENTATION
     "Return two's complement binary string representing integer I, as an octet vector.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "BASE64-BTWOC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "I" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION
     "Return two's complement binary string representing integer I, as Base64-encoded string.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-INTEGER" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "VAL" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION
     "For VAL being an integer, a Base64-encoded string representing
integer, or an octet vector representing integer, return its integer
value.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-VECTOR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "VAL" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION
     "For VAL being an integer, a Base64-encoded string representing
integer, or an octet vector representing integer, return it as an
octet vector.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-VECTOR-LENGTH" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "VEC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "LEN" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION "Shorten or enlarge vector VEC so that it has length LEN.

If (= (LENGTH VEC) LEN), returns VEC.  Otherwise, either pads with
zeroes on the left, or removes a number of leftmost elements.")
    (:TYPE :MACRO :SYMBOL
     (:NAME "STRING-CASE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "KEYFORM" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "CLAUSES" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION "Like CASE, but for a string KEYFORM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "NEW-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "U" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)) :DOCUMENTATION
     "Return U as new URI object.

If U is already an URI object, return a copy; otherwise, return (URI U).")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAYBE-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "U" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)) :DOCUMENTATION
     "Return (URI U), unless U is NIL.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENSURE-TRAILING-SLASH" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "PATH" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION "Add trailing slash to PATH if it's not already there.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ALIST-TO-URL-ENCODED-STRING" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "ALIST" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "EXTERNAL-FORMAT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION
     "ALIST is supposed to be an alist of name/value pairs where both
names and values are strings (or, for values, NIL).  This function
returns a string where this list is represented as for the content
type `application/x-www-form-urlencoded', i.e. the values are
URL-encoded using the external format EXTERNAL-FORMAT, the pairs are
joined with a #\\& character, and each name is separated from its
value with a #\\= character.  If the value is NIL, no #\\= is used.")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+OPENID2-NAMESPACE+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :DOCUMENTATION "Namespace URI for OpenID 2.0 messages." :INITIAL-VALUE
     "\"http://specs.openid.net/auth/2.0\"")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+OPENID2-NAMESPACE+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :DOCUMENTATION "Namespace URI for OpenID 2.0 messages." :INITIAL-VALUE
     "\"http://specs.openid.net/auth/2.0\"")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+OPENID2-NS-CONS+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :DOCUMENTATION "Helper constant pair for constructing messages."
     :INITIAL-VALUE "(CONS \"openid.ns\" CL-OPENID::+OPENID2-NAMESPACE+)")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+OPENID2-NS-CONS+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :DOCUMENTATION "Helper constant pair for constructing messages."
     :INITIAL-VALUE "(CONS \"openid.ns\" CL-OPENID::+OPENID2-NAMESPACE+)")
    (:TYPE :MACRO :SYMBOL
     (:NAME "IN-NS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "NAMESPACE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "+OPENID2-NAMESPACE+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
         NIL))))
     :DOCUMENTATION "Add openid.namespace NAMESPACE to MESSAGE.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MESSAGE-FIELD" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "FIELD-NAME" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION "get value of FIELD-NAME field from MESSAGE.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MESSAGE-V2-P" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)) :DOCUMENTATION
     "True if MESSAGE is an OpenID v2 message (namespace check).")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MESSAGE-FIELD-STRING" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "VALUE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION "Format VALUE as a string for protocol message.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "PARAMETERS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION "Make new message from arbitrary keyword parameters.

Keyword specifies a message field key (actual key is lowercased symbol
name), and value following the keyword specifies associated value.

Value can be a string (which will be literal field value),
symbol (symbol's name will be used as a value), vector
of (UNSIGNED-BYTE 8) (which will be Base64-encoded), URI object or
integer (which both will be PRINC-TO-STRING-ed).

If value is NIL, field won't be included in the message at all.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "COPY-MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T) :LAMBDA-LIST
     ((:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "PARAMETERS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION
     "Create a copy of MESSAGE, updating PARAMETERS provided as keyword parameters.

If MESSAGE already includes provided key, new value is used in the
result; if a key is new, the field will be appended to result message.
PARAMETERS are interpreted as by MAKE-MESSAGE function.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PARSE-KV" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "ARRAY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)) :DOCUMENTATION
     "Parse key-value form message passed as an octet vector into parameter alist.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-KV" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)) :DOCUMENTATION
     "Encode MESSAGE alist as key-value form octet vector")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DIRECT-REQUEST" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "URI" :PACKAGE-NAME "PURI" :EXTERNALP T)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION "Send a direct request to URI, sending MESSAGE alist.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ERROR-RESPONSE-MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "ERR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "CONTACT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "REFERENCE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "INDIRECT-MESSAGE-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "ENDPOINT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "URI" :PACKAGE-NAME "PURI" :EXTERNALP T)
       ((:NAME "NEW-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
        (:NAME "ENDPOINT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))))
     :DOCUMENTATION
     "Return URI to send indirect message MESSAGE to endpoint URI ENDPOINT.

Usable for both indirect requests and responses.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "AUTH-REQUEST-REALM" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "AUTH-REQUEST-MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION "Returns the realm of the OpenID authentication
request AUTH-REQUEST-MESSAGE.")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+DH-PRIME+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :DOCUMENTATION
     "This is a confirmed-prime number, used as the default modulus for Diffie-Hellman Key Exchange."
     :INITIAL-VALUE "(PARSE-INTEGER
 (CONCATENATE 'STRING
              \"DCF93A0B883972EC0E19989AC5A2CE310E1D37717E8D9571BB7623731866E61E\"
              \"F75A2E27898B057F9891C2E27A639C3F29B60814581CD3B2CA3986D268370557\"
              \"7D45C2E7E52DC81C7A171876E5CEA74B1448BFDFAF18828EFD2519F14E45E382\"
              \"6634AF1949E5B535CC829A483B8A76223E5D490A257F05BDFF16F2FB22C583AB\")
 :RADIX 16)")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+DH-GENERATOR+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :DOCUMENTATION "Default generator value for Diffie-Hellman key exchange."
     :INITIAL-VALUE "2")
    (:TYPE :STRUCT :SYMBOL
     (:NAME "ASSOCIATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :SUPER-CLASS-LIST
     ((:NAME "STRUCTURE-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "An association between OP and RP." :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "EXPIRES" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :ACCESSORS
       NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "HANDLE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "MAC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :ACCESSORS NIL
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "HMAC-DIGEST" :PACKAGE-NAME "IRONCLAD" :EXTERNALP T) :ACCESSORS
       NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "%MAKE-ASSOCIATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (((:NAME "EXPIRES" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM0" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "HANDLE" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM1" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "MAC" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM2" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "HMAC-DIGEST" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM3" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*DEFAULT-ASSOCIATION-TIMEOUT*" :PACKAGE-NAME "CL-OPENID"
      :EXTERNALP NIL)
     :DOCUMENTATION "Default association timeout, in seconds" :INITIAL-VALUE
     "3600")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "OPENID-ASSOCIATION-ERROR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "FORMAT-CONTROL" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORMAT-ARGUMENTS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SESSION-DIGEST-TYPE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "SESSION-TYPE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*ASSOCIATION-HANDLE-COUNTER*" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
      NIL)
     :DOCUMENTATION "Counter for unique association handle generation"
     :INITIAL-VALUE "0")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "NEW-ASSOCIATION-HANDLE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION "Return new unique association handle as string")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DH-ENCRYPT/DECRYPT-KEY" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "DIGEST" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "GENERATOR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "PRIME" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "PUBLIC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "PRIVATE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "KEY" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION "Perform Diffie-Hellman key exchange.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-ASSOCIATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "HANDLE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       ((:NAME "NEW-ASSOCIATION-HANDLE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
         NIL)))
      ((:NAME "EXPIRES-IN" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       (:NAME "*DEFAULT-ASSOCIATION-TIMEOUT*" :PACKAGE-NAME "CL-OPENID"
        :EXTERNALP NIL))
      ((:NAME "EXPIRES-AT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       ((:NAME "+" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        ((:NAME "GET-UNIVERSAL-TIME" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
        (:NAME "EXPIRES-IN" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)))
      (:NAME "ASSOCIATION-TYPE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      ((:NAME "HMAC-DIGEST" :PACKAGE-NAME "IRONCLAD" :EXTERNALP T)
       ((:NAME "OR" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        ((:NAME "AGET" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
         (:NAME "ASSOCIATION-TYPE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
         ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
          (("HMAC-SHA1" :NAME "SHA1" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
           ("HMAC-SHA256" :NAME "SHA256" :PACKAGE-NAME "KEYWORD" :EXTERNALP
            T))))
        ((:NAME "OPENID-ASSOCIATION-ERROR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
          NIL)
         "Unknown association type ~A."
         (:NAME "ASSOCIATION-TYPE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))))
      ((:NAME "MAC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       ((:NAME "NUMBER" :PACKAGE-NAME "SECURE-RANDOM" :EXTERNALP T)
        115792089237316195423570985008687907853269984665640564039457584007913129639936)))
     :DOCUMENTATION "Make new association structure, DWIM included.

 - HANDLE should be the new association handle; if none is provided,
   new one is generated.
 - EXPIRES-IN is the timeout of the handle; alternatively, EXPIRES-AT
   is the universal-time when association times out.
 - ASSOCIATION-TYPE is the OpenID association type (string);
   alternatively, HMAC-DIGEST is an Ironclad digest name (a keyword)
   used for signature HMAC checks.
 - MAC is the literal, unencrypted MAC key.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ASSOCIATE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "ENDPOINT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "V1" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "ASSOC-TYPE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "SESSION-TYPE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "XA" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SIGNATURE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "ASSOCIATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "SIGNED" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION
     "Calculate signature from MESSAGE using ASSOCIATION, return signature string.

Optional SIGNED parameter is a list of fields to sign, as strings,
with \"openid\" prefix stripped.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SIGNED" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "ASSOCIATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "SIGNED" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION "Sign MESSAGE, using ASSOCIATION, return signed message.

Optional SIGNED parameter is a list of fields to sign, as strings,
with \"openid\" prefix stripped.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CHECK-SIGNATURE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "ASSOCIATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :STRUCT :SYMBOL
     (:NAME "AUTH-PROCESS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :SUPER-CLASS-LIST
     ((:NAME "STRUCTURE-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Data structure gathering information about an ongoing authentication process."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "PROTOCOL-VERSION-MAJOR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
       :ACCESSORS NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "PROTOCOL-VERSION-MINOR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
       :ACCESSORS NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "CLAIMED-ID" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T) :ACCESSORS
       NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "OP-LOCAL-ID" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T) :ACCESSORS
       NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "IMMEDIATE-P" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T) :ACCESSORS
       NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "RETURN-TO" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T) :ACCESSORS
       NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "XRDS-LOCATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
       :ACCESSORS NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "PROVIDER-ENDPOINT-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
       :ACCESSORS NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "TIMESTAMP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T) :ACCESSORS
       NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "%MAKE-AUTH-PROCESS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (((:NAME "PROTOCOL-VERSION-MAJOR" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM0" :PACKAGE-NAME NIL :EXTERNALP NIL))
       2)
      (((:NAME "PROTOCOL-VERSION-MINOR" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM1" :PACKAGE-NAME NIL :EXTERNALP NIL))
       0)
      (((:NAME "CLAIMED-ID" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM2" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "OP-LOCAL-ID" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM3" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "IMMEDIATE-P" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM4" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "RETURN-TO" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM5" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "XRDS-LOCATION" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM6" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "PROVIDER-ENDPOINT-URI" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM7" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (((:NAME "TIMESTAMP" :PACKAGE-NAME "KEYWORD" :EXTERNALP T)
        (:NAME "DUM8" :PACKAGE-NAME NIL :EXTERNALP NIL))
       (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PROTOCOL-VERSION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "AUTH-PROCESS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION
     "Protocol version of an authentication process, as a cons (MAJOR . MINOR).")
    (:TYPE :FUNCTION :SYMBOL
     ((:NAME "SETF" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "PROTOCOL-VERSION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :LAMBDA-LIST
     ((:NAME "NEW-VALUE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "AUTH-PROCESS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REMOVE-DOT-SEGMENTS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "PARSED-PATH" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION
     "Remove . and .. from parsed URI path, to correctly identify same
  paths and prevent URI traversal attacks.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-AUTH-PROCESS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "GIVEN-ID" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION
     "Initialize new AUTH-PROCESS structure from a user-given identifier GIVEN-ID (string).

An XRDS location for Yadis discovery discovered by a HEAD request may
be included in returned structure.")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+ENTITIES+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :DOCUMENTATION "Alist of HTML entities to be unquoted." :INITIAL-VALUE
     "'((\"amp\" . #\\&) (\"gt\" . #\\>) (\"lt\" . #\\<) (\"quot\" . #\\\"))")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+ENTITIES+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :DOCUMENTATION "Alist of HTML entities to be unquoted." :INITIAL-VALUE
     "'((\"amp\" . #\\&) (\"gt\" . #\\>) (\"lt\" . #\\<) (\"quot\" . #\\\"))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "N-REMOVE-ENTITIES" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "ENTITIES" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       (:NAME "+ENTITIES+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)))
     :DOCUMENTATION "Remove HTML entities from STR, destructively.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PERFORM-HTML-DISCOVERY" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "AUTHPROC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "EP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "OPLOC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "EP.1" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "OPLOC.1" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "XRDS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+PROTOCOL-VERSIONS+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :DOCUMENTATION "OpenID protocol versions for XRDS service type URIs"
     :INITIAL-VALUE "'((\"http://specs.openid.net/auth/2.0/server\" 2 . 0)
  (\"http://specs.openid.net/auth/2.0/signon\" 2 . 0)
  (\"http://openid.net/signon/1.0\" 1 . 0) (\"http://openid.net/server/1.0\" 1 . 0)
  (\"http://openid.net/signon/1.1\" 1 . 1) (\"http://openid.net/server/1.1\" 1 . 1))")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+PROTOCOL-VERSIONS+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :DOCUMENTATION "OpenID protocol versions for XRDS service type URIs"
     :INITIAL-VALUE "'((\"http://specs.openid.net/auth/2.0/server\" 2 . 0)
  (\"http://specs.openid.net/auth/2.0/signon\" 2 . 0)
  (\"http://openid.net/signon/1.0\" 1 . 0) (\"http://openid.net/server/1.0\" 1 . 0)
  (\"http://openid.net/signon/1.1\" 1 . 1) (\"http://openid.net/server/1.1\" 1 . 1))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "PERFORM-XRDS-DISCOVERY" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "AUTHPROC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "PARSED" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       ((:NAME "PARSE" :PACKAGE-NAME "XMLS" :EXTERNALP T)
        (:NAME "BODY" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)))
      (:NAME "PRIO" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "ENDPOINT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "OPLOCAL" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "V1PRIO" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "V1ENDPOINT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "V1OPLOCAL" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "V1TYPE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "OPENID-DISCOVERY-ERROR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "FORMAT-CONTROL" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORMAT-ARGUMENTS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CHECK-DISCOVERY-POSTCONDITION" :PACKAGE-NAME "CL-OPENID"
      :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "AUTHPROC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DISCOVER" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "ID" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "AUTHPROC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
       ((:NAME "ETYPECASE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        (:NAME "ID" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
        ((:NAME "AUTH-PROCESS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
         (:NAME "ID" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
        ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
         ((:NAME "MAKE-AUTH-PROCESS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
          (:NAME "ID" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)))))
      ((:NAME "REQUEST-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       ((:NAME "OR" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        ((:NAME "XRDS-LOCATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
         (:NAME "AUTHPROC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
        ((:NAME "CLAIMED-ID" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
         (:NAME "AUTHPROC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))))
      ((:NAME "*TEXT-CONTENT-TYPES*" :PACKAGE-NAME "DRAKMA" :EXTERNALP T)
       ((:NAME "APPEND" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        ((:NAME "QUOTE" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
         (("application" . "xhtml+xml") ("application" . "xrds+xml")))
        (:NAME "*TEXT-CONTENT-TYPES*" :PACKAGE-NAME "DRAKMA" :EXTERNALP T))))
     :DOCUMENTATION "Perform discovery on ID.

ID may be either an already initialized AUTH-PROCESS structure, or
user-given ID string.

Signals an OPENID-DISCOVERY-ERROR if the discovery was unsuccessful, i.e.
when the discovery URI specified by ID does not contain the needed
OpenID discovery information. May also signal other errors, in case
of network problems, or if the URI is not available, etc.
")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "REQUEST-AUTHENTICATION-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "AUTHPROC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "REALM" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "IMMEDIATE-P" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "ASSOCIATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "EXTRA-PARAMETERS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION "URI for an authentication request for AUTHPROC")
    (:TYPE :CLASS :SYMBOL
     (:NAME "RELYING-PARTY" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :SUPER-CLASS-LIST NIL :DOCUMENTATION "Relying Party server class."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ROOT-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T) :ACCESSORS
       ((:NAME "ROOT-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION
       "Root URI address of the Relying Party instance.

Used to generate return_to redirections.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "REALM" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T) :ACCESSORS
       ((:NAME "REALM" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION "Relying Party realm.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ASSOCIATIONS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "ASSOCIATIONS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION "Associations made by RP.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ASSOCIATIONS-LOCK" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "ASSOCIATIONS-LOCK" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "AUTHPROCS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "AUTHPROCS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)) :READERS
       NIL :WRITERS NIL :DOCUMENTATION
       "Authenticaction processes currently handled by RP.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "AUTHPROC-TIMEOUT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "AUTHPROC-TIMEOUT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION
       "Number of seconds after which an AUTH-PROCESS is considered timed out and is deleted from AUTHPROCS.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "AUTHPROCS-LOCK" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "AUTHPROCS-LOCK" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "NONCES" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "NONCES" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)) :READERS NIL
       :WRITERS NIL :DOCUMENTATION
       "A list of openid.nonce response parameters to avoid duplicates.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "NONCE-TIMEOUT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "NONCE-TIMEOUT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION
       "Number of seconds after which nonce is considered timed out.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "NONCES-LOCK" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "NONCES-LOCK" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "GC-ASSOCIATIONS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "SERVER" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "INVALIDATE-HANDLE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "TIME" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       ((:NAME "GET-UNIVERSAL-TIME" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP
         T))))
     :DOCUMENTATION "Garbage-collect timed out associations from SERVER.

INVALIDATE-HANDLE is a handle of association that needs to be
collected regardless of validity.  SERVER may be a RELYING-PARTY or
OPENID-PROVIDER instance.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ASSOCIATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "RP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "ENDPOINT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "V1" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "AP-ASSOCIATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "RP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "AUTHPROC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ASSOCIATION-BY-HANDLE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "RP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "HANDLE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "GC-AUTHPROCS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "RP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "TIME-LIMIT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       ((:NAME "-" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        ((:NAME "GET-UNIVERSAL-TIME" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
        ((:NAME "AUTHPROC-TIMEOUT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
         (:NAME "RP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)))))
     :DOCUMENTATION "Collect old auth-process objects from relying party RP.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "AUTHPROC-BY-HANDLE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "RP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "HANDLE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*AUTH-HANDLE-COUNTER*" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :DOCUMENTATION "Counter for unique association handle generation"
     :INITIAL-VALUE "0")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "NEW-AUTHPROC-HANDLE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION "Return new unique authentication handle as string")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+AUTHPROC-HANDLE-PARAMETER+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
      T)
     :DOCUMENTATION
     "Name of HTTP GET parameter, sent in return_to URI, which contains AUTH-PROCESS object unique handle."
     :INITIAL-VALUE "\"cl-openid.authproc-handle\"")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+AUTHPROC-HANDLE-PARAMETER+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
      T)
     :DOCUMENTATION
     "Name of HTTP GET parameter, sent in return_to URI, which contains AUTH-PROCESS object unique handle."
     :INITIAL-VALUE "\"cl-openid.authproc-handle\"")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "INITIATE-AUTHENTICATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "RP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "GIVEN-ID" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "IMMEDIATE-P" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "EXTRA-PARAMETERS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "AUTHPROC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
       ((:NAME "DISCOVER" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
        (:NAME "GIVEN-ID" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)))
      ((:NAME "HANDLE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       ((:NAME "NEW-AUTHPROC-HANDLE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
         NIL))))
     :DOCUMENTATION
     "Initiate authentication process by relying party RP for identifier GIVEN-ID received from user.

If IMMEDIATE-P is true, initiates immediate authentication process.

The EXTRA-PARAMETERS is an optional key-value list to be added to the authentication request message.
The list format is the same as for the MAKE-MESSAGE function. This parameter is needed for OpenID
extensions, for example OAuth or Attribute Exchange.

Returns multiple values:
  - the URI to redirect the user's browser to;
  - Unique handle (string) identifying the started authentication process;
  - the AUTH-PROCESS structure identified by the handle.

The latter two values are useful if the client code needs to track the process.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "NONCE-UNIVERSAL-TIME" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "NONCE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "GC-NONCES" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "RP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "TIME-LIMIT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       ((:NAME "-" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        ((:NAME "GET-UNIVERSAL-TIME" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
        ((:NAME "NONCE-TIMEOUT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
         (:NAME "RP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)))))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "HANDLE-INDIRECT-RESPONSE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "RP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "REQUEST-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "AUTHPROC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION
     "Handle indirect response MESSAGE for RP, coming at REQUEST-URI, concerning AUTHPROC.

AUTHPROC can be a literal AUTH-PROCESS object, or a string (unique
authproc handle, sent earlier by RP). When AUTHPROC is NIL or not
supplied, its handle is taken from MESSAGE.

Returns claimed ID URI on success, NIL on failure.
As second value, always returns AUTH-PROCESS object.")
    (:TYPE :CLASS :SYMBOL
     (:NAME "OPENID-PROVIDER" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :SUPER-CLASS-LIST NIL :DOCUMENTATION
     "OpenID Provider server abstract class.

This class should be subclassed, and specialized methods should be
provided at least for HANDLE-CHECKID-SETUP (preferably also for
HANDLE-CHECKID-IMMEDIATE)."
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ENDPOINT-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T) :ACCESSORS
       ((:NAME "ENDPOINT-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)) :READERS
       NIL :WRITERS NIL :DOCUMENTATION "Provider endpoint URI")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ASSOCIATIONS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "ASSOCIATIONS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION "OP's associations.")
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "ASSOCIATIONS-LOCK" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "ASSOCIATIONS-LOCK" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*NONCE-COUNTER*" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :DOCUMENTATION "Counter for nonce generation" :INITIAL-VALUE "0")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "NONCE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL) :LAMBDA-LIST
     (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T) :DOCUMENTATION NIL)
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+INDIRECT-RESPONSE-CODE+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :DOCUMENTATION
     "HTTP code recommented to use for indirect responses sent via HTTP redirect."
     :INITIAL-VALUE "303")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "INDIRECT-RESPONSE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "RETURN-TO" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION
     "Return indirect response (URI as body +INDIRECT-RESPONSE-CODE+ as the second value).")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DIRECT-ERROR-RESPONSE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "ERR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "CONTACT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "REFERENCE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION
     "Return error direct response (key-value-encoded error message as
body, 400 Error code as second value).")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DIRECT-RESPONSE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST ((:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION
     "Return direct response (key-value-encoded MESSAGE as body, no second value).")
    (:TYPE :MACRO :SYMBOL
     (:NAME "WITH-INDIRECT-ERROR-HANDLER" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "&BODY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION "Handle INDIRECT-ERROR in BODY.

When INDIRECT-ERROR is signaled, immediately return indirect error response.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SIGNAL-INDIRECT-ERROR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "REASON" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ARGS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION
     "Signal INDIRECT-ERROR condition for MESSAGE, effectively returning indirect error reply from WITH-INDIRECT-ERROR-HANDLER.

REASON is textual error message format string, with ARGS being its
arguments.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SUCCESSFUL-RESPONSE-MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SUCCESSFUL-RESPONSE-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "AUTH-REQUEST-MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns the URI of the Relying Party to redirect the user's browser
to. The URI parameters tell the Relying Party that the authentication 
was successful. AUTH-REQUEST-MESSAGE should be the oritinal OpenID 
authentication request message that was received from the Relying Party 
previously and passed to the HANDLE-CHECKID-SETUP.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "USER-SETUP-URL" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION
     "Returns the value to be passed in the openid.user_setup_url 
parameter of a response to a failed immediate authentication request. 
OP is the OpenID Provider. MESSAGE is the original authentication 
request. In case the MESSAGE is a request of OpenID version 2, 
returns NIL.")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+SETUP-NEEDED-RESPONSE-MESSAGE+" :PACKAGE-NAME "CL-OPENID"
      :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "(CL-OPENID:IN-NS (CL-OPENID:MAKE-MESSAGE :OPENID.MODE \"setup_needed\"))")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+SETUP-NEEDED-RESPONSE-MESSAGE+" :PACKAGE-NAME "CL-OPENID"
      :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "(CL-OPENID:IN-NS (CL-OPENID:MAKE-MESSAGE :OPENID.MODE \"setup_needed\"))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SETUP-NEEDED-RESPONSE-MESSAGE" :PACKAGE-NAME "CL-OPENID"
      :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "SETUP-NEEDED-RESPONSE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION
     "Send setup_needed (immediate authentication failure) response to MESSAGE from OP.")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+CANCEL-RESPONSE-MESSAGE+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
      NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "(CL-OPENID:IN-NS (CL-OPENID:MAKE-MESSAGE :OPENID.MODE \"cancel\"))")
    (:TYPE :CONSTANT :SYMBOL
     (:NAME "+CANCEL-RESPONSE-MESSAGE+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
      NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "(CL-OPENID:IN-NS (CL-OPENID:MAKE-MESSAGE :OPENID.MODE \"cancel\"))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CANCEL-RESPONSE-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "AUTH-REQUEST-MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL))
     :DOCUMENTATION
     "Returns the URI of the Relying Party to redirect the user's browser
to. The URI parameters tell the Relying Party that the authentication 
failed. AUTH-REQUEST-MESSAGE should be the oritinal OpenID 
authentication request message that was received from the Relying Party 
previously and passed to the HANDLE-CHECKID-SETUP.")
    (:TYPE :GENERIC :SYMBOL
     (:NAME "HANDLE-CHECKID-SETUP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION "Handles checkid_setup requests.

This generic should be specialized on concrete Provider classes to
perform login checks with user dialogue, that would (possibly
after some HTTP request-response cycles) end by redirecting the 
user's browser either to SUCCESSFUL-RESPONSE-URI, or to 
CANCEL-RESPONSE-URI.

This generic is called by HANDLE-OPENID-PROVIDER-REQUEST, and
the values returned by this function are then returned by
HANDLE-OPENID-PROVIDER-REQUEST. I.e. it must return two values:
response \"body\" and HTTP status code. That way HANDLE-CHECKID-SETUP
can either redirect user's browser somewhere, or just show him
something. (With hunchentoot, HUNCHNTOOT:REDIRECT
may also be used, which is a non-local transfer control).

Default method just returns (VALUES (CANSEL-RESPONSE-URI ...) +INDIRECT-RESPONSE-CODE+).")
    (:TYPE :METHOD :SYMBOL
     (:NAME "HANDLE-CHECKID-SETUP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "HANDLE-CHECKID-SETUP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :GENERIC :SYMBOL
     (:NAME "HANDLE-CHECKID-IMMEDIATE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION "Handles checkid_immediate requests.

This generic should be specialized on concrete Provider classes to
perform immediate login checks on MESSAGE. It should return at once,
either true value (to indicate successful login), or NIL (to indicate
immediate login failure).")
    (:TYPE :METHOD :SYMBOL
     (:NAME "HANDLE-CHECKID-IMMEDIATE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION "Always fail.")
    (:TYPE :METHOD :SYMBOL
     (:NAME "HANDLE-CHECKID-IMMEDIATE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T))
     :DOCUMENTATION "Always fail.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CHECK-REALM" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "REALM" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "URI" :PACKAGE-NAME "PURI" :EXTERNALP T))
     :DOCUMENTATION "Check URI against REALM.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "HANDLE-OPENID-PROVIDER-REQUEST" :PACKAGE-NAME "CL-OPENID"
      :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "OP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
      (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ALLOW-UNENCRYPTED-ASSOCIATION-P" :PACKAGE-NAME "CL-OPENID"
       :EXTERNALP NIL)
      (:NAME "&AUX" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "V1-COMPAT" :PACKAGE-NAME "CL-OPENID" :EXTERNALP NIL)
       ((:NAME "NOT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
        ((:NAME "MESSAGE-V2-P" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
         (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)))))
     :DOCUMENTATION "Handle request MESSAGE for OpenID Provider instance OP.

ALLOW-UNENCRYPTED-ASSOCIATION-P specifies whether it is allowable
to use unencrypted association method. Set it to NIL unless your
OP endopoint uses HTTPS. See OpenID Authentication 2.0 - Final, section 
8.4.1. No-Encryption Association Sessions
 (http://openid.net/specs/openid-authentication-2_0.html#assoc_sess_types).

Returns two values: the first is body, and the second is an HTTP 
status code.

On HTTP redirections (the second value between 300 and 399 inclusive), 
the primary returned value will be an URI to redirect the user to."))
   :EXTERNAL-SYMBOLS
   ((:NAME "+AUTHPROC-HANDLE-PARAMETER+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP
     T)
    (:NAME "IN-NS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "XRDS-LOCATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "HANDLE-INDIRECT-RESPONSE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "COPY-MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "HANDLE-CHECKID-IMMEDIATE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "OPENID-PROVIDER" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "MESSAGE-FIELD" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "MESSAGE-V2-P" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "OPENID-ASSERTION-ERROR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "PROTOCOL-VERSION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "AUTH-REQUEST-REALM" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "RELYING-PARTY" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "HANDLE-OPENID-PROVIDER-REQUEST" :PACKAGE-NAME "CL-OPENID"
     :EXTERNALP T)
    (:NAME "OP-LOCAL-ID" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "AUTHPROC" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "PROVIDER-ENDPOINT-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "INITIATE-AUTHENTICATION" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "REALM" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "ENDPOINT-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "MAKE-MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "PROTOCOL-VERSION-MAJOR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "CODE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "+INDIRECT-RESPONSE-CODE+" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "AUTH-PROCESS" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "CLAIMED-ID" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "ROOT-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "CANCEL-RESPONSE-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "TIMESTAMP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "REASON" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "HANDLE-CHECKID-SETUP" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "RETURN-TO" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "IMMEDIATE-P" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "SUCCESSFUL-RESPONSE-URI" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "PROTOCOL-VERSION-MINOR" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "AUTH-PROCESS-P" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)
    (:NAME "MESSAGE" :PACKAGE-NAME "CL-OPENID" :EXTERNALP T)))))
