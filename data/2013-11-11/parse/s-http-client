
(:TYPE :SYSTEM :NAME "s-http-client" :AUTHOR
 "Sven Van Caekenberghe <svc@mac.com>" :MAINTAINER
 "Sven Van Caekenberghe <svc@mac.com>" :VERSION "1" :LICENCE
 "Lesser Lisp General Public License (LLGPL)" :DESCRIPTION
 "A Basic HTTP Client" :LONG-DESCRIPTION "A Basic HTTP Client" :DEPENDS-ON
 ("S-UTILS" "S-SYSDEPS" "S-BASE64" "PURI" "CHIPZ") :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "S-HTTP-CLIENT" :FULL-NAME "S-HTTP-CLIENT"
   :DOCUMENTATION "A Basic HTTP Client" :SYMBOL-LIST
   ((:TYPE :VARIABLE :SYMBOL
     (:NAME "*HTTP-CLIENT-AGENT*" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
     :DOCUMENTATION "The value to use for the 'User-Agent' request header"
     :INITIAL-VALUE
     "(FORMAT NIL \"HTTP Client ~a ~a\" (LISP-IMPLEMENTATION-TYPE)
        (LISP-IMPLEMENTATION-VERSION))")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*HTTP-CLIENT-ACCEPT*" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
     :DOCUMENTATION "The value to use for the 'Accept' request header"
     :INITIAL-VALUE "\"*/*\"")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*HTTP-CLIENT-ACCEPT-ENCODING*" :PACKAGE-NAME "S-HTTP-CLIENT"
      :EXTERNALP T)
     :DOCUMENTATION "The value to use for the 'Accept-Encoding' request header"
     :INITIAL-VALUE "NIL")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*ENDPOINT*" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :DOCUMENTATION NIL)
    (:TYPE :CLASS :SYMBOL
     (:NAME "HTTP-CLIENT-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
     :SUPER-CLASS-LIST NIL :DOCUMENTATION
     "Object holding all HTTP client state" :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "DATA" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL) :ACCESSORS
       NIL :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "LOCK" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL) :ACCESSORS
       NIL :READERS
       ((:NAME "GET-LOCK" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
       :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-HTTP-CLIENT-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
      T)
     :LAMBDA-LIST (:NAME "NIL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :DOCUMENTATION
     "Make a new HTTP client state object to hold open (keepalive) connections")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*DEFAULT-HTTP-CLIENT-STATE*" :PACKAGE-NAME "S-HTTP-CLIENT"
      :EXTERNALP T)
     :DOCUMENTATION "The default, globally shared HTTP client state"
     :INITIAL-VALUE "(S-HTTP-CLIENT:MAKE-HTTP-CLIENT-STATE)")
    (:TYPE :CLASS :SYMBOL
     (:NAME "HTTP-SERVER-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :SUPER-CLASS-LIST NIL :DOCUMENTATION
     "Object holding a reusable open connection to a scheme://host:port"
     :SLOT-LIST
     ((:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "SCHEME-HOST-PORT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "GET-SCHEME-HOST-PORT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
         NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "SOCKET" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "GET-SOCKET" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "IN-USE-P" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "GET-IN-USE-P" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "BUFFER" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL) :ACCESSORS
       ((:NAME "GET-BUFFER" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)
      (:TYPE :CLASS-SLOT :SYMBOL
       (:NAME "TIMESTAMP" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
       :ACCESSORS
       ((:NAME "GET-TIMESTAMP" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
       :READERS NIL :WRITERS NIL :DOCUMENTATION NIL)))
    (:TYPE :METHOD :SYMBOL
     (:NAME "PRINT-OBJECT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
     :LAMBDA-LIST
     (((:NAME "STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
       (:NAME "HTTP-SERVER-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
        NIL))
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :METHOD :SYMBOL
     (:NAME "GET-KEPT-ALIVE-AGE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :LAMBDA-LIST
     (((:NAME "HTTP-SERVER-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
       (:NAME "HTTP-SERVER-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
        NIL)))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "*CONNECTION-KEEP-ALIVE-TIMEOUT*" :PACKAGE-NAME "S-HTTP-CLIENT"
      :EXTERNALP NIL)
     :DOCUMENTATION
     "Keep-Alive connections not used for this amount of time will be force closed, eventually"
     :INITIAL-VALUE "(* 10 60)")
    (:TYPE :METHOD :SYMBOL
     (:NAME "CLEANUP-OLD-CONNECTIONS" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     (((:NAME "HTTP-CLIENT-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
       (:NAME "HTTP-CLIENT-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)))
     :DOCUMENTATION "Force close all kept-alive connections that are too old")
    (:TYPE :METHOD :SYMBOL
     (:NAME "GET-HTTP-SERVER-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     (((:NAME "HTTP-CLIENT-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
       (:NAME "HTTP-CLIENT-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T))
      (:NAME "SCHEME-HOST-PORT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "OPEN-SOCKET-STREAM" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "SCHEME" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "HOST" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "PORT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "CONNECT-TIMEOUT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "READ-TIMEOUT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "WRITE-TIMEOUT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "GET-OPEN-CONNECTION" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "SCHEME" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "HOST" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "PORT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORCE-NEW" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "CONNECT-TIMEOUT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "READ-TIMEOUT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "WRITE-TIMEOUT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION
     "Get an open connection to scheme://host:port reusing one from state unless force-new is t. Release after use")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CLOSE-CONNECTION" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "CONNECTION" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ABORT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "Close a socket connection stream, optionally aborting")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "RELEASE-CONNECTION" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "SCHEME" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "HOST" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "PORT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "CONNECTION" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION
     "Release a connection obtained through get-open-connection (either stored in state for reuse or not)")
    (:TYPE :METHOD :SYMBOL
     (:NAME "CLOSE-ALL-CONNECTIONS-INTERNAL" :PACKAGE-NAME "S-HTTP-CLIENT"
      :EXTERNALP NIL)
     :LAMBDA-LIST
     (((:NAME "HTTP-CLIENT-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
       (:NAME "HTTP-CLIENT-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T))
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ABORT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CLOSE-ALL-CONNECTIONS" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "HTTP-CLIENT-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
       (:NAME "*DEFAULT-HTTP-CLIENT-STATE*" :PACKAGE-NAME "S-HTTP-CLIENT"
        :EXTERNALP T))
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ABORT" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Close all open connections in http-client-state, optionaly aborting them")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-HTTP-REQUEST-LINE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "FORMAT-HTTP-REQUEST-LINE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "FORMAT-STRING" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "&REST" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "ARGS" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-CRLF-LINE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "BUFFER" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "EOF-ERROR-P" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
      (:NAME "EOF-VALUE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION
     "Read a CRLF termintated line from a character input stream into buffer. Return length excluding CRLF.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "RESPONSE-READ-CODE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BUFFER" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "+COMMON-RESPONSE-HEADERS+" :PACKAGE-NAME "S-HTTP-CLIENT"
      :EXTERNALP NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE "(MAPCAR
 #'(LAMBDA (S-HTTP-CLIENT::HEADER)
     (CONS S-HTTP-CLIENT::HEADER
           (INTERN (STRING-UPCASE S-HTTP-CLIENT::HEADER) :KEYWORD)))
 '(\"Server\" \"Date\" \"Content-Length\" \"Content-Type\" \"Connection\" \"Keep-Alive\"
   \"Cache-Control\" \"ETag\" \"Last-Modified\"))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "HEADER-FIELD-NAME->KEYWORD" :PACKAGE-NAME "S-HTTP-CLIENT"
      :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "START" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL) 0)
      (:NAME "END" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "HEADER-FIELD-VALUE->STRING" :PACKAGE-NAME "S-HTTP-CLIENT"
      :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "START" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL) 0)
      (:NAME "END" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "RESPONSE-READ-HEADERS" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BUFFER" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CONCATENATE-CHUNKS" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "CHUNKS" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "TOTAL-SIZE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "RESPONSE-READ-CHUNKED-BODY" :PACKAGE-NAME "S-HTTP-CLIENT"
      :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "BUFFER" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "RESPONSE-READ-BODY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "LENGTH" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "BUFFER" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "RESPONSE-READ-UNDEFINED-BODY" :PACKAGE-NAME "S-HTTP-CLIENT"
      :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "BUFFER" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "GUNZIP" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL) :LAMBDA-LIST
     ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)) :DOCUMENTATION
     NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "ENCODE-BASIC-AUTHORIZATION" :PACKAGE-NAME "S-HTTP-CLIENT"
      :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "USERNAME-PASSWORD-PAIR" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
       NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "READ-RESPONSE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BUFFER" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BODY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      ((:NAME "BODY-EXPECTED" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION "Read an HTTP response, headers and content, from stream")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "WRITE-REQUEST" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "STREAM" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BUFFER" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "URI" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "METHOD" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "CONTENT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "CONTENT-TYPE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "CONTENT-LENGTH" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "BASIC-AUTHORIZATION" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
       NIL)
      (:NAME "HEADERS" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION "Write an HTTP request, full header and body, to stream")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DO-ONE-REQUEST-RESPONSE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "CONNECTION" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "URI" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "METHOD" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "BUFFER" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "CONTENT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "CONTENT-TYPE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "CONTENT-LENGTH" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "BODY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "BASIC-AUTHORIZATION" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
       NIL)
      (:NAME "HEADERS" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION "Do one HTTP request and response on stream")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DO-HTTP-REQUEST-INTERNAL" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "SCHEME" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "HOST" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "PORT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "METHOD" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "URI" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "CONTENT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "CONTENT-TYPE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "CONTENT-LENGTH" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "BODY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "BASIC-AUTHORIZATION" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
       NIL)
      (:NAME "HEADERS" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "CONNECT-TIMEOUT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "READ-TIMEOUT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "WRITE-TIMEOUT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "DO-HTTP-REQUEST" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "URI" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "METHOD" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
       (:NAME "GET" :PACKAGE-NAME "KEYWORD" :EXTERNALP T))
      (:NAME "CONTENT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "CONTENT-TYPE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "CONTENT-LENGTH" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "BODY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "BASIC-AUTHORIZATION" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
       NIL)
      (:NAME "HEADERS" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "PROXY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      ((:NAME "STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
       (:NAME "*DEFAULT-HTTP-CLIENT-STATE*" :PACKAGE-NAME "S-HTTP-CLIENT"
        :EXTERNALP T))
      (:NAME "CONNECT-TIMEOUT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "READ-TIMEOUT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
      (:NAME "WRITE-TIMEOUT" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL))
     :DOCUMENTATION
     "Execute an HTTP request, returns (VALUES body code headers uri kept-alive-state)")
    (:TYPE :VARIABLE :SYMBOL
     (:NAME "+URI-ENCODE-CHAR-MAP+" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
      NIL)
     :DOCUMENTATION NIL :INITIAL-VALUE
     "(LET ((MAP (MAKE-ARRAY '(127) :ELEMENT-TYPE 'BOOLEAN)))
  (FLET ((S-HTTP-CLIENT::ALLOW-RANGE (S-HTTP-CLIENT::FROM S-HTTP-CLIENT::TO)
           (LOOP :FOR S-HTTP-CLIENT::I :UPFROM (CHAR-CODE
                                                S-HTTP-CLIENT::FROM) :UPTO (CHAR-CODE
                                                                            S-HTTP-CLIENT::TO)
                 :DO (SETF (AREF MAP S-HTTP-CLIENT::I) T))))
    (S-HTTP-CLIENT::ALLOW-RANGE #\\0 #\\9)
    (S-HTTP-CLIENT::ALLOW-RANGE #\\A #\\Z)
    (S-HTTP-CLIENT::ALLOW-RANGE #\\a #\\z)
    (LOOP :FOR CHAR :ACROSS \"-_.!~*'()\"
          :DO (SETF (AREF MAP (CHAR-CODE CHAR)) T))
    MAP))")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "URI-ENCODE-FOR-QUERY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "SIGNAL-ERRORS" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP NIL)
       (:NAME "T" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)))
     :DOCUMENTATION "URI encode string for use as a query parameter value")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "URI-DECODE-FOR-QUERY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
     :LAMBDA-LIST ((:NAME "STRING" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION "URI decode string from a query parameter value"))
   :EXTERNAL-SYMBOLS
   ((:NAME "MAKE-HTTP-CLIENT-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
    (:NAME "*DEFAULT-HTTP-CLIENT-STATE*" :PACKAGE-NAME "S-HTTP-CLIENT"
     :EXTERNALP T)
    (:NAME "*HTTP-CLIENT-ACCEPT*" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
    (:NAME "CLOSE-ALL-CONNECTIONS" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
    (:NAME "*HTTP-CLIENT-ACCEPT-ENCODING*" :PACKAGE-NAME "S-HTTP-CLIENT"
     :EXTERNALP T)
    (:NAME "*HTTP-CLIENT-AGENT*" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
    (:NAME "URI-DECODE-FOR-QUERY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
    (:NAME "DO-HTTP-REQUEST" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
    (:NAME "HTTP-CLIENT-STATE" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP T)
    (:NAME "URI-ENCODE-FOR-QUERY" :PACKAGE-NAME "S-HTTP-CLIENT" :EXTERNALP
     T)))))
