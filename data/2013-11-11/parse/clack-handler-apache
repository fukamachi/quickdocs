
(:TYPE :SYSTEM :NAME "clack-handler-apache" :AUTHOR "Eitarow Fukamachi"
 :MAINTAINER NIL :VERSION "11.12" :LICENCE "LLGPL" :DESCRIPTION
 "Clack handler for Apache2 + mod_lisp." :LONG-DESCRIPTION NIL :DEPENDS-ON
 ("CLACK" "CL-SYNTAX" "CL-SYNTAX-ANNOT" "MODLISP" "SPLIT-SEQUENCE" "ANAPHORA")
 :PACKAGE-LIST
 ((:TYPE :PACKAGE :NAME "CLACK.HANDLER.APACHE" :FULL-NAME
   "CLACK.HANDLER.APACHE" :DOCUMENTATION "# 
Clack.Handler.Apache - Clack handler for Apache2 + mod_lisp.


## SYNOPSIS

    (clackup #'(lambda (env)
                 '(200
                   (:content-type \"text/plain\")
                   (\"Hello, Clack!\")))
             :server :apache
             :port 3000)

## DESCRIPTION

Clack.Handler.Apache is a Clack handler for Apache2 + mod_lisp. This handler depends on the library \"cl-modlisp\", so it only works on CMUCL, SBCL, AllegroCL and LispWorks.

You should make sure the Apache server and [mod_lisp](http://www.fractalconcept.com/asp/html/mod_lisp.html) are installed on your machine. The configuration of Apache might be like this.

    LoadModule lisp_module /usr/libexec/apache2/mod_lisp2.so
    ...
    Listen 12345
    NameVirtualHost *:12345
    <VirtualHost *:12345>
      ErrorLog \"/tmp/mod-lisp.log\"
      LispServer 127.0.0.1 3000 \"www\"
      <Location />
        SetHandler lisp-handler
      </Location>
    </VirtualHost>

This configuration opens port 12345 to web browsers, and listens for the Lisp process on port 3000.

## AUTHOR

Eitarow Fukamachi (e.arrows@gmail.com)

"
   :SYMBOL-LIST
   ((:TYPE :FUNCTION :SYMBOL
     (:NAME "RUN" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "APP" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "DEBUG" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      ((:NAME "PORT" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP NIL)
       3000))
     :DOCUMENTATION "Start talking to mod_lisp process.
Note the `port` is for socket, not Apache's.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "STOP" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP T)
     :LAMBDA-LIST
     ((:NAME "SERVER" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP NIL))
     :DOCUMENTATION "Close socket to talk with mod_lisp.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "MAKE-REQUEST-DISPATCHER" :PACKAGE-NAME "CLACK.HANDLER.APACHE"
      :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "&OPTIONAL" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "DEBUG" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Return a function which calls `clack-request-dispatcher`.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "CLACK-REQUEST-DISPATCHER" :PACKAGE-NAME "CLACK.HANDLER.APACHE"
      :EXTERNALP NIL)
     :LAMBDA-LIST
     ((:NAME "COMMAND" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP NIL)
      (:NAME "APP" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP NIL)
      (:NAME "&KEY" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T)
      (:NAME "DEBUG" :PACKAGE-NAME "COMMON-LISP" :EXTERNALP T))
     :DOCUMENTATION
     "Apache(mod_lisp) request dispatcher for Clack. Process modlisp command alist.
This function is called on each request.")
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "COMMAND->PLIST" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "COMMAND" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP NIL))
     :DOCUMENTATION NIL)
    (:TYPE :FUNCTION :SYMBOL
     (:NAME "HANDLE-RESPONSE" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP
      NIL)
     :LAMBDA-LIST
     ((:NAME "RES" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP NIL))
     :DOCUMENTATION
     "Function for managing response. Take response and output it to `ml:*modlisp-socket*'."))
   :EXTERNAL-SYMBOLS
   ((:NAME "STOP" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP T)
    (:NAME "RUN" :PACKAGE-NAME "CLACK.HANDLER.APACHE" :EXTERNALP T)))))
